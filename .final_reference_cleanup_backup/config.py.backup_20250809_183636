#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Config
POSCO 시스템 구성요소

WatchHamster v3.0 및 POSCO News 250808 호환
Created: 2025-08-08
"""

# ==========================================
# API 연결 설정
# ==========================================
API_CONFIG = {
    # POSCO 뉴스 API 엔드포인트 URL
    "url": "https:/dev-global-api.einfomax.co.kr/apis/POSCO News 250808",
    
    # API 인증 정보
    "user": "infomax",
    "password": "infomax!",
    
    # 요청 타임아웃 (초) - 네트워크 지연 시 조정
    "timeout": 10
}

# ==========================================
# Dooray 웹훅 설정
# ==========================================
# POSCO News 250808 알림용 웹훅 (뉴스 변경사항, 상태 알림)
DOORAY_WEBHOOK_URL = "https:/infomax.dooray.com/services/3262462484277387103/4121380745073081229/5FbudzTwTki4wCeBszBrAg"

# WatchHamster v3.0 오류, 업데이트 알림)
WATCHHAMSTER_WEBHOOK_URL = "https:/infomax.dooray.com/services/3262462484277387103/3281274580264701322/nKUfZnjtRS2rHh-E9i9uZQ"

# 봇 프로필 이미지 URL (POSCO 로고)
# GitHub Raw URL 사용 - 로고 변경 시 이 URL 업데이트
BOT_PROFILE_IMAGE_URL = "https:/raw.githubusercontent.com/shuserker/infomax_api/main/Monitoring/POSCO News 250808_mini/posco_logo_mini.jpg"

# ==========================================
# 뉴스 모니터링 통합 설정
# ==========================================
NEWS_MONITOR_CONFIG = {
    "newyork-market-watch": {
        "display_name": "뉴욕마켓워치",
        "emoji": "🌆",
        "expected_publish_time": "060000",  # 06:00:00
        "expected_time_range": {"start": "060000", "end": "070000"},  # 06:00-07:00
        "delay_check_times": ["073000", "080000", "083000"],  # 07:30, 08:00, 08:30
        "tolerance_minutes": 60,  # 1시간 허용 범위
        "time_format": "5digit",  # 특수 5자리 형식 (61831)
        "intensive_monitoring": {
            "start_time": "060000",
            "end_time": "080000",
            "interval_seconds": 60
        },
        "delay_messages": {
            1: "30분 지연 상태입니다./n• 뉴욕 시장 상황에 따른 지연일 수 있습니다.",
            2: "1시간 지연 상태입니다./n• 주의가 필요한 지연입니다.",
            3: "1시간 30분 이상 지연 상태입니다./n• 심각한 지연으로 확인이 필요합니다."
        }
    },
    "kospi-close": {
        "display_name": "증시마감",
        "emoji": "📈",
        "expected_publish_time": "154000",  # 15:40:00
        "expected_time_range": {"start": "153000", "end": "155000"},  # 15:30-15:50
        "delay_check_times": ["160000", "163000", "170000"],  # 16:00, 16:30, 17:00
        "tolerance_minutes": 10,  # ±10분 허용
        "time_format": "6digit",  # 표준 6자리 형식 (154000)
        "intensive_monitoring": {
            "start_time": "153000",
            "end_time": "173000",
            "interval_seconds": 60
        },
        "delay_messages": {
            1: "20분 지연 상태입니다./n• 증시마감 일반적인 지연 범위입니다.",
            2: "50분 지연 상태입니다./n• 주의가 필요한 지연입니다.",
            3: "1시간 20분 이상 지연 상태입니다./n• 심각한 지연으로 확인이 필요합니다."
        }
    },
    "exchange-rate": {
        "display_name": "서환마감",
        "emoji": "💱",
        "expected_publish_time": "163000",  # 16:30:00
        "expected_time_range": {"start": "162500", "end": "163500"},  # 16:25-16:35
        "delay_check_times": ["170000", "173000", "180000"],  # 17:00, 17:30, 18:00
        "tolerance_minutes": 5,  # ±5분 허용
        "time_format": "6digit",  # 표준 6자리 형식 (163000)
        "intensive_monitoring": {
            "start_time": "160000",
            "end_time": "183000",
            "interval_seconds": 60
        },
        "delay_messages": {
            1: "30분 지연 상태입니다./n• 일반적인 지연 범위 내입니다.",
            2: "1시간 지연 상태입니다./n• 주의가 필요한 지연입니다.",
            3: "1시간 30분 이상 지연 상태입니다./n• 심각한 지연으로 확인이 필요합니다."
        }
    }
}

# ==========================================
# 마스터 모니터링 시간대별 전략 설정
# ==========================================
MASTER_MONITORING_STRATEGY = {
    "newyork_intensive": {
        "time_range": {"start": "060000", "end": "080000"},
        "interval": 60,
        "description": "뉴욕마켓워치 집중 모니터링",
        "targets": ["newyork-market-watch"]
    },
    "kospi_intensive": {
        "time_range": {"start": "153000", "end": "160000"},
        "interval": 60,
        "description": "증시마감 집중 모니터링",
        "targets": ["kospi-close"]
    },
    "dual_intensive": {
        "time_range": {"start": "160000", "end": "170000"},
        "interval": 60,
        "description": "이중 집중 모니터링 (증시마감 지연 + 서환마감 정시)",
        "targets": ["kospi-close", "exchange-rate"]
    },
    "exchange_intensive": {
        "time_range": {"start": "170000", "end": "183000"},
        "interval": 60,
        "description": "서환마감 집중 모니터링",
        "targets": ["exchange-rate"]
    },
    "normal": {
        "interval": 300,
        "description": "일반 모니터링",
        "targets": ["newyork-market-watch", "kospi-close", "exchange-rate"]
    },
    "weekend": {
        "interval": 1800,
        "description": "주말 모드 (최소 모니터링)",
        "targets": []
    }
}

# ==========================================
# 모니터링 동작 설정
# ==========================================
MONITORING_CONFIG = {
    # 기본 모니터링 간격 (분) - run_monitor.py 4번 옵션에서 사용
    "default_interval_minutes": 60,
    
    # 직전 데이터 검색 최대 일수 - 영업일 비교 시 과거 데이터 검색 범위
    "max_retry_days": 10,
    
    # 캐시 파일명 - 뉴스 데이터 캐싱용
# BROKEN_REF:     "cache_file": "POSCO News 250808_cache.json"
}

# ==========================================
# 상태 표시 설정
# ==========================================
STATUS_CONFIG = {
    # 상태 판단 모드
    # "strict": 엄격 모드 (모든 뉴스가 오늘 발행되어야 최신)
    # "lenient": 관대 모드 (일부 뉴스만 오늘 발행되어도 최신)
    "display_mode": "strict",
    
    # 상태별 색상 및 이모지
    "colors": {
        "all_latest": "🟢",    # 모든 데이터가 최신 (오늘 발행)
        "partial_latest": "🟡", # 일부만 최신 (일부 오늘 발행)
        "all_old": "🔴"        # 모든 데이터가 과거 (오늘 미발행)
    }
}

# ==========================================
# 뉴스 타입별 설정
# ==========================================
NEWS_TYPES = {
    # 뉴욕 시장 동향 뉴스 (1순위)
    "newyork-market-watch": {
        "display_name": "NEWYORK MARKET WATCH", 
        "emoji": "🌆",
        "publish_days": [0, 1, 2, 3, 4, 5]     # 발행 요일 (월-토)
    },
    
    # 코스피 마감 뉴스 (2순위)
    "kospi-close": {
        "display_name": "KOSPI CLOSE",
        "emoji": "📈",
        "publish_days": [0, 1, 2, 3, 4]        # 발행 요일 (월-금)
    },
    
    # 환율 관련 뉴스 (3순위)
    "exchange-rate": {
        "display_name": "EXCHANGE RATE",        # 알림에 표시될 이름
        "emoji": "💱",                          # 뉴스 타입 이모지
        "publish_days": [0, 1, 2, 3, 4]        # 발행 요일 (월-금)
    }
}

# 요일 코드 참조:
#_0 = 월요일, 1=화요일, 2=수요일, 3=목요일, 4=금요일, 5=토요일, 6=일요일