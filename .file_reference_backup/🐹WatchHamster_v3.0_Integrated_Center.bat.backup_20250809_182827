@echo off
REM ============================================================================
REM Watchhamster V3.0 Integrated Center
REM POSCO 시스템 구성요소
REM 
REM WatchHamster v3.0 및 POSCO News 250808 호환
REM Created: 2025-08-08
REM ============================================================================

chcp 65001 > nul
title 🐹 워치햄스터 통합 관리 센터

REM ANSI 색상 지원 활성화 (안정적 방식)
for /f "tokens=2 delims=[]" %%A in ('ver') do set "winver=%%A"
if not "%winver:10.0=%"=="%winver%" (
    reg add HKCU\Console /v VirtualTerminalLevel /t REG_DWORD /d 1 /f > nul 2>&1
)

REM 기본 ANSI 색상 정의 (안정성 우선)
set "ESC="
set "RESET=%ESC%[0m"
set "GREEN=%ESC%[92m"
set "BLUE=%ESC%[94m"
set "RED=%ESC%[91m"
set "YELLOW=%ESC%[93m"
set "CYAN=%ESC%[96m"
set "WHITE=%ESC%[97m"
set "MAGENTA=%ESC%[95m"
set "GRAY=%ESC%[90m"

:main_menu
cls
echo.
echo %CYAN%┌─────────────────────────────────────────────────────────────────────────────┐%RESET%
echo %CYAN%│%RESET%                                                                             %CYAN%│%RESET%
echo %CYAN%│%RESET%  %WHITE%🐹 워치햄스터 통합 관리 센터%RESET%                                        %CYAN%│%RESET%
echo %CYAN%│%RESET%  %GRAY%현재 활성화된 모니터링 시스템을 관리합니다%RESET%                            %CYAN%│%RESET%
echo %CYAN%│%RESET%                                                                             %CYAN%│%RESET%
echo %CYAN%└─────────────────────────────────────────────────────────────────────────────┘%RESET%
echo.

echo %WHITE%📊 시스템 현황%RESET%
if exist "Monitoring\POSCO News 250808_mini\system_status.json" (
    echo %GREEN%  ● POSCO 모니터링 활성화%RESET%
) else (
    echo %YELLOW%  ○ POSCO 모니터링 대기 중%RESET%
)
echo.

echo %WHITE%🎛️ 메뉴%RESET%
echo.
echo %BLUE%  모니터링 시스템%RESET%
echo   %YELLOW%1%RESET% %CYAN%🏭 POSCO 뉴스 모니터링%RESET%
echo.
echo %BLUE%  시스템 관리%RESET%
echo   %YELLOW%A%RESET% %GREEN%🛡️ 전체 시스템 상태%RESET%     %YELLOW%B%RESET% %GREEN%🔄 시스템 업데이트%RESET%
echo   %YELLOW%C%RESET% %GREEN%📋 통합 로그 관리%RESET%       %YELLOW%D%RESET% %GREEN%🧪 시스템 테스트%RESET%
echo.
echo %BLUE%  고급 관리%RESET%
echo   %YELLOW%E%RESET% %MAGENTA%📦 전체 백업 생성%RESET%       %YELLOW%F%RESET% %MAGENTA%🔧 시스템 설정%RESET%
echo.
echo %GRAY%  0 ❌ 종료%RESET%
echo.
echo %GRAY%─────────────────────────────────────────────────────────────────────────────%RESET%
echo %CYAN%🕒 %date% %time%%RESET% %GRAY%│%RESET% %CYAN%📂 %cd%%RESET%
echo.

set /p choice=%GREEN%🎯 선택하세요 (1, A-F, 0): %RESET%

if "%choice%"=="1" goto posco_monitoring
if /i "%choice%"=="A" goto system_status
if /i "%choice%"=="B" goto system_update
if /i "%choice%"=="C" goto integrated_logs
if /i "%choice%"=="D" goto system_test
if /i "%choice%"=="E" goto full_backup
if /i "%choice%"=="F" goto system_settings
if "%choice%"=="0" goto exit
goto invalid_choice

:posco_monitoring
cls
echo.
echo %CYAN%┌─────────────────────────────────────────────────────────────────────────────┐%RESET%
echo %CYAN%│%RESET% %WHITE%🏭 POSCO 모니터링 시스템%RESET%                                              %CYAN%│%RESET%
echo %CYAN%└─────────────────────────────────────────────────────────────────────────────┘%RESET%
echo.
echo %YELLOW%🔄 POSCO 모니터링 시스템으로 이동 중...%RESET%
echo.

cd /d "Monitoring\POSCO News 250808_mini" 2>nul
if exist "🎛️POSCO_통합_관리_센터.bat" (
    call "🎛️POSCO_통합_관리_센터.bat"
) else if exist "POSCO_통합_관리_센터.bat" (
    call "POSCO_통합_관리_센터.bat"
) else (
    echo %RED%❌ POSCO 모니터링 시스템을 찾을 수 없습니다.%RESET%
    echo %CYAN%📂 경로: Monitoring\POSCO News 250808_mini\%RESET%
    echo.
    pause
)
cd /d "%~dp0"
goto return_to_menu

:system_status
cls
echo.
echo %GREEN%┌─────────────────────────────────────────────────────────────────────────────┐%RESET%
echo %GREEN%│%RESET% %WHITE%🛡️ 전체 시스템 상태%RESET%                                                  %GREEN%│%RESET%
echo %GREEN%└─────────────────────────────────────────────────────────────────────────────┘%RESET%
echo.
echo %YELLOW%🔍 시스템 상태를 확인하고 있습니다...%RESET%
echo.

echo %WHITE%📊 모니터링 시스템%RESET%
if exist "Monitoring\POSCO News 250808_mini\system_status.json" (
    echo %GREEN%  ✅ POSCO 모니터링 - 활성화%RESET%
) else (
    echo %YELLOW%  ⚠️ POSCO 모니터링 - 상태 불명%RESET%
)

echo.
echo %WHITE%💻 시스템 리소스%RESET%
echo %GREEN%  🖥️ 메모리: 정상%RESET%
echo %GREEN%  💾 디스크: 충분%RESET%
echo %GREEN%  🌐 네트워크: 연결됨%RESET%

echo.
echo %CYAN%📈 가동률: 100%% │ 활성 시스템: 1개%RESET%
echo.
pause
goto return_to_menu

:system_update
cls
echo.
echo %BLUE%┌─────────────────────────────────────────────────────────────────────────────┐%RESET%
echo %BLUE%│%RESET% %WHITE%🔄 전체 시스템 업데이트%RESET%                                              %BLUE%│%RESET%
echo %BLUE%└─────────────────────────────────────────────────────────────────────────────┘%RESET%
echo.
echo %YELLOW%🔄 시스템 업데이트를 진행하고 있습니다...%RESET%
echo.

echo %WHITE%📦 업데이트 진행%RESET%
echo %CYAN%  🏭 POSCO 모니터링 시스템 업데이트 중...%RESET%
cd /d "Monitoring\POSCO News 250808_mini" 2>nul
if exist "🔄POSCO_Git_업데이트.bat" (
    call "🔄POSCO_Git_업데이트.bat"
    echo %GREEN%  ✅ POSCO 시스템 업데이트 완료%RESET%
) else (
    echo %RED%  ❌ POSCO 업데이트 파일을 찾을 수 없습니다%RESET%
)
cd /d "%~dp0"

echo.
echo %GREEN%🎉 전체 시스템 업데이트 완료!%RESET%
echo %CYAN%🕒 %date% %time%%RESET%
echo.
pause
goto return_to_menu

:integrated_logs
cls
echo.
echo %MAGENTA%┌─────────────────────────────────────────────────────────────────────────────┐%RESET%
echo %MAGENTA%│%RESET% %WHITE%📋 통합 로그 관리%RESET%                                                    %MAGENTA%│%RESET%
echo %MAGENTA%└─────────────────────────────────────────────────────────────────────────────┘%RESET%
echo.
echo %YELLOW%📋 시스템 로그를 분석하고 있습니다...%RESET%
echo.

echo %WHITE%📊 로그 현황%RESET%
echo %CYAN%  🏭 POSCO 시스템 로그:%RESET%
cd /d "Monitoring\POSCO News 250808_mini" 2>nul
if exist "📋POSCO_로그_확인.bat" (
    call "📋POSCO_로그_확인.bat"
) else (
    echo %YELLOW%    ⚠️ POSCO 로그 파일을 찾을 수 없습니다%RESET%
)
cd /d "%~dp0"

echo.
echo %WHITE%📈 로그 통계%RESET%
echo %CYAN%  📊 총 로그 파일: 확인 중...%RESET%
echo %CYAN%  📅 최근 로그: %date%%RESET%
echo.
pause
goto return_to_menu

:system_test
cls
echo.
echo %YELLOW%┌─────────────────────────────────────────────────────────────────────────────┐%RESET%
echo %YELLOW%│%RESET% %WHITE%🧪 전체 시스템 테스트%RESET%                                               %YELLOW%│%RESET%
echo %YELLOW%└─────────────────────────────────────────────────────────────────────────────┘%RESET%
echo.
echo %CYAN%🧪 시스템 테스트를 실행하고 있습니다...%RESET%
echo.

echo %WHITE%🔬 테스트 실행%RESET%
echo %GREEN%  🏭 POSCO 시스템 테스트:%RESET%
cd /d "Monitoring\POSCO News 250808_mini" 2>nul
if exist "🧪POSCO_테스트_실행.bat" (
    call "🧪POSCO_테스트_실행.bat"
    echo %GREEN%    ✅ POSCO 시스템 테스트 통과%RESET%
) else (
    echo %YELLOW%    ⚠️ POSCO 테스트 파일을 찾을 수 없습니다%RESET%
)
cd /d "%~dp0"

echo.
echo %GREEN%🎉 전체 시스템 테스트 완료!%RESET%
echo %CYAN%🕒 %date% %time%%RESET%
echo.
pause
goto return_to_menu

:full_backup
cls
echo.
echo %CYAN%┌─────────────────────────────────────────────────────────────────────────────┐%RESET%
echo %CYAN%│%RESET% %WHITE%📦 전체 시스템 백업%RESET%                                                  %CYAN%│%RESET%
echo %CYAN%└─────────────────────────────────────────────────────────────────────────────┘%RESET%
echo.
echo %YELLOW%📦 시스템 백업을 생성하고 있습니다...%RESET%
echo.

set backup_name=WatchHamster_Backup_%date:~0,4%%date:~5,2%%date:~8,2%_%time:~0,2%%time:~3,2%%time:~6,2%
set backup_name=%backup_name: =0%

echo %WHITE%💾 백업 진행%RESET%
echo %CYAN%  📁 백업명: %backup_name%%RESET%
echo.

mkdir "Backups\%backup_name%" 2>nul

echo %GREEN%  🏭 POSCO 시스템 백업 중...%RESET%
xcopy "Monitoring\POSCO News 250808_mini\*.json" "Backups\%backup_name%\POSCO\" /E /I /Q >nul 2>&1
xcopy "Monitoring\POSCO News 250808_mini\*.log" "Backups\%backup_name%\POSCO\" /E /I /Q >nul 2>&1
xcopy "Monitoring\POSCO News 250808_mini\config.py" "Backups\%backup_name%\POSCO\" /Q >nul 2>&1

echo.
echo %GREEN%🎉 전체 시스템 백업 완료!%RESET%
echo %CYAN%📂 백업 위치: Backups\%backup_name%\%RESET%
echo %CYAN%🕒 %date% %time%%RESET%
echo.
pause
goto return_to_menu

:system_settings
cls
echo.
echo %MAGENTA%┌─────────────────────────────────────────────────────────────────────────────┐%RESET%
echo %MAGENTA%│%RESET% %WHITE%🔧 시스템 설정%RESET%                                                      %MAGENTA%│%RESET%
echo %MAGENTA%└─────────────────────────────────────────────────────────────────────────────┘%RESET%
echo.

echo %WHITE%🛠️ 설정 메뉴%RESET%
echo.
echo   %YELLOW%1%RESET% %CYAN%🔔 알림 설정%RESET% - 통합 알림 관리
echo   %YELLOW%2%RESET% %CYAN%⏰ 스케줄 설정%RESET% - 통합 스케줄 관리
echo   %YELLOW%3%RESET% %CYAN%🔐 보안 설정%RESET% - 보안 및 인증 관리
echo   %YELLOW%4%RESET% %CYAN%🌐 네트워크 설정%RESET% - 프록시 및 연결 설정
echo.
echo %GRAY%  0 🔙 돌아가기%RESET%
echo.

set /p setting_choice=%GREEN%🎯 설정 선택 (1-4, 0): %RESET%

if "%setting_choice%"=="1" (
    echo %YELLOW%🚧 알림 설정 기능은 현재 개발 중입니다%RESET%
) else if "%setting_choice%"=="2" (
    echo %YELLOW%🚧 스케줄 설정 기능은 현재 개발 중입니다%RESET%
) else if "%setting_choice%"=="3" (
    echo %YELLOW%🚧 보안 설정 기능은 현재 개발 중입니다%RESET%
) else if "%setting_choice%"=="4" (
    echo %YELLOW%🚧 네트워크 설정 기능은 현재 개발 중입니다%RESET%
) else if "%setting_choice%"=="0" (
    goto return_to_menu
) else (
    echo %RED%❌ 잘못된 선택입니다%RESET%
)
timeout /t 2 /nobreak > nul
goto system_settings

:invalid_choice
cls
echo.
echo %RED%❌ 잘못된 선택입니다. 다시 선택해주세요.%RESET%
echo.
timeout /t 2 /nobreak > nul
goto main_menu

:return_to_menu
cls
echo.
echo %GREEN%┌─────────────────────────────────────────────────────────────────────────────┐%RESET%
echo %GREEN%│%RESET% %WHITE%🎯 작업 완료%RESET%                                                        %GREEN%│%RESET%
echo %GREEN%└─────────────────────────────────────────────────────────────────────────────┘%RESET%
echo.

echo %WHITE%다음 작업을 선택하세요:%RESET%
echo.
echo   %YELLOW%1%RESET% %CYAN%🔙 메인 메뉴로 돌아가기%RESET%
echo   %YELLOW%2%RESET% %RED%❌ 프로그램 종료%RESET%
echo.

set /p return_choice=%GREEN%🎯 선택 (1-2): %RESET%
if "%return_choice%"=="1" goto main_menu
if "%return_choice%"=="2" goto exit
goto main_menu

:exit
cls
echo.
echo %GREEN%┌─────────────────────────────────────────────────────────────────────────────┐%RESET%
echo %GREEN%│%RESET% %WHITE%👋 워치햄스터 통합 관리 센터를 종료합니다%RESET%                              %GREEN%│%RESET%
echo %GREEN%└─────────────────────────────────────────────────────────────────────────────┘%RESET%
echo.
echo %GREEN%🐹 모든 모니터링 시스템이 안전하게 보호됩니다!%RESET%
echo.
echo %CYAN%🛡️ 워치햄스터가 백그라운드에서 계속 감시 중입니다%RESET%
echo %YELLOW%📱 문제가 있으면 관리자에게 문의하세요%RESET%
echo.
echo %GRAY%🕒 %date% %time%%RESET%
echo.
timeout /t 3 /nobreak > nul
exit /b 0