# ğŸ”„ POSCO WatchHamster v3.0 ë§ˆì´ê·¸ë ˆì´ì…˜ ê°€ì´ë“œ

## ğŸ“– ëª©ì°¨
1. [ë§ˆì´ê·¸ë ˆì´ì…˜ ê°œìš”](#ë§ˆì´ê·¸ë ˆì´ì…˜-ê°œìš”)
2. [ì‚¬ì „ ì¤€ë¹„](#ì‚¬ì „-ì¤€ë¹„)
3. [ìë™ ë§ˆì´ê·¸ë ˆì´ì…˜ ìŠ¤í¬ë¦½íŠ¸](#ìë™-ë§ˆì´ê·¸ë ˆì´ì…˜-ìŠ¤í¬ë¦½íŠ¸)
4. [ìˆ˜ë™ ë§ˆì´ê·¸ë ˆì´ì…˜ ì ˆì°¨](#ìˆ˜ë™-ë§ˆì´ê·¸ë ˆì´ì…˜-ì ˆì°¨)
5. [ë¡¤ë°± ì ˆì°¨](#ë¡¤ë°±-ì ˆì°¨)

---

## ğŸ¯ ë§ˆì´ê·¸ë ˆì´ì…˜ ê°œìš”

### ë§ˆì´ê·¸ë ˆì´ì…˜ ë²”ìœ„
- **ê¸°ì¡´ ì‹œìŠ¤í…œ**: POSCO WatchHamster v1.x
- **ìƒˆë¡œìš´ ì‹œìŠ¤í…œ**: POSCO WatchHamster v3.0
- **í˜¸í™˜ì„±**: ê¸°ì¡´ ê¸°ëŠ¥ 100% ë³´ì¡´
- **ì¶”ê°€ ê¸°ëŠ¥**: ìƒˆë¡œìš´ ì•„í‚¤í…ì²˜ ë° í–¥ìƒëœ ê¸°ëŠ¥

### ì£¼ìš” ë³€ê²½ì‚¬í•­
```
ğŸ”„ ë§ˆì´ê·¸ë ˆì´ì…˜ ë³€ê²½ì‚¬í•­

ê¸°ì¡´ ì‹œìŠ¤í…œ (v1.x)                ìƒˆë¡œìš´ ì‹œìŠ¤í…œ (v2.0)
â”œâ”€â”€ monitor_WatchHamster.py    â†’  â”œâ”€â”€ monitor_WatchHamster.py (ê°œì„ )
â”œâ”€â”€ ê°œë³„ ëª¨ë“ˆë“¤                â†’  â”œâ”€â”€ ê°œë³„ ëª¨ë“ˆë“¤ (ê·¸ëŒ€ë¡œ ìœ ì§€)
â””â”€â”€ ê¸°ë³¸ í”„ë¡œì„¸ìŠ¤ ê´€ë¦¬          â†’  â”œâ”€â”€ POSCO News_v2/
                                  â”‚   â”œâ”€â”€ core/
                                  â”‚   â”‚   â”œâ”€â”€ enhanced_process_manager.py
                                  â”‚   â”‚   â”œâ”€â”€ module_registry.py
                                  â”‚   â”‚   â””â”€â”€ notification_manager.py
                                  â”‚   â””â”€â”€ modules.json
                                  â””â”€â”€ posco_control_center.sh (ê°œì„ )
```

---

## ğŸ“‹ ì‚¬ì „ ì¤€ë¹„

### 1. ë°±ì—… ìƒì„±
```bash
#!/bin/bash
# backup_before_migration.sh

echo "ğŸ”„ POSCO WatchHamster ë§ˆì´ê·¸ë ˆì´ì…˜ ë°±ì—… ì‹œì‘"

# ë°±ì—… ë””ë ‰í† ë¦¬ ìƒì„±
BACKUP_DIR="backup_$(date +%Y%m%d_%H%M%S)"
mkdir -p "$BACKUP_DIR"

# ê¸°ì¡´ ì‹œìŠ¤í…œ ë°±ì—…
echo "ğŸ“¦ ê¸°ì¡´ ì‹œìŠ¤í…œ ë°±ì—… ì¤‘..."
cp -r Monitoring/ "$BACKUP_DIR/"
cp posco_control_center.sh "$BACKUP_DIR/"
cp *.log "$BACKUP_DIR/" 2>/dev/null || true
cp *.json "$BACKUP_DIR/" 2>/dev/null || true

# ì„¤ì • íŒŒì¼ ë°±ì—…
echo "âš™ï¸ ì„¤ì • íŒŒì¼ ë°±ì—… ì¤‘..."
if [ -f "Monitoring/POSCO News/config.py" ]; then
    cp "Monitoring/POSCO News/config.py" "$BACKUP_DIR/"
fi

# ë°ì´í„°ë² ì´ìŠ¤ ë°±ì—… (ìˆëŠ” ê²½ìš°)
echo "ğŸ—„ï¸ ë°ì´í„°ë² ì´ìŠ¤ ë°±ì—… ì¤‘..."
find . -name "*.db" -exec cp {} "$BACKUP_DIR/" \;

# ë°±ì—… ì™„ë£Œ
echo "âœ… ë°±ì—… ì™„ë£Œ: $BACKUP_DIR"
echo "ğŸ“‹ ë°±ì—… ë‚´ìš©:"
ls -la "$BACKUP_DIR"
```

### 2. ì‹œìŠ¤í…œ ìš”êµ¬ì‚¬í•­ í™•ì¸
```bash
#!/bin/bash
# check_requirements.sh

echo "ğŸ” ì‹œìŠ¤í…œ ìš”êµ¬ì‚¬í•­ í™•ì¸"

# Python ë²„ì „ í™•ì¸
echo "ğŸ Python ë²„ì „:"
python3 --version

# í•„ìˆ˜ íŒ¨í‚¤ì§€ í™•ì¸
echo "ğŸ“¦ í•„ìˆ˜ íŒ¨í‚¤ì§€ í™•ì¸:"
python3 -c "
import sys
packages = ['requests', 'psutil', 'json']
missing = []

for pkg in packages:
    try:
        __import__(pkg)
        print(f'âœ… {pkg}')
    except ImportError:
        print(f'âŒ {pkg} - ì„¤ì¹˜ í•„ìš”')
        missing.append(pkg)

if missing:
    print(f'\\nì„¤ì¹˜ ëª…ë ¹ì–´: pip3 install {\" \".join(missing)}')
"

# ë””ìŠ¤í¬ ê³µê°„ í™•ì¸
echo "ğŸ’¾ ë””ìŠ¤í¬ ê³µê°„:"
df -h .

# ë©”ëª¨ë¦¬ í™•ì¸
echo "ğŸ§  ë©”ëª¨ë¦¬ ìƒíƒœ:"
free -h 2>/dev/null || vm_stat | head -5

echo "âœ… ìš”êµ¬ì‚¬í•­ í™•ì¸ ì™„ë£Œ"
```

---

## ğŸ¤– ìë™ ë§ˆì´ê·¸ë ˆì´ì…˜ ìŠ¤í¬ë¦½íŠ¸

### ë©”ì¸ ë§ˆì´ê·¸ë ˆì´ì…˜ ìŠ¤í¬ë¦½íŠ¸
```bash
#!/bin/bash
# migrate_to_v2.sh

set -e  # ì˜¤ë¥˜ ì‹œ ì¤‘ë‹¨

echo "ğŸš€ POSCO WatchHamster v3.0 ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹œì‘"

# ìƒ‰ìƒ ì •ì˜
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
NC='\033[0m' # No Color

print_step() {
    echo -e "${BLUE}[ë‹¨ê³„ $1]${NC} $2"
}

print_success() {
    echo -e "${GREEN}âœ… $1${NC}"
}

print_warning() {
    echo -e "${YELLOW}âš ï¸ $1${NC}"
}

print_error() {
    echo -e "${RED}âŒ $1${NC}"
}

# ë‹¨ê³„ 1: ì‚¬ì „ í™•ì¸
print_step "1" "ì‚¬ì „ í™•ì¸ ë° ë°±ì—…"

# ê¸°ì¡´ WatchHamster ì¤‘ì§€
if pgrep -f "monitor_WatchHamster.py" > /dev/null; then
    print_warning "ê¸°ì¡´ WatchHamster ì¤‘ì§€ ì¤‘..."
    pkill -f "monitor_WatchHamster.py"
    sleep 5
fi

# ë°±ì—… ìƒì„±
./backup_before_migration.sh

# ë‹¨ê³„ 2: v2 ì•„í‚¤í…ì²˜ ì„¤ì¹˜
print_step "2" "v2 ì•„í‚¤í…ì²˜ ì„¤ì¹˜"

# v2 ë””ë ‰í† ë¦¬ ìƒì„±
mkdir -p Monitoring/POSCO News_v2/core

# í•µì‹¬ ì»´í¬ë„ŒíŠ¸ íŒŒì¼ë“¤ì´ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸
if [ ! -f "Monitoring/POSCO News_v2/core/enhanced_process_manager.py" ]; then
    print_error "v2 ì»´í¬ë„ŒíŠ¸ íŒŒì¼ë“¤ì´ ì—†ìŠµë‹ˆë‹¤. ë¨¼ì € v2 íŒŒì¼ë“¤ì„ ë°°ì¹˜í•´ì£¼ì„¸ìš”."
    exit 1
fi

print_success "v2 ì•„í‚¤í…ì²˜ íŒŒì¼ í™•ì¸ ì™„ë£Œ"

# ë‹¨ê³„ 3: ì„¤ì • ë§ˆì´ê·¸ë ˆì´ì…˜
print_step "3" "ì„¤ì • íŒŒì¼ ë§ˆì´ê·¸ë ˆì´ì…˜"

# ê¸°ì¡´ ì„¤ì •ì—ì„œ ìƒˆ ì„¤ì •ìœ¼ë¡œ ë³€í™˜
python3 << 'EOF'
import json
import os
from datetime import datetime

# ê¸°ì¡´ ì„¤ì • ë¡œë“œ (ìˆëŠ” ê²½ìš°)
config_data = {
    "metadata": {
        "version": "1.0",
        "last_updated": datetime.now().isoformat(),
        "description": "POSCO WatchHamster Module Registry Configuration - Migrated from v1.x"
    },
    "modules": {
        "posco_main_notifier": {
            "script_path": "posco_main_notifier.py",
            "description": "POSCO ë©”ì¸ ë‰´ìŠ¤ ì•Œë¦¼ ì‹œìŠ¤í…œ",
            "auto_start": True,
            "restart_on_failure": True,
            "max_restart_attempts": 3,
            "health_check_interval": 300,
            "dependencies": [],
            "environment_vars": {
                "PYTHONUNBUFFERED": "1"
            },
            "working_directory": "../POSCO News",
            "timeout": 30,
            "priority": 1
        },
        "realtime_news_monitor": {
            "script_path": "realtime_news_monitor.py",
            "description": "ì‹¤ì‹œê°„ ë‰´ìŠ¤ ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ",
            "auto_start": True,
            "restart_on_failure": True,
            "max_restart_attempts": 3,
            "health_check_interval": 300,
            "dependencies": ["posco_main_notifier"],
            "environment_vars": {
                "PYTHONUNBUFFERED": "1"
            },
            "working_directory": "../POSCO News",
            "timeout": 30,
            "priority": 2
        },
        "integrated_report_scheduler": {
            "script_path": "integrated_report_scheduler.py",
            "description": "í†µí•© ë¦¬í¬íŠ¸ ìŠ¤ì¼€ì¤„ëŸ¬",
            "auto_start": True,
            "restart_on_failure": True,
            "max_restart_attempts": 3,
            "health_check_interval": 300,
            "dependencies": ["posco_main_notifier"],
            "environment_vars": {
                "PYTHONUNBUFFERED": "1"
            },
            "working_directory": "../POSCO News",
            "timeout": 30,
            "priority": 3
        }
    }
}

# modules.json ìƒì„±
with open('Monitoring/POSCO News_v2/modules.json', 'w', encoding='utf-8') as f:
    json.dump(config_data, f, indent=2, ensure_ascii=False)

print("âœ… modules.json ìƒì„± ì™„ë£Œ")
EOF

# ë‹¨ê³„ 4: WatchHamster ì—…ë°ì´íŠ¸ í™•ì¸
print_step "4" "WatchHamster ì—…ë°ì´íŠ¸ í™•ì¸"

# ìƒˆë¡œìš´ ì•„í‚¤í…ì²˜ import í…ŒìŠ¤íŠ¸
python3 -c "
import sys
import os
sys.path.insert(0, 'Monitoring/POSCO News')

try:
    from monitor_WatchHamster import PoscoMonitorWatchHamster
    wh = PoscoMonitorWatchHamster()
    
    # ìƒˆë¡œìš´ ì»´í¬ë„ŒíŠ¸ í™•ì¸
    if hasattr(wh, 'process_manager') and wh.process_manager:
        print('âœ… Enhanced ProcessManager í™œì„±í™”')
    else:
        print('âš ï¸ Enhanced ProcessManager ë¹„í™œì„±í™” (ê¸°ì¡´ ë°©ì‹ ì‚¬ìš©)')
        
    if hasattr(wh, 'module_registry') and wh.module_registry:
        print('âœ… ModuleRegistry í™œì„±í™”')
    else:
        print('âš ï¸ ModuleRegistry ë¹„í™œì„±í™”')
        
    if hasattr(wh, 'notification_manager') and wh.notification_manager:
        print('âœ… NotificationManager í™œì„±í™”')
    else:
        print('âš ï¸ NotificationManager ë¹„í™œì„±í™”')
        
    print('ğŸ‰ WatchHamster v3.0 ì´ˆê¸°í™” ì„±ê³µ')
    
except Exception as e:
    print(f'âŒ WatchHamster ì´ˆê¸°í™” ì‹¤íŒ¨: {e}')
    exit(1)
"

# ë‹¨ê³„ 5: ì œì–´ì„¼í„° ì—…ë°ì´íŠ¸ í™•ì¸
print_step "5" "ì œì–´ì„¼í„° ì—…ë°ì´íŠ¸ í™•ì¸"

if grep -q "WatchHamster ê´€ë¦¬" posco_control_center.sh; then
    print_success "ì œì–´ì„¼í„° v2.0 ë©”ë‰´ êµ¬ì¡° í™•ì¸"
else
    print_warning "ì œì–´ì„¼í„°ê°€ v2.0ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤"
fi

# ë‹¨ê³„ 6: ë§ˆì´ê·¸ë ˆì´ì…˜ ê²€ì¦
print_step "6" "ë§ˆì´ê·¸ë ˆì´ì…˜ ê²€ì¦"

# í…ŒìŠ¤íŠ¸ ì‹œì‘
print_warning "WatchHamster í…ŒìŠ¤íŠ¸ ì‹œì‘ (10ì´ˆê°„)..."
timeout 10s python3 Monitoring/POSCO News/monitor_WatchHamster.py &
TEST_PID=$!

sleep 5

if kill -0 $TEST_PID 2>/dev/null; then
    print_success "WatchHamster í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì„±ê³µ"
    kill $TEST_PID 2>/dev/null
else
    print_error "WatchHamster í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì‹¤íŒ¨"
fi

# ë‹¨ê³„ 7: ë§ˆì´ê·¸ë ˆì´ì…˜ ì™„ë£Œ
print_step "7" "ë§ˆì´ê·¸ë ˆì´ì…˜ ì™„ë£Œ"

echo ""
echo "ğŸ‰ POSCO WatchHamster v3.0 ë§ˆì´ê·¸ë ˆì´ì…˜ ì™„ë£Œ!"
echo ""
echo "ğŸ“‹ ë§ˆì´ê·¸ë ˆì´ì…˜ ê²°ê³¼:"
echo "  âœ… ê¸°ì¡´ ê¸°ëŠ¥ 100% ë³´ì¡´"
echo "  âœ… ìƒˆë¡œìš´ ì•„í‚¤í…ì²˜ ì ìš©"
echo "  âœ… í–¥ìƒëœ í”„ë¡œì„¸ìŠ¤ ê´€ë¦¬"
echo "  âœ… ê°œì„ ëœ ì œì–´ì„¼í„°"
echo ""
echo "ğŸš€ ë‹¤ìŒ ë‹¨ê³„:"
echo "  1. ./posco_control_center.sh ì‹¤í–‰"
echo "  2. ë©”ë‰´ 1ë²ˆìœ¼ë¡œ WatchHamster ì‹œì‘"
echo "  3. ë©”ë‰´ 4ë²ˆìœ¼ë¡œ ìƒíƒœ í™•ì¸"
echo ""
echo "ğŸ“ ë¬¸ì œ ë°œìƒ ì‹œ:"
echo "  - ë¡œê·¸ í™•ì¸: tail -f watchhamster.log"
echo "  - ë¡¤ë°±: ./rollback_migration.sh"
echo ""
```

### ì„¤ì • ë³€í™˜ ìŠ¤í¬ë¦½íŠ¸
```python
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
ì„¤ì • ë³€í™˜ ìŠ¤í¬ë¦½íŠ¸

ê¸°ì¡´ v1.x ì„¤ì •ì„ v2.0 í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.
"""

import json
import os
import sys
from datetime import datetime

def convert_config():
    """ê¸°ì¡´ ì„¤ì •ì„ v2.0 í˜•ì‹ìœ¼ë¡œ ë³€í™˜"""
    
    print("ğŸ”„ ì„¤ì • ë³€í™˜ ì‹œì‘")
    
    # ê¸°ì¡´ config.pyì—ì„œ ì„¤ì • ì¶”ì¶œ (ìˆëŠ” ê²½ìš°)
    config_path = "Monitoring/POSCO News/config.py"
    existing_config = {}
    
    if os.path.exists(config_path):
        print(f"ğŸ“‹ ê¸°ì¡´ ì„¤ì • íŒŒì¼ ë°œê²¬: {config_path}")
        
        # ê°„ë‹¨í•œ ì„¤ì • ì¶”ì¶œ (ì‹¤ì œë¡œëŠ” ë” ì •êµí•œ íŒŒì‹± í•„ìš”)
        try:
            with open(config_path, 'r', encoding='utf-8') as f:
                content = f.read()
                
            # ì›¹í›… URL ì¶”ì¶œ
            if 'WEBHOOK_URL' in content:
                print("âœ… ì›¹í›… URL ì„¤ì • ë°œê²¬")
                existing_config['webhook_found'] = True
                
        except Exception as e:
            print(f"âš ï¸ ê¸°ì¡´ ì„¤ì • íŒŒì¼ ì½ê¸° ì‹¤íŒ¨: {e}")
    
    # v2.0 modules.json ìƒì„±
    modules_config = {
        "metadata": {
            "version": "1.0",
            "last_updated": datetime.now().isoformat(),
            "description": "POSCO WatchHamster Module Registry - Migrated from v1.x",
            "migration_info": {
                "migrated_from": "v1.x",
                "migration_date": datetime.now().isoformat(),
                "existing_config_found": bool(existing_config)
            }
        },
        "modules": {}
    }
    
    # ê¸°ë³¸ ëª¨ë“ˆë“¤ ì„¤ì •
    default_modules = {
        "posco_main_notifier": {
            "script_path": "posco_main_notifier.py",
            "description": "POSCO ë©”ì¸ ë‰´ìŠ¤ ì•Œë¦¼ ì‹œìŠ¤í…œ - v1.xì—ì„œ ë§ˆì´ê·¸ë ˆì´ì…˜",
            "auto_start": True,
            "restart_on_failure": True,
            "max_restart_attempts": 3,
            "health_check_interval": 300,
            "dependencies": [],
            "environment_vars": {
                "PYTHONUNBUFFERED": "1"
            },
            "working_directory": "../POSCO News",
            "timeout": 30,
            "priority": 1
        },
        "realtime_news_monitor": {
            "script_path": "realtime_news_monitor.py", 
            "description": "ì‹¤ì‹œê°„ ë‰´ìŠ¤ ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ - v1.xì—ì„œ ë§ˆì´ê·¸ë ˆì´ì…˜",
            "auto_start": True,
            "restart_on_failure": True,
            "max_restart_attempts": 3,
            "health_check_interval": 300,
            "dependencies": ["posco_main_notifier"],
            "environment_vars": {
                "PYTHONUNBUFFERED": "1"
            },
            "working_directory": "../POSCO News",
            "timeout": 30,
            "priority": 2
        },
        "integrated_report_scheduler": {
            "script_path": "integrated_report_scheduler.py",
            "description": "í†µí•© ë¦¬í¬íŠ¸ ìŠ¤ì¼€ì¤„ëŸ¬ - v1.xì—ì„œ ë§ˆì´ê·¸ë ˆì´ì…˜", 
            "auto_start": True,
            "restart_on_failure": True,
            "max_restart_attempts": 3,
            "health_check_interval": 300,
            "dependencies": ["posco_main_notifier"],
            "environment_vars": {
                "PYTHONUNBUFFERED": "1"
            },
            "working_directory": "../POSCO News",
            "timeout": 30,
            "priority": 3
        }
    }
    
    # ì„ íƒì  ëª¨ë“ˆë“¤ í™•ì¸ ë° ì¶”ê°€
    optional_modules = {
        "historical_data_collector": {
            "script_path": "historical_data_collector.py",
            "description": "íˆìŠ¤í† ë¦¬ ë°ì´í„° ìˆ˜ì§‘ê¸° - v1.xì—ì„œ ë§ˆì´ê·¸ë ˆì´ì…˜",
            "auto_start": False,  # ì„ íƒì  ì‹œì‘
            "restart_on_failure": True,
            "max_restart_attempts": 2,
            "health_check_interval": 600,
            "dependencies": [],
            "environment_vars": {
                "PYTHONUNBUFFERED": "1"
            },
            "working_directory": "../POSCO News",
            "timeout": 30,
            "priority": 4
        }
    }
    
    # ê¸°ë³¸ ëª¨ë“ˆë“¤ ì¶”ê°€
    modules_config["modules"].update(default_modules)
    
    # ì„ íƒì  ëª¨ë“ˆë“¤ ì¡´ì¬ í™•ì¸ í›„ ì¶”ê°€
    for module_name, module_config in optional_modules.items():
        script_path = os.path.join("Monitoring/POSCO News", module_config["script_path"])
        if os.path.exists(script_path):
            modules_config["modules"][module_name] = module_config
            print(f"âœ… ì„ íƒì  ëª¨ë“ˆ ë°œê²¬: {module_name}")
        else:
            print(f"âš ï¸ ì„ íƒì  ëª¨ë“ˆ ì—†ìŒ: {module_name}")
    
    # modules.json ì €ì¥
    output_path = "Monitoring/POSCO News_v2/modules.json"
    os.makedirs(os.path.dirname(output_path), exist_ok=True)
    
    with open(output_path, 'w', encoding='utf-8') as f:
        json.dump(modules_config, f, indent=2, ensure_ascii=False)
    
    print(f"âœ… ì„¤ì • ë³€í™˜ ì™„ë£Œ: {output_path}")
    print(f"ğŸ“Š ë³€í™˜ëœ ëª¨ë“ˆ ìˆ˜: {len(modules_config['modules'])}")
    
    return True

if __name__ == "__main__":
    try:
        convert_config()
        print("ğŸ‰ ì„¤ì • ë³€í™˜ ì„±ê³µ!")
    except Exception as e:
        print(f"âŒ ì„¤ì • ë³€í™˜ ì‹¤íŒ¨: {e}")
        sys.exit(1)
```