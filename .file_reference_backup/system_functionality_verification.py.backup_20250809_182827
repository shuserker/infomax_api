#!/usr/bin/env python3
"""
POSCO ì‹œìŠ¤í…œ ê¸°ëŠ¥ ê²€ì¦ ìŠ¤í¬ë¦½íŠ¸
System Functionality Verification for POSCO Naming Convention Standardization

ë³€ê²½ëœ ì‹œìŠ¤í…œì˜ ëª¨ë“  ìŠ¤í¬ë¦½íŠ¸ì™€ í”„ë¡œê·¸ë¨ì´ ì •ìƒì ìœ¼ë¡œ ë™ì‘í•˜ëŠ”ì§€ ê²€ì¦í•©ë‹ˆë‹¤.
"""

import posco_news_250808_monitor.log
import system_functionality_verification.py
# BROKEN_REF: import subprocess
import test_config.json
# BROKEN_REF: from pathlib import Path
# BROKEN_REF: from typing import Dict, List, Tuple
# BROKEN_REF: import logging
# BROKEN_REF: from datetime import datetime

# ë¡œê¹… ì„¤ì •
logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s - %(levelname)s - %(message)s'
)
logger = logging.getLogger(__name__)

class SystemFunctionalityVerifier:
    """ì‹œìŠ¤í…œ ê¸°ëŠ¥ ê²€ì¦ê¸°"""
    
    def __init__(self):
        self.workspace_root = Path.cwd()
        self.verification_results = []
        
    def verify_all_systems(self) -> Dict:
        """ëª¨ë“  ì‹œìŠ¤í…œ ê¸°ëŠ¥ ê²€ì¦"""
        logger.info("ğŸ” POSCO ì‹œìŠ¤í…œ ê¸°ëŠ¥ ê²€ì¦ ì‹œì‘")
        
        # 1. Python ìŠ¤í¬ë¦½íŠ¸ êµ¬ë¬¸ ê²€ì¦
        self._verify_python_scripts()
        
        # 2. Shell ìŠ¤í¬ë¦½íŠ¸ ê²€ì¦
        self._verify_shell_scripts()
        
        # 3. Batch ìŠ¤í¬ë¦½íŠ¸ ê²€ì¦
        self._verify_batch_scripts()
        
        # 4. JSON ì„¤ì • íŒŒì¼ ê²€ì¦
        self._verify_json_configs()
        
        # 5. ëª¨ë“ˆ import Monitoring/POSCO_News_250808/ğŸ“‹POSCO_ì‹œìŠ¤í…œ_ì •ë¦¬_ë°_ê²€ì¦_ì™„ë£Œ_20250806.md
        self._verify_module_imports()
        
        # 6. íŒŒì¼ ì°¸ì¡° ë¬´ê²°ì„± ê²€ì¦
        self._verify_file_references()
        
        # 7. ì‹¤í–‰ ê¶Œí•œ ê²€ì¦
        self._verify_execution_permissions()
        
        return self._generate_verification_report()

    def _verify_python_scripts(self):
        """Python ìŠ¤í¬ë¦½íŠ¸ êµ¬ë¬¸ ê²€ì¦"""
        logger.info("ğŸ Python ìŠ¤í¬ë¦½íŠ¸ êµ¬ë¬¸ ê²€ì¦ ì¤‘...")
        
        python_files = list(self.workspace_root.rglob("*.py"))
        valid_scripts = []
        invalid_scripts = []
        
        for py_file in python_files:
            try:
with_open(py_file,_'r',_encoding = 'utf-8') as f:
                    content = f.read()
                
                # êµ¬ë¬¸ ê²€ì‚¬
                compile(content, str(py_file), 'exec')
                valid_scripts.append(str(py_file.relative_to(self.workspace_root)))
                
            except SyntaxError as e:
                invalid_scripts.append({
                    "file": str(py_file.relative_to(self.workspace_root)),
                    "error": f"êµ¬ë¬¸ ì˜¤ë¥˜ (ë¼ì¸ {e.lineno}): {e.msg}"
                })
            except Exception as e:
                invalid_scripts.append({
                    "file": str(py_file.relative_to(self.workspace_root)),
                    "error": f"ê²€ì¦ ì‹¤íŒ¨: {str(e)}"
                })
        
        self.verification_results.append({
            "category": "Python Scripts Syntax",
            "total_files": len(python_files),
            "valid_files": len(valid_scripts),
            "invalid_files": len(invalid_scripts),
            "status": "PASS" if len(invalid_scripts) == 0 else "FAIL",
            "details": {
                "valid_scripts": valid_scripts[:10],  # ì²˜ìŒ 10ê°œë§Œ í‘œì‹œ
                "invalid_scripts": invalid_scripts
            }
        })

    def _verify_shell_scripts(self):
        """Shell ìŠ¤í¬ë¦½íŠ¸ ê²€ì¦"""
        logger.info("ğŸš Shell ìŠ¤í¬ë¦½íŠ¸ ê²€ì¦ ì¤‘...")
        
        shell_files = list(self.workspace_root.rglob("*.sh"))
        valid_scripts = []
        invalid_scripts = []
        
        for sh_file in shell_files:
            try:
                # ê¸°ë³¸ êµ¬ë¬¸ ê²€ì‚¬ (bash -n)
                result = subprocess.run(
                    ['bash', '-n', str(sh_file)],
                    capture_output=True,
                    text=True
                )
                
                if result.returncode == 0:
                    valid_scripts.append(str(sh_file.relative_to(self.workspace_root)))
                else:
                    invalid_scripts.append({
                        "file": str(sh_file.relative_to(self.workspace_root)),
                        "error": f"êµ¬ë¬¸ ì˜¤ë¥˜: {result.stderr.strip()}"
                    })
                    
            except Exception as e:
                invalid_scripts.append({
                    "file": str(sh_file.relative_to(self.workspace_root)),
                    "error": f"ê²€ì¦ ì‹¤íŒ¨: {str(e)}"
                })
        
        self.verification_results.append({
            "category": "Shell Scripts Syntax",
            "total_files": len(shell_files),
            "valid_files": len(valid_scripts),
            "invalid_files": len(invalid_scripts),
            "status": "PASS" if len(invalid_scripts) == 0 else "FAIL",
            "details": {
                "valid_scripts": valid_scripts,
                "invalid_scripts": invalid_scripts
            }
        })

    def _verify_batch_scripts(self):
        """Batch ìŠ¤í¬ë¦½íŠ¸ ê²€ì¦"""
        logger.info("ğŸ“ Batch ìŠ¤í¬ë¦½íŠ¸ ê²€ì¦ ì¤‘...")
        
        batch_files = list(self.workspace_root.rglob("*.bat"))
        valid_scripts = []
        invalid_scripts = []
        
        for bat_file in batch_files:
            try:
with_open(bat_file,_'r',_encoding = 'utf-8') as f:
                    content = f.read()
                
                # ê¸°ë³¸ì ì¸ êµ¬ë¬¸ ê²€ì‚¬ (ë¹ˆ ì¤„, ì£¼ì„ ì œì™¸)
                lines = [line.strip() for line in content.split('\n') if line.strip() and not line.strip().startswith('::')]
                
                # ê¸°ë³¸ Batch ëª…ë ¹ì–´ ê²€ì¦
                valid_commands = ['echo', 'set', 'if', 'for', 'call', 'goto', 'pause', 'exit', 'cd', 'dir', 'copy', 'move', 'del', 'python', 'start']
                
                has_valid_commands = False
                for line in lines:
                    if any(cmd in line.lower() for cmd in valid_commands):
                        has_valid_commands = True
                        break
                
                if has_valid_commands or len(lines) == 0:  # ë¹ˆ íŒŒì¼ë„ ìœ íš¨ë¡œ ê°„ì£¼
                    valid_scripts.append(str(bat_file.relative_to(self.workspace_root)))
                else:
                    invalid_scripts.append({
                        "file": str(bat_file.relative_to(self.workspace_root)),
                        "error": "ìœ íš¨í•œ Batch ëª…ë ¹ì–´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ"
                    })
                    
            except Exception as e:
                invalid_scripts.append({
                    "file": str(bat_file.relative_to(self.workspace_root)),
                    "error": f"ê²€ì¦ ì‹¤íŒ¨: {str(e)}"
                })
        
        self.verification_results.append({
            "category": "Batch Scripts",
            "total_files": len(batch_files),
            "valid_files": len(valid_scripts),
            "invalid_files": len(invalid_scripts),
            "status": "PASS" if len(invalid_scripts) == 0 else "FAIL",
            "details": {
                "valid_scripts": valid_scripts,
                "invalid_scripts": invalid_scripts
            }
        })

    def _verify_json_configs(self):
        """JSON ì„¤ì • íŒŒì¼ ê²€ì¦"""
        logger.info("âš™ï¸ JSON ì„¤ì • íŒŒì¼ ê²€ì¦ ì¤‘...")
        
        json_files = list(self.workspace_root.rglob("*.json"))
        valid_configs = []
        invalid_configs = []
        
        for json_file in json_files:
            try:
with_open(json_file,_'r',_encoding = 'utf-8') as f:
                    json.load(f)  # JSON íŒŒì‹± í…ŒìŠ¤íŠ¸
                
                valid_configs.append(str(json_file.relative_to(self.workspace_root)))
                
            except Exception:
                invalid_configs.append({
                    "file": str(json_file.relative_to(self.workspace_root)),
                    "error": f"JSON íŒŒì‹± ì˜¤ë¥˜: {str(e)}"
                })
            except Exception as e:
                invalid_configs.append({
                    "file": str(json_file.relative_to(self.workspace_root)),
                    "error": f"ê²€ì¦ ì‹¤íŒ¨: {str(e)}"
                })
        
        self.verification_results.append({
            "category": "JSON Configuration Files",
            "total_files": len(json_files),
            "valid_files": len(valid_configs),
            "invalid_files": len(invalid_configs),
            "status": "PASS" if len(invalid_configs) == 0 else "FAIL",
            "details": {
                "valid_configs": valid_configs[:10],
                "invalid_configs": invalid_configs
            }
        })

    def _verify_module_imports(self):
# BROKEN_REF:         """ëª¨ë“ˆ import ê²€ì¦"""
        logger.info("ğŸ“¦ ëª¨ë“ˆ import Monitoring/POSCO_News_250808/ğŸ“‹POSCO_ì‹œìŠ¤í…œ_ì •ë¦¬_ë°_ê²€ì¦_ì™„ë£Œ_20250806.md ì¤‘...")
        
        # ì£¼ìš” ëª¨ë“ˆë“¤ import .naming_backup/scripts/ğŸ§ªPOSCO_í…ŒìŠ¤íŠ¸_ì‹¤í–‰.bat
        test_modules = [
            "naming_convention_manager",
            "file_renaming_system",
            "python_naming_standardizer",
            "shell_batch_script_standardizer",
            "documentation_standardizer",
            "config_data_standardizer",
            "system_output_message_standardizer",
            "folder_structure_reorganizer",
            "naming_standardization_verification_system"
        ]
        
        successful_imports = []
        failed_imports = []
        
        # í˜„ì¬ ë””ë ‰í† ë¦¬ë¥¼ Python ê²½ë¡œì— ì¶”ê°€
        sys.path.insert(0, str(self.workspace_root))
        
        for module_name in test_modules:
            try:
# BROKEN_REF:                 module_file = self.workspace_root / f"{module_name}.py"
                if module_file.exists():
                    __import__(module_name)
                    successful_imports.append(module_name)
                else:
                    failed_imports.append({
                        "module": module_name,
                        "error": "ëª¨ë“ˆ íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŒ"
                    })
            except ImportError as e:
                failed_imports.append({
                    "module": module_name,
                    "error": f"Import ì˜¤ë¥˜: {str(e)}"
                })
            except Exception as e:
                failed_imports.append({
                    "module": module_name,
                    "error": f"ê²€ì¦ ì‹¤íŒ¨: {str(e)}"
                })
        
        self.verification_results.append({
            "category": "Module Imports",
            "total_modules": len(test_modules),
            "successful_imports": len(successful_imports),
            "failed_imports": len(failed_imports),
            "status": "PASS" if len(failed_imports) == 0 else "FAIL",
            "details": {
                "successful_imports": successful_imports,
                "failed_imports": failed_imports
            }
        })

    def _verify_file_references(self):
        """íŒŒì¼ ì°¸ì¡° ë¬´ê²°ì„± ê²€ì¦"""
        logger.info("ğŸ”— íŒŒì¼ ì°¸ì¡° ë¬´ê²°ì„± ê²€ì¦ ì¤‘...")
        
        broken_references = []
        valid_references = []
        
        # Python íŒŒì¼ì—ì„œ ë‹¤ë¥¸ íŒŒì¼ ì°¸ì¡° ê²€ì‚¬
        for py_file in self.workspace_root.rglob("*.py"):
            try:
with_open(py_file,_'r',_encoding = 'utf-8') as f:
                    content = f.read()
                
                # íŒŒì¼ ê²½ë¡œ ì°¸ì¡° íŒ¨í„´ ì°¾ê¸°
                import verify_folder_reorganization.py
                
                # ì¼ë°˜ì ì¸ íŒŒì¼ ì°¸ì¡° íŒ¨í„´ë“¤
                patterns = [
                    r'open\s*\(\s*["\']([^"\']+)["\']',  # open() í•¨ìˆ˜
                    r'Path\s*\(\s*["\']([^"\']+)["\']',  # Path() ìƒì„±ì
                    r'["\']([^"\']*\.(?:py|json|md|txt|log|bat|sh))["\']'  # íŒŒì¼ í™•ì¥ì íŒ¨í„´
                ]
                
                for pattern in patterns:
                    matches = re.findall(pattern, content)
                    for match in matches:
                        if not match.startswith('/') and not match.startswith('\\') and '/' in match:
                            # ìƒëŒ€ ê²½ë¡œë¡œ ë³´ì´ëŠ” íŒŒì¼ ì°¸ì¡°
                            referenced_file = self.workspace_root / match
                            if referenced_file.exists():
                                valid_references.append(f"{py_file.name} -> {match}")
                            else:
                                broken_references.append({
                                    "source_file": str(py_file.relative_to(self.workspace_root)),
                                    "referenced_file": match,
                                    "error": "ì°¸ì¡°ëœ íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŒ"
                                })
                                
            except Exception as e:
                logger.warning(f"íŒŒì¼ ì°¸ì¡° ê²€ì‚¬ ì‹¤íŒ¨ {py_file}: {e}")
        
        self.verification_results.append({
            "category": "File Reference Integrity",
            "valid_references": len(valid_references),
            "broken_references": len(broken_references),
            "status": "PASS" if len(broken_references) == 0 else "FAIL",
            "details": {
                "valid_references": valid_references[:10],
                "broken_references": broken_references
            }
        })

    def _verify_execution_permissions(self):
        """ì‹¤í–‰ ê¶Œí•œ ê²€ì¦"""
        logger.info("ğŸ” ì‹¤í–‰ ê¶Œí•œ ê²€ì¦ ì¤‘...")
        
        executable_files = []
        permission_issues = []
        
        # Shell ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ ê¶Œí•œ ê²€ì‚¬
        for sh_file in self.workspace_root.rglob("*.sh"):
            if os.access(sh_file, os.X_OK):
                executable_files.append(str(sh_file.relative_to(self.workspace_root)))
            else:
                permission_issues.append({
                    "file": str(sh_file.relative_to(self.workspace_root)),
                    "issue": "ì‹¤í–‰ ê¶Œí•œ ì—†ìŒ"
                })
        
        # Python ìŠ¤í¬ë¦½íŠ¸ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ python ì¸í„°í”„ë¦¬í„°ë¡œ ì‹¤í–‰ ê°€ëŠ¥
        for py_file in self.workspace_root.rglob("*.py"):
# BROKEN_REF:             if py_file.name.startswith('test_') or py_file.name.endswith('_test.py'):
                executable_files.append(str(py_file.relative_to(self.workspace_root)))
        
        self.verification_results.append({
            "category": "Execution Permissions",
            "executable_files": len(executable_files),
            "permission_issues": len(permission_issues),
            "status": "PASS" if len(permission_issues) == 0 else "FAIL",
            "details": {
                "executable_files": executable_files[:10],
                "permission_issues": permission_issues
            }
        })

    def _generate_verification_report(self) -> Dict:
        """ê²€ì¦ ë³´ê³ ì„œ ìƒì„±"""
        logger.info("ğŸ“Š ì‹œìŠ¤í…œ ê¸°ëŠ¥ ê²€ì¦ ë³´ê³ ì„œ ìƒì„± ì¤‘...")
        
        # ì „ì²´ í†µê³„ ê³„ì‚°
        total_categories = len(self.verification_results)
        passed_categories = len([r for r in self.verification_results if r['status'] == 'PASS'])
        failed_categories = total_categories - passed_categories
        
        overall_status = "PASS" if failed_categories == 0 else "FAIL"
        
        report = {
            "verification_summary": {
                "timestamp": datetime.now().isoformat(),
                "total_categories": total_categories,
                "passed_categories": passed_categories,
                "failed_categories": failed_categories,
                "overall_status": overall_status,
                "success_rate": round((passed_categories / total_categories * 100), 2) if total_categories > 0 else 0
            },
            "category_results": self.verification_results,
            "recommendations": self._generate_recommendations()
        }
        
        # JSON ë³´ê³ ì„œ ì €ì¥
        report_file = self.workspace_root / "system_functionality_verification_report.json"
with_open(report_file,_'w',_encoding = 'utf-8') as f:
json.dump(report,_f,_ensure_ascii = False, indent=2)
        
        # HTML ë³´ê³ ì„œ ìƒì„±
        self._generate_html_report(report)
        
        logger.info(f"ğŸ“„ ê²€ì¦ ë³´ê³ ì„œ ì €ì¥: {report_file}")
        
        return report

    def _generate_recommendations(self) -> List[str]:
        """ê¶Œì¥ì‚¬í•­ ìƒì„±"""
        recommendations = []
        
        for result in self.verification_results:
            if result['status'] == 'FAIL':
                category = result['category']
                
                if 'Python Scripts' in category:
                    recommendations.append("Python ìŠ¤í¬ë¦½íŠ¸ì˜ êµ¬ë¬¸ ì˜¤ë¥˜ë¥¼ ìˆ˜ì •í•˜ì„¸ìš”.")
                elif 'Shell Scripts' in category:
                    recommendations.append("Shell ìŠ¤í¬ë¦½íŠ¸ì˜ êµ¬ë¬¸ì„ ê²€í† í•˜ê³  ìˆ˜ì •í•˜ì„¸ìš”.")
                elif 'Batch Scripts' in category:
                    recommendations.append("Batch ìŠ¤í¬ë¦½íŠ¸ì˜ ëª…ë ¹ì–´ë¥¼ í™•ì¸í•˜ê³  ìˆ˜ì •í•˜ì„¸ìš”.")
                elif 'JSON' in category:
                    recommendations.append("JSON ì„¤ì • íŒŒì¼ì˜ í˜•ì‹ ì˜¤ë¥˜ë¥¼ ìˆ˜ì •í•˜ì„¸ìš”.")
                elif 'Module Imports' in category:
# BROKEN_REF:                     recommendations.append("ëª¨ë“ˆ import ì˜¤ë¥˜ë¥¼ í•´ê²°í•˜ê³  ì˜ì¡´ì„±ì„ í™•ì¸í•˜ì„¸ìš”.")
                elif 'File Reference' in category:
                    recommendations.append("ê¹¨ì§„ íŒŒì¼ ì°¸ì¡°ë¥¼ ìˆ˜ì •í•˜ê³  ê²½ë¡œë¥¼ í™•ì¸í•˜ì„¸ìš”.")
                elif 'Execution Permissions' in category:
                    recommendations.append("ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼ì˜ ì‹¤í–‰ ê¶Œí•œì„ ì„¤ì •í•˜ì„¸ìš”.")
        
        if not recommendations:
            recommendations.append("ëª¨ë“  ì‹œìŠ¤í…œ ê¸°ëŠ¥ì´ ì •ìƒì ìœ¼ë¡œ ê²€ì¦ë˜ì—ˆìŠµë‹ˆë‹¤.")
        
        return recommendations

    def _generate_html_report(self, report: Dict):
        """HTML ê²€ì¦ ë³´ê³ ì„œ ìƒì„±"""
        html_content = f"""
<!DOCTYPE html>
<html_lang = "ko">
<head>
<meta_charset = "UTF-8">
<meta_name = "viewport" content="width=device-width, initial-scale=1.0">
    <title>POSCO ì‹œìŠ¤í…œ ê¸°ëŠ¥ ê²€ì¦ ë³´ê³ ì„œ</title>
    <style>
        body {{ font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; padding: 20px; background-color: #f5f5f5; }}
        .container {{ max-width: 1200px; margin: 0 auto; background-color: white; padding: 30px; border-radius: 10px; box-shadow: 0 0 20px rgba(0,0,0,0.1); }}
        h1 {{ color: #2c3e50; text-align: center; margin-bottom: 30px; }}
        .summary {{ display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px; }}
        .summary-card {{ background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 10px; text-align: center; }}
        .summary-card h3 {{ margin: 0 0 10px 0; font-size: 2em; }}
        .summary-card p {{ margin: 0; opacity: 0.9; }}
        .status-pass {{ background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%); }}
        .status-fail {{ background: linear-gradient(135deg, #ff416c 0%, #ff4b2b 100%); }}
        .category-results {{ margin-bottom: 30px; }}
        .category-item {{ background-color: #f8f9fa; margin-bottom: 20px; padding: 20px; border-radius: 8px; }}
        .category-item.pass {{ border-left: 5px solid #27ae60; }}
        .category-item.fail {{ border-left: 5px solid #e74c3c; }}
        .category-header {{ display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }}
        .category-name {{ font-weight: bold; font-size: 1.2em; }}
        .category-status {{ padding: 5px 15px; border-radius: 20px; color: white; font-weight: bold; }}
        .status-pass-small {{ background-color: #27ae60; }}
        .status-fail-small {{ background-color: #e74c3c; }}
        .category-stats {{ display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 10px; margin-bottom: 15px; }}
        .stat-item {{ background-color: white; padding: 10px; border-radius: 5px; text-align: center; }}
        .stat-number {{ font-size: 1.5em; font-weight: bold; color: #2c3e50; }}
        .stat-label {{ font-size: 0.9em; color: #666; }}
        .details {{ background-color: white; padding: 15px; border-radius: 5px; margin-top: 10px; }}
        .details h4 {{ margin: 0 0 10px 0; color: #2c3e50; }}
        .details ul {{ margin: 5px 0; padding-left: 20px; }}
        .details li {{ margin-bottom: 5px; }}
        .recommendations {{ background-color: #e8f4fd; border: 1px solid #bee5eb; border-radius: 8px; padding: 20px; }}
        .recommendations h3 {{ color: #0c5460; margin-top: 0; }}
        .recommendations ul {{ margin: 10px 0; padding-left: 20px; }}
        .recommendations li {{ margin-bottom: 8px; }}
        .footer {{ text-align: center; margin-top: 30px; color: #666; font-size: 0.9em; }}
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” POSCO ì‹œìŠ¤í…œ ê¸°ëŠ¥ ê²€ì¦ ë³´ê³ ì„œ</h1>
        
        <div class="summary">
            <div class="summary-card">
                <h3>{report['verification_summary']['total_categories']}</h3>
                <p>ì´ ê²€ì¦ ì¹´í…Œê³ ë¦¬</p>
            </div>
            <div class="summary-card status-pass">
                <h3>{report['verification_summary']['passed_categories']}</h3>
                <p>í†µê³¼</p>
            </div>
            <div class="summary-card status-fail">
                <h3>{report['verification_summary']['failed_categories']}</h3>
                <p>ì‹¤íŒ¨</p>
            </div>
            <div class="summary-card">
                <h3>{report['verification_summary']['success_rate']}%</h3>
                <p>ì„±ê³µë¥ </p>
            </div>
        </div>
        
        <h2>ğŸ“‹ ì¹´í…Œê³ ë¦¬ë³„ ê²€ì¦ ê²°ê³¼</h2>
        <div class="category-results">
"""
        
        for result in report['category_results']:
            status_class = result['status'].lower()
            status_badge_class = f"status-{status_class}-small"
            
html_content_+ =  f"""
            <div class="category-item {status_class}">
                <div class="category-header">
                    <div class="category-name">{result['category']}</div>
                    <div class="category-status {status_badge_class}">{result['status']}</div>
                </div>
"""
            
            # í†µê³„ ì •ë³´ í‘œì‹œ
            if 'total_files' in result:
html_content_+ =  f"""
                <div class="category-stats">
                    <div class="stat-item">
                        <div class="stat-number">{result['total_files']}</div>
                        <div class="stat-label">ì´ íŒŒì¼</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number">{result['valid_files']}</div>
                        <div class="stat-label">ìœ íš¨</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number">{result['invalid_files']}</div>
                        <div class="stat-label">ë¬´íš¨</div>
                    </div>
                </div>
"""
            elif 'total_modules' in result:
html_content_+ =  f"""
                <div class="category-stats">
                    <div class="stat-item">
                        <div class="stat-number">{result['total_modules']}</div>
                        <div class="stat-label">ì´ ëª¨ë“ˆ</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number">{result['successful_imports']}</div>
                        <div class="stat-label">ì„±ê³µ</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number">{result['failed_imports']}</div>
                        <div class="stat-label">ì‹¤íŒ¨</div>
                    </div>
                </div>
"""
            
            # ìƒì„¸ ì •ë³´ í‘œì‹œ (ì‹¤íŒ¨í•œ í•­ëª©ì´ ìˆëŠ” ê²½ìš°)
            if result['status'] == 'FAIL' and 'details' in result:
html_content_+ =  '<div class="details">'
                
                if 'invalid_scripts' in result['details'] and result['details']['invalid_scripts']:
html_content_+ =  '<h4>âŒ ë¬¸ì œê°€ ìˆëŠ” íŒŒì¼:</h4><ul>'
                    for item in result['details']['invalid_scripts'][:5]:  # ì²˜ìŒ 5ê°œë§Œ í‘œì‹œ
                        if isinstance(item, dict):
html_content_+ =  f"<li><strong>{item['file']}</strong>: {item['error']}</li>"
                        else:
html_content_+ =  f"<li>{item}</li>"
html_content_+ =  '</ul>'
                
                if 'failed_imports' in result['details'] and result['details']['failed_imports']:
html_content_+ =  '<h4>âŒ Import ì‹¤íŒ¨:</h4><ul>'
                    for item in result['details']['failed_imports']:
html_content_+ =  f"<li><strong>{item['module']}</strong>: {item['error']}</li>"
html_content_+ =  '</ul>'
                
                if 'broken_references' in result['details'] and result['details']['broken_references']:
html_content_+ =  '<h4>âŒ ê¹¨ì§„ ì°¸ì¡°:</h4><ul>'
                    for item in result['details']['broken_references'][:5]:
html_content_+ =  f"<li><strong>{item['source_file']}</strong> â†’ {item['referenced_file']}: {item['error']}</li>"
html_content_+ =  '</ul>'
                
html_content_+ =  '</div>'
            
html_content_+ =  '</div>'
        
html_content_+ =  f"""
        </div>
        
        <div class="recommendations">
            <h3>ğŸ’¡ ê¶Œì¥ì‚¬í•­</h3>
            <ul>
"""
        
        for recommendation in report['recommendations']:
html_content_+ =  f"<li>{recommendation}</li>"
        
html_content_+ =  f"""
            </ul>
        </div>
        
        <div class="footer">
            <p>ê²€ì¦ ì™„ë£Œ ì‹œê°„: {report['verification_summary']['timestamp']}</p>
            <p>POSCO WatchHamster v3.0 & POSCO News 250808 ì‹œìŠ¤í…œ ê¸°ëŠ¥ ê²€ì¦</p>
        </div>
    </div>
</body>
</html>
"""
        
        html_file = self.workspace_root / "system_functionality_verification_report.html"
with_open(html_file,_'w',_encoding = 'utf-8') as f:
            f.write(html_content)
        
        logger.info(f"ğŸ“„ HTML ê²€ì¦ ë³´ê³ ì„œ ì €ì¥: {html_file}")


def main():
    """ë©”ì¸ ì‹¤í–‰ í•¨ìˆ˜"""
    print("ğŸ” POSCO ì‹œìŠ¤í…œ ê¸°ëŠ¥ ê²€ì¦ ì‹œì‘")
    print("=" * 60)
    
    verifier = SystemFunctionalityVerifier()
    report = verifier.verify_all_systems()
    
print("\n"_+_" = " * 60)
    print("ğŸ“Š ì‹œìŠ¤í…œ ê¸°ëŠ¥ ê²€ì¦ ê²°ê³¼")
    print("=" * 60)
    print(f"ì´ ê²€ì¦ ì¹´í…Œê³ ë¦¬: {report['verification_summary']['total_categories']}")
    print(f"í†µê³¼: {report['verification_summary']['passed_categories']}")
    print(f"ì‹¤íŒ¨: {report['verification_summary']['failed_categories']}")
    print(f"ì„±ê³µë¥ : {report['verification_summary']['success_rate']}%")
    print(f"ì „ì²´ ìƒíƒœ: {report['verification_summary']['overall_status']}")
    
    if report['verification_summary']['overall_status'] == "FAIL":
        print("\nâŒ ì¼ë¶€ ì‹œìŠ¤í…œ ê¸°ëŠ¥ì— ë¬¸ì œê°€ ìˆìŠµë‹ˆë‹¤. ìƒì„¸ ë³´ê³ ì„œë¥¼ í™•ì¸í•˜ì„¸ìš”.")
        return 1
    else:
        print("\nâœ… ëª¨ë“  ì‹œìŠ¤í…œ ê¸°ëŠ¥ì´ ì •ìƒì ìœ¼ë¡œ ê²€ì¦ë˜ì—ˆìŠµë‹ˆë‹¤!")
        return 0


if __name__ == "__main__":
    sys.exit(main())