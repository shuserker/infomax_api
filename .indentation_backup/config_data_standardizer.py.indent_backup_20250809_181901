#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
POSCO ì„¤ì • íŒŒì¼ ë° ë°ì´í„° íŒŒì¼ í‘œì¤€í™” ì‹œìŠ¤í…œ
Configuration and Data File Standardization System

ì´ ëª¨ë“ˆì€ POSCO í”„ë¡œì íŠ¸ì˜ ëª¨ë“  JSON ì„¤ì • íŒŒì¼, ë°ì´í„° íŒŒì¼, í™˜ê²½ ë³€ìˆ˜, ë¡œê·¸ íŒŒì¼ëª…ì„
ì¼ê´€ëœ ë„¤ì´ë° ì»¨ë²¤ì…˜ìœ¼ë¡œ í‘œì¤€í™”í•©ë‹ˆë‹¤.

ì£¼ìš” ê¸°ëŠ¥:
- JSON ì„¤ì • íŒŒì¼ì˜ ë²„ì „ ì •ë³´ í•„ë“œ í‘œì¤€í™”
- í™˜ê²½ ë³€ìˆ˜ëª… í†µì¼ ë° í‘œì¤€í™”  
- ë¡œê·¸ íŒŒì¼ëª… ë° ë°ì´í„° íŒŒì¼ëª… í‘œì¤€í™”
- ì„¤ì • íŒŒì¼ ë‚´ë¶€ ì£¼ì„ ë° ì„¤ëª… í‘œì¤€í™”

ë²„ì „ ì²´ê³„:
- WatchHamster: v3.0 (ë©”ì´ì €.ë§ˆì´ë„ˆ)
- POSCO News 250808 250808 250808 250808 250808: 250808 (ë‚ ì§œ ê¸°ë°˜)
"""

import os
import json
import re
import shutil
from datetime import datetime
from typing import Dict, List, Tuple, Any, Optional
from pathlib import Path
import logging

class ConfigDataStandardizer:
    """ì„¤ì • íŒŒì¼ ë° ë°ì´í„° íŒŒì¼ í‘œì¤€í™” í´ë˜ìŠ¤"""
    
    # ë²„ì „ ì •ë³´ ìƒìˆ˜
    WATCHHAMSTER_VERSION = "v3.0"
POSCO_News_250808_250808_250808_250808_250808_250808_VERSION =  "250808"
    
    # í‘œì¤€í™” ê·œì¹™
    STANDARD_VERSION_FIELDS = {
        "watchhamster_version": WATCHHAMSTER_VERSION,
        "POSCO News 250808 250808 250808 250808 250808 250808_version": POSCO News 250808 250808 250808 250808 250808 250808_VERSION,
        "system_version": f"WatchHamster_{WATCHHAMSTER_VERSION}_POSCO News 250808 250808 250808 250808 250808 250808_{POSCO News 250808 250808 250808 250808 250808 250808_VERSION}",
        "last_updated": datetime.now().strftime("%Y-%m-%dT%H:%M:%S"),
        "standardization_date": datetime.now().strftime("%Y-%m-%d")
    }
    
    # í™˜ê²½ ë³€ìˆ˜ í‘œì¤€í™” ë§¤í•‘
    ENV_VAR_MAPPING = {
        # WatchHamster ê´€ë ¨
        "WATCHHAMSTER_VERSION": WATCHHAMSTER_VERSION,
        "WATCHHAMSTER_V3_0_ENABLED": "true",
        "WATCHHAMSTER_V3_0_LOG_LEVEL": "INFO",
        "WATCHHAMSTER_V3_0_CONFIG_PATH": "./config",
        
        # POSCO News 250808 250808 250808 250808 250808 ê´€ë ¨
        "POSCO News 250808 250808 250808 250808 250808 250808_VERSION": POSCO News 250808 250808 250808 250808 250808 250808_VERSION,
        "POSCO News 250808 250808 250808 250808 250808 250808_250808_ENABLED": "true",
        "POSCO News 250808 250808 250808 250808 250808 250808_250808_LOG_LEVEL": "INFO",
        "POSCO News 250808 250808 250808 250808 250808 250808_250808_DATA_PATH": "./data",
        
        # ì‹œìŠ¤í…œ ê³µí†µ
        "POSCO_SYSTEM_VERSION": f"WatchHamster_{WATCHHAMSTER_VERSION}_POSCO News 250808 250808 250808 250808 250808 250808_{POSCO News 250808 250808 250808 250808 250808 250808_VERSION}",
        "POSCO_STANDARDIZATION_ENABLED": "true"
    }
    
    # íŒŒì¼ëª… í‘œì¤€í™” íŒ¨í„´
    FILE_NAMING_PATTERNS = {
        # ë¡œê·¸ íŒŒì¼
        "log_files": {
            "watchhamster": "WatchHamster_v3.0_{suffix}.log",
            "POSCO News 250808 250808 250808 250808 250808 250808": "POSCO News 250808 250808 250808 250808 250808 250808_250808_{suffix}.log",
            "system": "posco_system_{suffix}.log"
        },
        
        # ë°ì´í„° íŒŒì¼
        "data_files": {
            "watchhamster": "watchhamster_v3_0_{suffix}.json",
            "POSCO News 250808 250808 250808 250808 250808 250808": "POSCO News 250808 250808 250808 250808 250808 250808_250808_{suffix}.json",
            "config": "posco_config_{suffix}.json"
        },
        
        # ìƒíƒœ íŒŒì¼
        "status_files": {
            "watchhamster": "WatchHamster_v3.0_status.json",
            "POSCO News 250808 250808 250808 250808 250808 250808": "POSCO News 250808 250808 250808 250808 250808 250808_250808_status.json",
            "system": "posco_system_status.json"
        }
    }
    
    def __init__(self, workspace_root: str = "."):
        """
        ì´ˆê¸°í™”
        
        Args:
            workspace_root: ì‘ì—… ê³µê°„ ë£¨íŠ¸ ë””ë ‰í† ë¦¬
        """
        self.workspace_root = Path(workspace_root).resolve()
        self.backup_dir = self.workspace_root / ".naming_backup" / "config_data_backup"
        self.backup_dir.mkdir(parents=True, exist_ok=True)
        
        # ë¡œê¹… ì„¤ì •
        self.setup_logging()
        
        # ë³€ê²½ ì‘ì—… ì¶”ì 
        self.changes_log = []
        
        self.logger.info("ğŸ”§ POSCO ì„¤ì • íŒŒì¼ ë° ë°ì´í„° íŒŒì¼ í‘œì¤€í™” ì‹œìŠ¤í…œ ì´ˆê¸°í™” ì™„ë£Œ")
        self.logger.info(f"ğŸ“ ì‘ì—… ê³µê°„: {self.workspace_root}")
        self.logger.info(f"ğŸ’¾ ë°±ì—… ë””ë ‰í† ë¦¬: {self.backup_dir}")
    
    def setup_logging(self):
        """ë¡œê¹… ì„¤ì •"""
        log_file = self.workspace_root / "config_data_standardization.log"
        
        logging.basicConfig(
            level=logging.INFO,
            format='%(asctime)s - %(levelname)s - %(message)s',
            handlers=[
logging.FileHandler(log_file,_encoding = 'utf-8'),
                logging.StreamHandler()
            ]
        )
        self.logger = logging.getLogger(__name__)
    
    def find_json_files(self) -> List[Path]:
        """JSON íŒŒì¼ ì°¾ê¸°"""
        json_files = []
        
        # ì£¼ìš” JSON íŒŒì¼ íŒ¨í„´
        patterns = [
            "*.json",
            "**/modules.json",
            "**/config.json",
            "**/settings.json",
            "**/*_config.json",
            "**/*_data.json",
            "**/*_cache.json",
            "**/*_status.json"
        ]
        
        for pattern in patterns:
            json_files.extend(self.workspace_root.glob(pattern))
        
        # ì¤‘ë³µ ì œê±° ë° ì •ë ¬
        json_files = list(set(json_files))
        json_files.sort()
        
        self.logger.info(f"ğŸ“‹ ë°œê²¬ëœ JSON íŒŒì¼: {len(json_files)}ê°œ")
        for file_path in json_files:
            self.logger.info(f"  â€¢ {file_path.relative_to(self.workspace_root)}")
        
        return json_files
    
    def backup_file(self, file_path: Path) -> Path:
        """íŒŒì¼ ë°±ì—…"""
        relative_path = file_path.relative_to(self.workspace_root)
        backup_path = self.backup_dir / relative_path
        backup_path.parent.mkdir(parents=True, exist_ok=True)
        
        shutil.copy2(file_path, backup_path)
        self.logger.info(f"ğŸ’¾ ë°±ì—… ì™„ë£Œ: {relative_path}")
        
        return backup_path
    
    def standardize_json_content(self, content: Dict[str, Any], file_path: Path) -> Tuple[Dict[str, Any], bool]:
        """JSON ë‚´ìš© í‘œì¤€í™”"""
        modified = False
        standardized_content = content.copy()
        
        # 1. ë©”íƒ€ë°ì´í„° ì„¹ì…˜ ì¶”ê°€/ì—…ë°ì´íŠ¸
        if "metadata" not in standardized_content:
            standardized_content["metadata"] = {}
            modified = True
        
        # 2. ë²„ì „ ì •ë³´ í‘œì¤€í™”
        metadata = standardized_content["metadata"]
        for field, value in self.STANDARD_VERSION_FIELDS.items():
            if field not in metadata or metadata[field] != value:
                metadata[field] = value
                modified = True
        
        # 3. ì„¤ëª… í•„ë“œ í‘œì¤€í™”
        if "description" not in metadata:
            if "watchhamster" in str(file_path).lower() or "v3" in str(file_path).lower():
                metadata["description"] = f"POSCO WatchHamster {self.WATCHHAMSTER_VERSION} Configuration"
            elif "POSCO News 250808 250808 250808 250808 250808 250808" in str(file_path).lower() or "250808" in str(file_path).lower():
                metadata["description"] = f"POSCO News 250808 250808 250808 250808 250808 {self.POSCO News 250808 250808 250808 250808 250808 250808_VERSION} Configuration"
            else:
                metadata["description"] = f"POSCO System Configuration - {self.STANDARD_VERSION_FIELDS['system_version']}"
            modified = True
        
        # 4. ëª¨ë“ˆ ì„¤ì • í‘œì¤€í™” (modules.jsonì˜ ê²½ìš°)
        if "modules" in standardized_content:
            modules = standardized_content["modules"]
            for module_name, module_config in modules.items():
                if isinstance(module_config, dict):
                    # í™˜ê²½ ë³€ìˆ˜ í‘œì¤€í™”
                    if "environment_vars" in module_config:
                        env_vars = module_config["environment_vars"]
                        for env_key, env_value in self.ENV_VAR_MAPPING.items():
                            if env_key not in env_vars:
                                env_vars[env_key] = env_value
                                modified = True
                    
                    # ì„¤ëª… í•„ë“œ í‘œì¤€í™”
                    if "description" in module_config:
                        desc = module_config["description"]
                        # ë²„ì „ ì •ë³´ ì—…ë°ì´íŠ¸
                        if "v2" in desc or "mini_v2" in desc:
                            desc = desc.replace("v2", self.WATCHHAMSTER_VERSION)
                            desc = desc.replace("mini_v2", self.POSCO News 250808 250808 250808 250808 250808 250808_VERSION)
                            module_config["description"] = desc
                            modified = True
        
        # 5. ì‹œìŠ¤í…œ ì„¤ì • í‘œì¤€í™”
        if "system_info" in standardized_content:
            system_info = standardized_content["system_info"]
            for field, value in self.STANDARD_VERSION_FIELDS.items():
                if field not in system_info or system_info[field] != value:
                    system_info[field] = value
                    modified = True
        
        return standardized_content, modified
    
    def standardize_json_files(self) -> List[Dict[str, Any]]:
        """JSON íŒŒì¼ë“¤ í‘œì¤€í™”"""
        json_files = self.find_json_files()
        results = []
        
        for file_path in json_files:
            try:
                self.logger.info(f"ğŸ”§ JSON íŒŒì¼ í‘œì¤€í™” ì‹œì‘: {file_path.relative_to(self.workspace_root)}")
                
                # ë°±ì—… ìƒì„±
                backup_path = self.backup_file(file_path)
                
                # JSON íŒŒì¼ ì½ê¸°
with_open(file_path,_'r',_encoding = 'utf-8') as f:
                    content = json.load(f)
                
                # ë‚´ìš© í‘œì¤€í™”
                standardized_content, modified = self.standardize_json_content(content, file_path)
                
                if modified:
                    # í‘œì¤€í™”ëœ ë‚´ìš©ìœ¼ë¡œ íŒŒì¼ ì—…ë°ì´íŠ¸
with_open(file_path,_'w',_encoding = 'utf-8') as f:
json.dump(standardized_content,_f,_ensure_ascii = False, indent=2)
                    
                    result = {
                        "file": str(file_path.relative_to(self.workspace_root)),
                        "status": "modified",
                        "backup": str(backup_path.relative_to(self.workspace_root)),
                        "changes": "ë²„ì „ ì •ë³´ ë° ë©”íƒ€ë°ì´í„° í‘œì¤€í™”"
                    }
                    self.logger.info(f"âœ… JSON íŒŒì¼ í‘œì¤€í™” ì™„ë£Œ: {file_path.name}")
                else:
                    result = {
                        "file": str(file_path.relative_to(self.workspace_root)),
                        "status": "unchanged",
                        "backup": str(backup_path.relative_to(self.workspace_root)),
                        "changes": "ë³€ê²½ ì‚¬í•­ ì—†ìŒ"
                    }
                    self.logger.info(f"â„¹ï¸ JSON íŒŒì¼ ë³€ê²½ ì—†ìŒ: {file_path.name}")
                
                results.append(result)
                self.changes_log.append(result)
                
            except Exception as e:
                error_result = {
                    "file": str(file_path.relative_to(self.workspace_root)),
                    "status": "error",
                    "error": str(e)
                }
                results.append(error_result)
                self.logger.error(f"âŒ JSON íŒŒì¼ í‘œì¤€í™” ì‹¤íŒ¨: {file_path.name} - {e}")
        
        return results
    
    def standardize_log_file_names(self) -> List[Dict[str, Any]]:
        """ë¡œê·¸ íŒŒì¼ëª… í‘œì¤€í™”"""
        results = []
        
        # ë¡œê·¸ íŒŒì¼ íŒ¨í„´ ì°¾ê¸°
        log_patterns = ["*.log", "**/*.log"]
        log_files = []
        
        for pattern in log_patterns:
            log_files.extend(self.workspace_root.glob(pattern))
        
        log_files = list(set(log_files))
        
        for log_file in log_files:
            try:
                old_name = log_file.name
                new_name = self.get_standardized_log_name(old_name)
                
                if new_name != old_name:
                    new_path = log_file.parent / new_name
                    
                    # ë°±ì—… ìƒì„±
                    backup_path = self.backup_file(log_file)
                    
                    # íŒŒì¼ëª… ë³€ê²½
                    log_file.rename(new_path)
                    
                    result = {
                        "old_name": old_name,
                        "new_name": new_name,
                        "path": str(log_file.parent.relative_to(self.workspace_root)),
                        "status": "renamed",
                        "backup": str(backup_path.relative_to(self.workspace_root))
                    }
                    
                    self.logger.info(f"ğŸ“ ë¡œê·¸ íŒŒì¼ëª… ë³€ê²½: {old_name} â†’ {new_name}")
                else:
                    result = {
                        "old_name": old_name,
                        "new_name": new_name,
                        "path": str(log_file.parent.relative_to(self.workspace_root)),
                        "status": "unchanged"
                    }
                
                results.append(result)
                
            except Exception as e:
                error_result = {
                    "old_name": log_file.name,
                    "status": "error",
                    "error": str(e)
                }
                results.append(error_result)
                self.logger.error(f"âŒ ë¡œê·¸ íŒŒì¼ëª… ë³€ê²½ ì‹¤íŒ¨: {log_file.name} - {e}")
        
        return results
    
    def get_standardized_log_name(self, filename: str) -> str:
        """í‘œì¤€í™”ëœ ë¡œê·¸ íŒŒì¼ëª… ìƒì„±"""
        # ê¸°ì¡´ íŒ¨í„´ ë§¤ì¹­ ë° ë³€í™˜
        patterns = [
            # WatchHamster ê´€ë ¨
            (r"watchhamster.*\.log", lambda m: f"WatchHamster_{self.WATCHHAMSTER_VERSION}.log"),
            (r"WatchHamster.*\.log", lambda m: f"WatchHamster_{self.WATCHHAMSTER_VERSION}.log"),
            
            # POSCO News 250808 250808 250808 250808 250808 ê´€ë ¨
            (r"POSCO News 250808 250808 250808 250808 250808 250808.*\.log", lambda m: f"POSCO News 250808 250808 250808 250808 250808 250808_{self.POSCO News 250808 250808 250808 250808 250808 250808_VERSION}.log"),
            (r"posco_main.*\.log", lambda m: f"POSCO News 250808 250808 250808 250808 250808 250808_{self.POSCO News 250808 250808 250808 250808 250808 250808_VERSION}_main.log"),
            (r"posco_monitor.*\.log", lambda m: f"POSCO News 250808 250808 250808 250808 250808 250808_{self.POSCO News 250808 250808 250808 250808 250808 250808_VERSION}_monitor.log"),
            
            # ì¼ë°˜ ì‹œìŠ¤í…œ ë¡œê·¸
            (r"main_notifier.*\.log", lambda m: f"POSCO News 250808 250808 250808 250808 250808 250808_{self.POSCO News 250808 250808 250808 250808 250808 250808_VERSION}_notifier.log"),
            (r"simple_monitor.*\.log", lambda m: f"POSCO News 250808 250808 250808 250808 250808 250808_{self.POSCO News 250808 250808 250808 250808 250808 250808_VERSION}_simple_monitor.log"),
        ]
        
        for pattern, replacement in patterns:
            if re.match(pattern, filename, re.IGNORECASE):
                return replacement(None)
        
        return filename
    
    def standardize_data_file_names(self) -> List[Dict[str, Any]]:
        """ë°ì´í„° íŒŒì¼ëª… í‘œì¤€í™”"""
        results = []
        
        # ë°ì´í„° íŒŒì¼ íŒ¨í„´
        data_patterns = [
            "*_data.json", "*_cache.json", "*_status.json",
            "**/*_data.json", "**/*_cache.json", "**/*_status.json"
        ]
        
        data_files = []
        for pattern in data_patterns:
            data_files.extend(self.workspace_root.glob(pattern))
        
        data_files = list(set(data_files))
        
        for data_file in data_files:
            try:
                old_name = data_file.name
                new_name = self.get_standardized_data_name(old_name)
                
                if new_name != old_name:
                    new_path = data_file.parent / new_name
                    
                    # ë°±ì—… ìƒì„±
                    backup_path = self.backup_file(data_file)
                    
                    # íŒŒì¼ëª… ë³€ê²½
                    data_file.rename(new_path)
                    
                    result = {
                        "old_name": old_name,
                        "new_name": new_name,
                        "path": str(data_file.parent.relative_to(self.workspace_root)),
                        "status": "renamed",
                        "backup": str(backup_path.relative_to(self.workspace_root))
                    }
                    
                    self.logger.info(f"ğŸ’¾ ë°ì´í„° íŒŒì¼ëª… ë³€ê²½: {old_name} â†’ {new_name}")
                else:
                    result = {
                        "old_name": old_name,
                        "new_name": new_name,
                        "path": str(data_file.parent.relative_to(self.workspace_root)),
                        "status": "unchanged"
                    }
                
                results.append(result)
                
            except Exception as e:
                error_result = {
                    "old_name": data_file.name,
                    "status": "error",
                    "error": str(e)
                }
                results.append(error_result)
                self.logger.error(f"âŒ ë°ì´í„° íŒŒì¼ëª… ë³€ê²½ ì‹¤íŒ¨: {data_file.name} - {e}")
        
        return results
    
    def get_standardized_data_name(self, filename: str) -> str:
        """í‘œì¤€í™”ëœ ë°ì´í„° íŒŒì¼ëª… ìƒì„±"""
        patterns = [
            # POSCO News 250808 250808 250808 250808 250808 ë°ì´í„° íŒŒì¼
            (r"POSCO News 250808 250808 250808 250808 250808 250808_data\.json", f"POSCO News 250808 250808 250808 250808 250808 250808_{self.POSCO News 250808 250808 250808 250808 250808 250808_VERSION}_data.json"),
            (r"POSCO News 250808 250808 250808 250808 250808 250808_cache\.json", f"POSCO News 250808 250808 250808 250808 250808 250808_{self.POSCO News 250808 250808 250808 250808 250808 250808_VERSION}_cache.json"),
            (r"POSCO News 250808 250808 250808 250808 250808 250808_historical.*\.json", f"POSCO News 250808 250808 250808 250808 250808 250808_{self.POSCO News 250808 250808 250808 250808 250808 250808_VERSION}_historical.json"),
            
            # WatchHamster ìƒíƒœ íŒŒì¼
            (r"WatchHamster_status\.json", f"WatchHamster_{self.WATCHHAMSTER_VERSION}_status.json"),
            
            # ê¸°íƒ€ ì‹œìŠ¤í…œ íŒŒì¼
            (r"system_status\.json", f"posco_system_{self.POSCO News 250808 250808 250808 250808 250808 250808_VERSION}_status.json"),
            (r"main_notifier_state\.json", f"POSCO News 250808 250808 250808 250808 250808 250808_{self.POSCO News 250808 250808 250808 250808 250808 250808_VERSION}_notifier_state.json"),
        ]
        
        for pattern, replacement in patterns:
            if re.match(pattern, filename, re.IGNORECASE):
                return replacement
        
        return filename
    
    def create_environment_variables_file(self) -> str:
        """í™˜ê²½ ë³€ìˆ˜ íŒŒì¼ ìƒì„±"""
        env_file_path = self.workspace_root / "posco_environment_variables.env"
        
        env_content = [
            "# POSCO ì‹œìŠ¤í…œ í™˜ê²½ ë³€ìˆ˜ ì„¤ì •",
            f"# ìƒì„±ì¼: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}",
            f"# í‘œì¤€í™” ë²„ì „: WatchHamster {self.WATCHHAMSTER_VERSION}, POSCO News 250808 250808 250808 250808 250808 {self.POSCO News 250808 250808 250808 250808 250808 250808_VERSION}",
            "",
            "# WatchHamster v3.0 ê´€ë ¨ í™˜ê²½ ë³€ìˆ˜",
        ]
        
        for env_key, env_value in self.ENV_VAR_MAPPING.items():
            env_content.append(f"{env_key}={env_value}")
        
        env_content.extend([
            "",
            "# ì‚¬ìš©ë²•:",
            "# Linux/Mac: source posco_environment_variables.env",
            "# Windows: ê° ë³€ìˆ˜ë¥¼ ê°œë³„ì ìœ¼ë¡œ set ëª…ë ¹ì–´ë¡œ ì„¤ì •",
            ""
        ])
        
with_open(env_file_path,_'w',_encoding = 'utf-8') as f:
            f.write('\n'.join(env_content))
        
        self.logger.info(f"ğŸŒ í™˜ê²½ ë³€ìˆ˜ íŒŒì¼ ìƒì„±: {env_file_path.name}")
        return str(env_file_path)
    
    def generate_standardization_report(self) -> Dict[str, Any]:
        """í‘œì¤€í™” ì‘ì—… ë³´ê³ ì„œ ìƒì„±"""
        report = {
            "standardization_info": {
                "timestamp": datetime.now().isoformat(),
                "watchhamster_version": self.WATCHHAMSTER_VERSION,
                "POSCO News 250808 250808 250808 250808 250808 250808_version": self.POSCO News 250808 250808 250808 250808 250808 250808_VERSION,
                "workspace_root": str(self.workspace_root)
            },
            "summary": {
                "total_changes": len(self.changes_log),
                "successful_changes": len([c for c in self.changes_log if c.get("status") == "modified"]),
                "failed_changes": len([c for c in self.changes_log if c.get("status") == "error"]),
                "unchanged_files": len([c for c in self.changes_log if c.get("status") == "unchanged"])
            },
            "changes_log": self.changes_log,
            "backup_location": str(self.backup_dir.relative_to(self.workspace_root))
        }
        
        # ë³´ê³ ì„œ íŒŒì¼ ì €ì¥
        report_file = self.workspace_root / "config_data_standardization_report.json"
with_open(report_file,_'w',_encoding = 'utf-8') as f:
json.dump(report,_f,_ensure_ascii = False, indent=2)
        
        self.logger.info(f"ğŸ“Š í‘œì¤€í™” ë³´ê³ ì„œ ìƒì„±: {report_file.name}")
        return report
    
    def run_full_standardization(self) -> Dict[str, Any]:
        """ì „ì²´ í‘œì¤€í™” ì‘ì—… ì‹¤í–‰"""
        self.logger.info("ğŸš€ POSCO ì„¤ì • íŒŒì¼ ë° ë°ì´í„° íŒŒì¼ ì „ì²´ í‘œì¤€í™” ì‹œì‘")
        
        try:
            # 1. JSON íŒŒì¼ í‘œì¤€í™”
            self.logger.info("ğŸ“‹ 1ë‹¨ê³„: JSON ì„¤ì • íŒŒì¼ í‘œì¤€í™”")
            json_results = self.standardize_json_files()
            
            # 2. ë¡œê·¸ íŒŒì¼ëª… í‘œì¤€í™”
            self.logger.info("ğŸ“ 2ë‹¨ê³„: ë¡œê·¸ íŒŒì¼ëª… í‘œì¤€í™”")
            log_results = self.standardize_log_file_names()
            
            # 3. ë°ì´í„° íŒŒì¼ëª… í‘œì¤€í™”
            self.logger.info("ğŸ’¾ 3ë‹¨ê³„: ë°ì´í„° íŒŒì¼ëª… í‘œì¤€í™”")
            data_results = self.standardize_data_file_names()
            
            # 4. í™˜ê²½ ë³€ìˆ˜ íŒŒì¼ ìƒì„±
            self.logger.info("ğŸŒ 4ë‹¨ê³„: í™˜ê²½ ë³€ìˆ˜ íŒŒì¼ ìƒì„±")
            env_file = self.create_environment_variables_file()
            
            # 5. ë³´ê³ ì„œ ìƒì„±
            self.logger.info("ğŸ“Š 5ë‹¨ê³„: í‘œì¤€í™” ë³´ê³ ì„œ ìƒì„±")
            report = self.generate_standardization_report()
            
            # ê²°ê³¼ ìš”ì•½
            total_files = len(json_results) + len(log_results) + len(data_results)
            modified_files = (
                len([r for r in json_results if r.get("status") == "modified"]) +
                len([r for r in log_results if r.get("status") == "renamed"]) +
                len([r for r in data_results if r.get("status") == "renamed"])
            )
            
            self.logger.info("ğŸ‰ POSCO ì„¤ì • íŒŒì¼ ë° ë°ì´í„° íŒŒì¼ í‘œì¤€í™” ì™„ë£Œ!")
            self.logger.info(f"ğŸ“Š ì²˜ë¦¬ëœ íŒŒì¼: {total_files}ê°œ")
            self.logger.info(f"âœ… ë³€ê²½ëœ íŒŒì¼: {modified_files}ê°œ")
            self.logger.info(f"ğŸ’¾ ë°±ì—… ìœ„ì¹˜: {self.backup_dir}")
            
            return {
                "success": True,
                "json_results": json_results,
                "log_results": log_results,
                "data_results": data_results,
                "env_file": env_file,
                "report": report
            }
            
        except Exception as e:
            self.logger.error(f"âŒ í‘œì¤€í™” ì‘ì—… ì¤‘ ì˜¤ë¥˜ ë°œìƒ: {e}")
            return {
                "success": False,
                "error": str(e)
            }

def main():
    """ë©”ì¸ ì‹¤í–‰ í•¨ìˆ˜"""
    print("ğŸ”§ POSCO ì„¤ì • íŒŒì¼ ë° ë°ì´í„° íŒŒì¼ í‘œì¤€í™” ì‹œìŠ¤í…œ")
    print("=" * 60)
    
    # í‘œì¤€í™” ì‹œìŠ¤í…œ ì´ˆê¸°í™”
    standardizer = ConfigDataStandardizer()
    
    # ì „ì²´ í‘œì¤€í™” ì‹¤í–‰
    results = standardizer.run_full_standardization()
    
    if results["success"]:
        print("\nâœ… í‘œì¤€í™” ì‘ì—…ì´ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!")
        print(f"ğŸ“Š JSON íŒŒì¼: {len(results['json_results'])}ê°œ ì²˜ë¦¬")
        print(f"ğŸ“ ë¡œê·¸ íŒŒì¼: {len(results['log_results'])}ê°œ ì²˜ë¦¬")
        print(f"ğŸ’¾ ë°ì´í„° íŒŒì¼: {len(results['data_results'])}ê°œ ì²˜ë¦¬")
        print(f"ğŸŒ í™˜ê²½ ë³€ìˆ˜ íŒŒì¼: {results['env_file']}")
    else:
        print(f"\nâŒ í‘œì¤€í™” ì‘ì—… ì‹¤íŒ¨: {results['error']}")
        return 1
    
    return 0

if __name__ == "__main__":
    exit(main())