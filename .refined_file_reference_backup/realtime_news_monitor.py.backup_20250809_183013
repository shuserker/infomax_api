#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Realtime News Monitor
POSCO ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ

WatchHamster v3.0 ë° POSCO News 250808 í˜¸í™˜
Created: 2025-08-08
"""

import posco_news_250808_monitor.log
import system_functionality_verification.py
import .comprehensive_repair_backup/realtime_news_monitor.py.backup_20250809_181657
# BROKEN_REF: import requests
# BROKEN_REF: from datetime import datetime, timedelta
import test_config.json

# í˜„ì¬ ìŠ¤í¬ë¦½íŠ¸ ë””ë ‰í† ë¦¬ë¥¼ Python ê²½ë¡œì— ì¶”ê°€
current_dir = os.path.dirname(os.path.abspath(__file__))
sys.path.insert(0, current_dir)

try:
from core import posco_news_250808_monitor.log News 250808DataProcessor, DoorayNotifier
    from .git/config import .git/config, DOORAY_WEBHOOK_URL, BOT_PROFILE_IMAGE_URL
# BROKEN_REF:     from Monitoring/POSCO_News_250808/backup_archive_20250806/disabled_monitors_20250803/newyork_monitor.py import NewYorkMarketMonitor
# BROKEN_REF:     from Monitoring/POSCO_News_250808/backup_archive_20250806/disabled_monitors_20250803/kospi_monitor.py import KospiCloseMonitor
# BROKEN_REF:     from Monitoring/POSCO_News_250808/backup_archive_20250806/disabled_monitors_20250803/exchange_monitor.py import ExchangeRateMonitor
# BROKEN_REF:     from Monitoring/POSCO_News_250808/backup_archive_20250806/disabled_monitors_20250803/master_news_monitor.py import MasterNewsMonitor
# BROKEN_REF:     from Monitoring/POSCO_News_250808/core/state_manager.py import StateManager
# BROKEN_REF:     from Monitoring/POSCO_News_250808/core/process_manager.py import ProcessManager
    try:
# BROKEN_REF:         from Monitoring/POSCO_News_250808/core/colorful_ui.py import ColorfulConsoleUI
    except ImportError:
        ColorfulConsoleUI = None
except ImportError as e:
    print(f"[ERROR] í•„ìˆ˜ ëª¨ë“ˆì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤: {e}")
    sys.exit(1)

class RealtimeNewsMonitor:
    """
    ì‹¤ì‹œê°„ ë‰´ìŠ¤ ëª¨ë‹ˆí„°ë§ í´ë˜ìŠ¤
    """
    
    def __init__(self):
        """
        ì‹¤ì‹œê°„ ëª¨ë‹ˆí„° ì´ˆê¸°í™” (ì›Œì¹˜í–„ìŠ¤í„° ê¸°ëŠ¥ ì™„ì „ ì´ê´€)
        """
        self.api_client = POSCO News 250808APIClient(API_CONFIG)
        
        # ê° ë‰´ìŠ¤ ëª¨ë‹ˆí„° ì´ˆê¸°í™” (ì›Œì¹˜í–„ìŠ¤í„°ì™€ ë™ì¼)
        self.monitors = {
            'exchange-rate': {
                'monitor': ExchangeRateMonitor(),
                'name': 'ğŸ’± ì„œí™˜ë§ˆê°',
                'last_title': None,
                'last_check': None
            },
            'kospi-close': {
                'monitor': KospiCloseMonitor(),
                'name': 'ğŸ“ˆ ì¦ì‹œë§ˆê°',
                'last_title': None,
                'last_check': None
            },
            'newyork-market-watch': {
                'monitor': NewYorkMarketMonitor(),
                'name': 'ğŸŒ† ë‰´ìš•ë§ˆì¼“ì›Œì¹˜',
                'last_title': None,
                'last_check': None
            }
        }
        
        # ì›Œì¹˜í–„ìŠ¤í„°ì—ì„œ ì´ê´€ëœ ê°œë³„ ëª¨ë‹ˆí„° ê°ì²´ë“¤
        self.newyork_monitor = NewYorkMarketMonitor()
        self.kospi_monitor = KospiCloseMonitor()
        self.exchange_monitor = ExchangeRateMonitor()
        
        # ë§ˆìŠ¤í„° ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ ì´ˆê¸°í™” (ì›Œì¹˜í–„ìŠ¤í„°ì—ì„œ ì´ê´€)
        try:
            self.master_monitor = MasterNewsMonitor()
            self.master_monitor_enabled = True
            print("ğŸ›ï¸ ë§ˆìŠ¤í„° ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ ì—°ê²° ì™„ë£Œ")
        except Exception as e:
            print(f"âš ï¸ ë§ˆìŠ¤í„° ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ ì´ˆê¸°í™” ì‹¤íŒ¨: {e}")
            self.master_monitor_enabled = False
        
        # ìŠ¤ë§ˆíŠ¸ ìƒíƒœ íŒë‹¨ ì‹œìŠ¤í…œ ì´ˆê¸°í™” (ì›Œì¹˜í–„ìŠ¤í„°ì—ì„œ ì´ê´€)
        try:
            self.data_processor = NewsDataProcessor()
            self.smart_notifier = DoorayNotifier(DOORAY_WEBHOOK_URL, BOT_PROFILE_IMAGE_URL, self.api_client)
            self.smart_enabled = True
            print("ğŸ§  ìŠ¤ë§ˆíŠ¸ ìƒíƒœ íŒë‹¨ ì‹œìŠ¤í…œ ì´ˆê¸°í™” ì™„ë£Œ")
        except Exception as e:
            print(f"âš ï¸ ìŠ¤ë§ˆíŠ¸ ìƒíƒœ íŒë‹¨ ì‹œìŠ¤í…œ ì´ˆê¸°í™” ì‹¤íŒ¨: {e}")
            self.smart_enabled = False
        
        # ê°œë³„ ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ í™œì„±í™” (ì›Œì¹˜í–„ìŠ¤í„° ì„¤ì •ê³¼ ë™ì¼)
        self.individual_monitors_enabled = True
        
        # ìƒíƒœ íŒŒì¼ ê²½ë¡œ
# BROKEN_REF:         self.state_file = os.path.join(current_dir, "realtime_monitor_state.json")
        
        # ì›Œì¹˜í–„ìŠ¤í„°ì—ì„œ ì´ê´€ëœ ë‰´ìŠ¤ ê´€ë ¨ ê³ ì • ì‹œê°„ ì‘ì—…
        self.fixed_time_tasks = {
            "06:00": ("1", "ì•„ì¹¨ í˜„ì¬ ìƒíƒœ ì²´í¬"),
            "06:10": ("2", "ì•„ì¹¨ ì˜ì—…ì¼ ë¹„êµ ë¶„ì„"), 
            "18:00": ("5", "ì €ë… ì¼ì¼ ìš”ì•½ ë¦¬í¬íŠ¸"),
            "18:10": ("7", "ì €ë… ìƒì„¸ ì¼ì¼ ìš”ì•½"),
            "18:20": ("8", "ì €ë… ê³ ê¸‰ ë¶„ì„")
        }
        self.executed_fixed_tasks = set()  # ì˜¤ëŠ˜ ì‹¤í–‰ëœ ê³ ì • ì‘ì—…ë“¤
        
        # ì´ì „ ìƒíƒœ ë¡œë“œ
        self.load_state()
        
        print("ğŸ“¡ ì‹¤ì‹œê°„ ë‰´ìŠ¤ ëª¨ë‹ˆí„° ì´ˆê¸°í™” ì™„ë£Œ")
        print(f"ğŸ” ëª¨ë‹ˆí„°ë§ ëŒ€ìƒ: {len(self.monitors)}ê°œ ë‰´ìŠ¤ íƒ€ì…")
        print(f"ğŸ• ê³ ì • ì‹œê°„ ì‘ì—…: {len(self.fixed_time_tasks)}ê°œ")
    
    def load_state(self):
        """
        ì´ì „ ìƒíƒœ ë¡œë“œ
        """
        try:
            if os.path.exists(self.state_file):
with_open(self.state_file,_'r',_encoding = 'utf-8') as f:
                    state = json.load(f)
                
                for news_type, data in state.items():
                    if news_type in self.monitors:
                        self.monitors[news_type]['last_title'] = data.get('last_title')
                        self.monitors[news_type]['last_check'] = data.get('last_check')
                
                print("ğŸ“‹ ì´ì „ ìƒíƒœ ë¡œë“œ ì™„ë£Œ")
            else:
                print("ğŸ“‹ ìƒˆë¡œìš´ ìƒíƒœ íŒŒì¼ ìƒì„±")
                
        except Exception as e:
            print(f"âš ï¸ ìƒíƒœ ë¡œë“œ ì‹¤íŒ¨: {e}")
    
    def save_state(self):
        """
        í˜„ì¬ ìƒíƒœ ì €ì¥
        """
        try:
            state = {}
            for news_type, info in self.monitors.items():
                state[news_type] = {
                    'last_title': info['last_title'],
                    'last_check': info['last_check']
                }
            
with_open(self.state_file,_'w',_encoding = 'utf-8') as f:
json.dump(state,_f,_ensure_ascii = False, indent=2)
                
        except Exception as e:
            print(f"âš ï¸ ìƒíƒœ ì €ì¥ ì‹¤íŒ¨: {e}")
    
    def is_quiet_hours(self):
        """
        ì¡°ìš©í•œ ì‹œê°„ëŒ€ ì²´í¬ (19:01~05:59)
        
        Returns:
            bool: ì¡°ìš©í•œ ì‹œê°„ëŒ€ë©´ True
        """
        current_time = datetime.now()
        current_hour = current_time.hour
        current_minute = current_time.minute
        
        # 19:01~23:59 ë˜ëŠ” 00:00~05:59
return_(current_hour = = 19 and current_minute >= 1) or current_hour >= 20 or current_hour <= 5
    
    def check_fixed_time_tasks(self):
        """
        ê³ ì • ì‹œê°„ ì‘ì—…ë“¤ ì²´í¬ ë° ì‹¤í–‰ (ì›Œì¹˜í–„ìŠ¤í„°ì—ì„œ ì´ê´€)
        """
        current_time = datetime.now()
        current_time_str = current_time.strftime("%H:%M")
        current_date = current_time.strftime("%Y-%m-%d")
        
        # ë‚ ì§œê°€ ë°”ë€Œë©´ ì‹¤í–‰ëœ ì‘ì—… ëª©ë¡ ì´ˆê¸°í™”
        if not hasattr(self, '_last_check_date') or self._last_check_date != current_date:
            self.executed_fixed_tasks = set()
            self._last_check_date = current_date
        
        # ê³ ì • ì‹œê°„ ì‘ì—… ì²´í¬
        for time_str, (task_type, task_name) in self.fixed_time_tasks.items():
            if current_time_str == time_str:
                task_key = f"{current_date}_{time_str}"
                if task_key not in self.executed_fixed_tasks:
                    print(f"ğŸ• ê³ ì • ì‹œê°„ ì‘ì—… ì‹¤í–‰: {time_str} - {task_name}")
                    self.execute_news_task(task_type, task_name)
                    self.executed_fixed_tasks.add(task_key)
    
    def execute_news_task(self, task_type, task_name):
        """
        ë‰´ìŠ¤ ê´€ë ¨ ì‘ì—… ì‹¤í–‰ (ì›Œì¹˜í–„ìŠ¤í„°ì—ì„œ ì´ê´€)
        """
        try:
            print(f"ğŸ“… ë‰´ìŠ¤ ì‘ì—… ì‹¤í–‰: {task_name}")
            
            if task_type == "1":  # ìƒíƒœ ì²´í¬
                self.execute_status_check_task(task_name)
            elif task_type == "2":  # ë¹„êµ ë¶„ì„
                self.execute_comparison_task(task_name)
            elif task_type == "5":  # ì¼ì¼ ìš”ì•½
                self.execute_daily_summary_task(task_name)
            elif task_type == "7":  # ìƒì„¸ ìš”ì•½
                self.execute_detailed_summary_task(task_name)
            elif task_type == "8":  # ê³ ê¸‰ ë¶„ì„
                self.execute_advanced_analysis_task(task_name)
            else:
                print(f"âš ï¸ ì•Œ ìˆ˜ ì—†ëŠ” ì‘ì—… íƒ€ì…: {task_type}")
                
        except Exception as e:
            print(f"âŒ {task_name} ì˜¤ë¥˜: {e}")
    
    def execute_status_check_task(self, task_name):
        """
        ìƒíƒœ ì²´í¬ ì‘ì—… ì‹¤í–‰ (ì›Œì¹˜í–„ìŠ¤í„° ì›ë³¸ ë¡œì§)
        """
        try:
            # ê°œë³„ ëª¨ë‹ˆí„° ìƒíƒœ ì²´í¬ (ì›Œì¹˜í–„ìŠ¤í„° ì›ë³¸)
            self._check_individual_monitors_status()
            
            # ë§ˆìŠ¤í„° ëª¨ë‹ˆí„° ìƒíƒœ ì²´í¬ (ì›Œì¹˜í–„ìŠ¤í„° ì›ë³¸)
            if self.master_monitor_enabled and hasattr(self, 'master_monitor'):
                strategy = self.master_monitor.get_current_monitoring_strategy()
                print(f"ğŸ›ï¸ í˜„ì¬ ëª¨ë‹ˆí„°ë§ ì „ëµ: {strategy['description']}")
            
            # ë§¤ì‹œê°„ ì •ê° ìƒíƒœ ì²´í¬ëŠ” ì¡°ìš©í•œ ì‹œê°„ëŒ€ì—ë„ ëª…ì‹œì  ì•Œë¦¼ ì „ì†¡ (ì›Œì¹˜í–„ìŠ¤í„° ì›ë³¸)
            if "ì •ì‹œ ìƒíƒœ ì²´í¬" in task_name:
                self._send_hourly_status_notification(task_name)
            
            print(f"âœ… {task_name} ì™„ë£Œ (ìµœì í™” ë°©ì‹)")
            
        except Exception as e:
            print(f"âŒ ìƒíƒœ ì²´í¬ ì‘ì—… ì˜¤ë¥˜: {e}")
    
    def execute_comparison_task(self, task_name):
        """
        ë¹„êµ ë¶„ì„ ì‘ì—… ì‹¤í–‰ (ì›Œì¹˜í–„ìŠ¤í„° ì›ë³¸ ë¡œì§)
        """
        try:
            # ê° ë‰´ìŠ¤ë³„ í˜„ì¬ vs ì´ì „ ë°ì´í„° ë¹„êµ (ì›Œì¹˜í–„ìŠ¤í„° ì›ë³¸)
            comparison_results = []
            
            # ë‰´ìš•ë§ˆì¼“ì›Œì¹˜ ë¹„êµ (ì›Œì¹˜í–„ìŠ¤í„° ì›ë³¸)
            if hasattr(self, 'newyork_monitor'):
                ny_current = self.newyork_monitor.get_current_news_data()
                ny_analysis = self.newyork_monitor.analyze_publish_pattern(ny_current)
                comparison_results.append(f"ğŸŒ† ë‰´ìš•ë§ˆì¼“ì›Œì¹˜: {ny_analysis.get('analysis', 'ë¶„ì„ ë¶ˆê°€')}")
            
            # ì¦ì‹œë§ˆê° ë¹„êµ (ì›Œì¹˜í–„ìŠ¤í„° ì›ë³¸)
            if hasattr(self, 'kospi_monitor'):
                kospi_current = self.kospi_monitor.get_current_news_data()
                kospi_analysis = self.kospi_monitor.analyze_publish_pattern(kospi_current)
                comparison_results.append(f"ğŸ“ˆ ì¦ì‹œë§ˆê°: {kospi_analysis.get('analysis', 'ë¶„ì„ ë¶ˆê°€')}")
            
            # ì„œí™˜ë§ˆê° ë¹„êµ (ì›Œì¹˜í–„ìŠ¤í„° ì›ë³¸)
            if hasattr(self, 'exchange_monitor'):
                exchange_current = self.exchange_monitor.get_current_news_data()
                exchange_analysis = self.exchange_monitor.analyze_publish_pattern(exchange_current)
                comparison_results.append(f"ğŸ’± ì„œí™˜ë§ˆê°: {exchange_analysis.get('analysis', 'ë¶„ì„ ë¶ˆê°€')}")
            
            # ë¹„êµ ê²°ê³¼ ë¡œê·¸ (ì›Œì¹˜í–„ìŠ¤í„° ì›ë³¸)
            for result in comparison_results:
                print(f"ğŸ“Š {result}")
            
            print(f"âœ… {task_name} ì™„ë£Œ (ìµœì í™” ë°©ì‹)")
            
        except Exception as e:
            print(f"âŒ ë¹„êµ ë¶„ì„ ì‘ì—… ì˜¤ë¥˜: {e}")
    
    def execute_daily_summary_task(self, task_name):
        """
        ì¼ì¼ ìš”ì•½ ì‘ì—… ì‹¤í–‰ (ì›Œì¹˜í–„ìŠ¤í„° ì›ë³¸ ë¡œì§)
        """
        try:
            # ì˜¤ëŠ˜ ë°œí–‰ëœ ë‰´ìŠ¤ ìš”ì•½ (ì›Œì¹˜í–„ìŠ¤í„° ì›ë³¸)
            summary_data = []
            published_count = 0
            
            # ê° ë‰´ìŠ¤ë³„ ì˜¤ëŠ˜ ë°œí–‰ í˜„í™© (ì›Œì¹˜í–„ìŠ¤í„° ì›ë³¸)
            monitors = [
                ('ğŸŒ† ë‰´ìš•ë§ˆì¼“ì›Œì¹˜', self.newyork_monitor if hasattr(self, 'newyork_monitor') else None),
                ('ğŸ“ˆ ì¦ì‹œë§ˆê°', self.kospi_monitor if hasattr(self, 'kospi_monitor') else None),
                ('ğŸ’± ì„œí™˜ë§ˆê°', self.exchange_monitor if hasattr(self, 'exchange_monitor') else None)
            ]
            
            for name, monitor in monitors:
                if monitor:
                    try:
                        data = monitor.get_current_news_data()
                        analysis = monitor.analyze_publish_pattern(data)
                        is_published = analysis.get('is_published_today', False)
                        
                        if is_published:
published_count_+ =  1
                            summary_data.append(f"{name}: âœ… {analysis.get('analysis', 'ë°œí–‰ ì™„ë£Œ')}")
                        else:
                            summary_data.append(f"{name}: âŒ {analysis.get('analysis', 'ë¯¸ë°œí–‰')}")
                    except Exception as e:
                        summary_data.append(f"{name}: âš ï¸ ë¶„ì„ ì˜¤ë¥˜")
            
            # ì¼ì¼ ìš”ì•½ ë¡œê·¸ (ì›Œì¹˜í–„ìŠ¤í„° ì›ë³¸)
            print(f"ğŸ“‹ ì¼ì¼ ìš”ì•½ ({published_count}/3 ë°œí–‰ ì™„ë£Œ):")
            for summary in summary_data:
                print(f"   {summary}")
            
            print(f"âœ… {task_name} ì™„ë£Œ (ìµœì í™” ë°©ì‹)")
            
        except Exception as e:
            print(f"âŒ ì¼ì¼ ìš”ì•½ ì‘ì—… ì˜¤ë¥˜: {e}")
    
    def execute_detailed_summary_task(self, task_name):
        """
        ìƒì„¸ ìš”ì•½ ì‘ì—… ì‹¤í–‰ (ì›Œì¹˜í–„ìŠ¤í„° ì›ë³¸ ë¡œì§)
        """
        try:
            # í–¥ìƒëœ ìƒíƒœ ë³´ê³ ì„œ ìƒì„± ë° ì „ì†¡ (ì›Œì¹˜í–„ìŠ¤í„° ì›ë³¸)
            if hasattr(self, 'send_enhanced_status_notification'):
                self.send_enhanced_status_notification()
                print(f"ğŸ“Š í–¥ìƒëœ ìƒíƒœ ì•Œë¦¼ ì „ì†¡ ì™„ë£Œ")
            
            print(f"âœ… {task_name} ì™„ë£Œ (ìµœì í™” ë°©ì‹)")
            
        except Exception as e:
            print(f"âŒ ìƒì„¸ ìš”ì•½ ì‘ì—… ì˜¤ë¥˜: {e}")
    
    def execute_advanced_analysis_task(self, task_name):
        """
        ê³ ê¸‰ ë¶„ì„ ì‘ì—… ì‹¤í–‰ (ì›Œì¹˜í–„ìŠ¤í„° ì›ë³¸ ë¡œì§)
        """
        try:
            # ë§ˆìŠ¤í„° ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œì˜ í†µí•© ë¶„ì„ ì‚¬ìš© (ì›Œì¹˜í–„ìŠ¤í„° ì›ë³¸)
            if self.master_monitor_enabled and hasattr(self, 'master_monitor'):
                results = self.master_monitor.run_integrated_check()
                
                # ë¶„ì„ ê²°ê³¼ ë¡œê·¸ (ì›Œì¹˜í–„ìŠ¤í„° ì›ë³¸)
                for news_type, result in results.items():
                    analysis = result.get('analysis', {})
                    published = result.get('published_today', False)
                    status = "âœ… ë°œí–‰ ì™„ë£Œ" if published else "â³ ëŒ€ê¸° ì¤‘"
                    print(f"ğŸ”¬ {news_type}: {status} - {analysis.get('analysis', 'ë¶„ì„ ë¶ˆê°€')}")
            
            print(f"âœ… {task_name} ì™„ë£Œ (ìµœì í™” ë°©ì‹)")
            
        except Exception as e:
            print(f"âŒ ê³ ê¸‰ ë¶„ì„ ì‘ì—… ì˜¤ë¥˜: {e}")
    
    def _check_individual_monitors_status(self):
        """
        ê°œë³„ ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ ìƒíƒœ ì²´í¬ ë° ë³´ê³  (ì›Œì¹˜í–„ìŠ¤í„° ì›ë³¸)
        
        ìµœì í™”ëœ ê°œë³„ ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œë“¤ì˜ ìƒíƒœë¥¼ í™•ì¸í•˜ê³ 
        í•„ìš”ì‹œ ì¶”ê°€ ì •ë³´ë¥¼ ì œê³µí•©ë‹ˆë‹¤.
        """
        try:
            current_time = datetime.now()
            individual_status = {}
            
            # ë‰´ìš•ë§ˆì¼“ì›Œì¹˜ ìƒíƒœ ì²´í¬
            if hasattr(self, 'newyork_monitor'):
                try:
                    ny_data = self.newyork_monitor.get_current_news_data()
                    ny_analysis = self.newyork_monitor.analyze_publish_pattern(ny_data)
                    individual_status['newyork'] = {
                        'published': ny_analysis.get('is_published_today', False),
                        'status': ny_analysis.get('analysis', 'ìƒíƒœ ë¶ˆëª…')
                    }
                except Exception as e:
                    individual_status['newyork'] = {'error': str(e)}
            
            # ì¦ì‹œë§ˆê° ìƒíƒœ ì²´í¬
            if hasattr(self, 'kospi_monitor'):
                try:
                    kospi_data = self.kospi_monitor.get_current_news_data()
                    kospi_analysis = self.kospi_monitor.analyze_publish_pattern(kospi_data)
                    individual_status['kospi'] = {
                        'published': kospi_analysis.get('is_published_today', False),
                        'status': kospi_analysis.get('analysis', 'ìƒíƒœ ë¶ˆëª…')
                    }
                except Exception as e:
                    individual_status['kospi'] = {'error': str(e)}
            
            # ì„œí™˜ë§ˆê° ìƒíƒœ ì²´í¬
            if hasattr(self, 'exchange_monitor'):
                try:
                    exchange_data = self.exchange_monitor.get_current_news_data()
                    exchange_analysis = self.exchange_monitor.analyze_publish_pattern(exchange_data)
                    individual_status['exchange'] = {
                        'published': exchange_analysis.get('is_published_today', False),
                        'status': exchange_analysis.get('analysis', 'ìƒíƒœ ë¶ˆëª…')
                    }
                except Exception as e:
                    individual_status['exchange'] = {'error': str(e)}
            
            # ìƒíƒœ ìš”ì•½ ë¡œê·¸
            published_count = sum(1 for status in individual_status.values()
                                if status.get('published', False))
            total_count = len(individual_status)
            
            if total_count > 0:
                print(f"ğŸ“Š ê°œë³„ ëª¨ë‹ˆí„° ìƒíƒœ: {published_count}/{total_count} ë°œí–‰ ì™„ë£Œ")
                
                # ê° ë‰´ìŠ¤ë³„ ìƒíƒœ ë¡œê·¸
                news_names = {'newyork': 'ğŸŒ†ë‰´ìš•ë§ˆì¼“ì›Œì¹˜', 'kospi': 'ğŸ“ˆì¦ì‹œë§ˆê°', 'exchange': 'ğŸ’±ì„œí™˜ë§ˆê°'}
                for news_type, status in individual_status.items():
                    name = news_names.get(news_type, news_type)
                    if 'error' in status:
                        print(f"   {name}: âŒ ì˜¤ë¥˜ - {status['error']}")
                    elif status.get('published', False):
                        print(f"   {name}: âœ… {status.get('status', 'ë°œí–‰ ì™„ë£Œ')}")
                    else:
                        print(f"   {name}: â³ {status.get('status', 'ëŒ€ê¸° ì¤‘')}")
            
        except Exception as e:
            print(f"âš ï¸ ê°œë³„ ëª¨ë‹ˆí„° ìƒíƒœ ì²´í¬ ì‹¤íŒ¨: {e}")
    
    def _send_hourly_status_notification(self, task_name):
        """
        ë§¤ì‹œê°„ ì •ê° ìƒíƒœ ì²´í¬ ì•Œë¦¼ ì „ì†¡ (ì›Œì¹˜í–„ìŠ¤í„° ì›ë³¸)
        ì¡°ìš©í•œ ì‹œê°„ëŒ€ì—ë„ ëª…ì‹œì  ì•Œë¦¼
        
        Args:
            task_name (str): ì‘ì—…ëª…
        """
        try:
            current_time = datetime.now()
            current_hour = current_time.hour
            is_quiet = self.is_quiet_hours()
            
            # ìŠ¤ë§ˆíŠ¸ ìƒíƒœ íŒë‹¨ ì‹œìŠ¤í…œ ì‚¬ìš© (ì›Œì¹˜í–„ìŠ¤í„° ì›ë³¸)
            smart_status_info = None
            current_data = None
            
            if self.smart_enabled:
                try:
                    # í˜„ì¬ ë‰´ìŠ¤ ë°ì´í„° ì¡°íšŒ
                    current_data = self.api_client.get_news_data()
                    if current_data:
                        # ìŠ¤ë§ˆíŠ¸ ìƒíƒœ ë¶„ì„
                        smart_status_info = self.data_processor.get_status_info(current_data)
                        print(f"ğŸ§  ë§¤ì‹œê°„ ìŠ¤ë§ˆíŠ¸ ìƒíƒœ ë¶„ì„ ì™„ë£Œ: {smart_status_info.get('status_text', 'ì•Œ ìˆ˜ ì—†ìŒ')}")
                    else:
                        print("âš ï¸ ë§¤ì‹œê°„ ë‰´ìŠ¤ ë°ì´í„° ì¡°íšŒ ì‹¤íŒ¨")
                except Exception as e:
                    print(f"âš ï¸ ë§¤ì‹œê°„ ìŠ¤ë§ˆíŠ¸ ìƒíƒœ ë¶„ì„ ì‹¤íŒ¨: {e}")
            
            # ê°œë³„ ë‰´ìŠ¤ ìƒíƒœ ì •ë³´ ìˆ˜ì§‘
            news_status_info = self._get_detailed_news_status()
            
            # ì¡°ìš©í•œ ì‹œê°„ëŒ€ì—ë„ ëª…ì‹œì  ì•Œë¦¼ ì „ì†¡ (ì›Œì¹˜í–„ìŠ¤í„° ì›ë³¸)
            if smart_status_info and smart_status_info.get('has_updates', False):
                # ì—…ë°ì´íŠ¸ê°€ ìˆìœ¼ë©´ ìƒì„¸ ì•Œë¦¼
                self.smart_notifier.send_smart_notification(smart_status_info, current_data)
            else:
                # ì—…ë°ì´íŠ¸ê°€ ì—†ìœ¼ë©´ ê°„ë‹¨í•œ ìƒíƒœ ì•Œë¦¼
                self.send_notification(f"ë°ì´í„° ê°±ì‹  ì—†ìŒ/n/n{news_status_info}")
                
        except Exception as e:
            print(f"âŒ ë§¤ì‹œê°„ ìƒíƒœ ì²´í¬ ì•Œë¦¼ ì‹¤íŒ¨: {e}")
    
    def _get_detailed_news_status(self):
        """
        ìƒì„¸í•œ ë‰´ìŠ¤ ìƒíƒœ ì •ë³´ ìˆ˜ì§‘ (ì›Œì¹˜í–„ìŠ¤í„° ì›ë³¸)
        
        Returns:
            str: ë‰´ìŠ¤ ìƒíƒœ ì •ë³´ í…ìŠ¤íŠ¸
        """
        try:
            status_lines = []
            
            # ê° ë‰´ìŠ¤ë³„ ìƒì„¸ ìƒíƒœ
            monitors = [
                ('ğŸŒ† ë‰´ìš•ë§ˆì¼“ì›Œì¹˜', self.newyork_monitor if hasattr(self, 'newyork_monitor') else None),
                ('ğŸ“ˆ ì¦ì‹œë§ˆê°', self.kospi_monitor if hasattr(self, 'kospi_monitor') else None),
                ('ğŸ’± ì„œí™˜ë§ˆê°', self.exchange_monitor if hasattr(self, 'exchange_monitor') else None)
            ]
            
            for name, monitor in monitors:
                if monitor:
                    try:
                        data = monitor.get_current_news_data()
                        if data and data.get('title'):
                            title = data['title'][:30] + "..." if len(data['title']) > 30 else data['title']
                            publish_time = data.get('publish_time', 'ì‹œê°„ ì •ë³´ ì—†ìŒ')
                            status_lines.append(f"{name}: {title} ({publish_time})")
                        else:
                            status_lines.append(f"{name}: ë‰´ìŠ¤ ì—†ìŒ")
                    except Exception as e:
                        status_lines.append(f"{name}: í™•ì¸ ì‹¤íŒ¨")
                else:
                    status_lines.append(f"{name}: ëª¨ë‹ˆí„° ì—†ìŒ")
            
            return "/n".join(status_lines)
            
        except Exception as e:
            return f"ìƒíƒœ ì •ë³´ ìˆ˜ì§‘ ì‹¤íŒ¨: {e}"
    
    def send_enhanced_status_notification(self):
        """
        í–¥ìƒëœ ìƒíƒœ ë³´ê³ ì„œ ìƒì„± ë° ì „ì†¡ (ì›Œì¹˜í–„ìŠ¤í„° ì›ë³¸)
        """
        try:
            # ê¸°ë³¸ ìƒíƒœ ì •ë³´
            basic_status = {
                'timestamp': datetime.now().isoformat(),
                'individual_monitors': {}
            }
            
            # ê°œë³„ ëª¨ë‹ˆí„° ìƒíƒœ ì¶”ê°€
            if self.individual_monitors_enabled:
                if hasattr(self, 'newyork_monitor'):
                    ny_data = self.newyork_monitor.get_current_news_data()
                    ny_analysis = self.newyork_monitor.analyze_publish_pattern(ny_data)
                    basic_status['individual_monitors']['newyork'] = {
                        'name': 'ë‰´ìš•ë§ˆì¼“ì›Œì¹˜',
                        'published_today': ny_analysis.get('is_published_today', False),
                        'status': ny_analysis.get('status', 'unknown'),
                        'analysis': ny_analysis.get('analysis', 'ë¶„ì„ ë¶ˆê°€')
                    }
                
                if hasattr(self, 'kospi_monitor'):
                    kospi_data = self.kospi_monitor.get_current_news_data()
                    kospi_analysis = self.kospi_monitor.analyze_publish_pattern(kospi_data)
                    basic_status['individual_monitors']['kospi'] = {
                        'name': 'ì¦ì‹œë§ˆê°',
                        'published_today': kospi_analysis.get('is_published_today', False),
                        'status': kospi_analysis.get('status', 'unknown'),
                        'analysis': kospi_analysis.get('analysis', 'ë¶„ì„ ë¶ˆê°€')
                    }
                
                if hasattr(self, 'exchange_monitor'):
                    exchange_data = self.exchange_monitor.get_current_news_data()
                    exchange_analysis = self.exchange_monitor.analyze_publish_pattern(exchange_data)
                    basic_status['individual_monitors']['exchange'] = {
                        'name': 'ì„œí™˜ë§ˆê°',
                        'published_today': exchange_analysis.get('is_published_today', False),
                        'status': exchange_analysis.get('status', 'unknown'),
                        'analysis': exchange_analysis.get('analysis', 'ë¶„ì„ ë¶ˆê°€')
                    }
            
            # í–¥ìƒëœ ìƒíƒœ ì•Œë¦¼ ì „ì†¡
            if self.smart_enabled and hasattr(self, 'smart_notifier'):
                self.smart_notifier.send_enhanced_status_notification(basic_status)
            
        except Exception as e:
            print(f"âŒ í–¥ìƒëœ ìƒíƒœ ì•Œë¦¼ ì‹¤íŒ¨: {e}")
    
    def send_notification(self, message, is_error=False):
        """
        ê¸°ë³¸ ì•Œë¦¼ ì „ì†¡ (ì›Œì¹˜í–„ìŠ¤í„° í˜¸í™˜)
        
        Args:
            message (str): ì „ì†¡í•  ë©”ì‹œì§€
            is_error (bool): ì˜¤ë¥˜ ì•Œë¦¼ ì—¬ë¶€
        """
        try:
            color = "#ff4444" if is_error else "#28a745"
            bot_name = "POSCO ë‰´ìŠ¤ ëª¨ë‹ˆí„° âŒ" if is_error else "POSCO ë‰´ìŠ¤ ëª¨ë‹ˆí„° ğŸ“°"
            
            payload = {
                "botName": bot_name,
                "botIconImage": BOT_PROFILE_IMAGE_URL,
                "text": message.split('/n')[0],
                "attachments": [{
                    "color": color,
                    "text": message
                }]
            }
            
            response = requests.post(
                DOORAY_WEBHOOK_URL,
                json=payload,
                headers={'Content-Type': 'application/json'},
                timeout=10
            )
            
            if response.status_code == 200:
                print(f"âœ… ì•Œë¦¼ ì „ì†¡ ì„±ê³µ: {message.split(chr(10))[0]}")
            else:
                print(f"âŒ ì•Œë¦¼ ì „ì†¡ ì‹¤íŒ¨: {response.status_code}")
                
        except Exception as e:
            print(f"âŒ ì•Œë¦¼ ì „ì†¡ ì˜¤ë¥˜: {e}")
    
    def check_news_updates(self):
        """
        ëª¨ë“  ë‰´ìŠ¤ íƒ€ì…ì˜ ì—…ë°ì´íŠ¸ ì²´í¬
        """
        current_time = datetime.now()
        new_news_found = False
        
        for news_type, info in self.monitors.items():
            try:
                # í˜„ì¬ ë‰´ìŠ¤ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
                data = info['monitor'].get_current_news_data()
                
                if data and data.get('title'):
                    current_title = data['title']
                    
                    # ìƒˆë¡œìš´ ë‰´ìŠ¤ì¸ì§€ í™•ì¸
                    if info['last_title'] != current_title:
                        print(f"ğŸ†• ìƒˆ ë‰´ìŠ¤ ë°œê²¬: {info['name']} - {current_title[:50]}...")
                        
                        # ì•Œë¦¼ ë°œì†¡
                        self.send_news_notification(news_type, info['name'], data)
                        
                        # ìƒíƒœ ì—…ë°ì´íŠ¸
                        info['last_title'] = current_title
                        info['last_check'] = current_time.isoformat()
                        
                        new_news_found = True
                    else:
                        # ë™ì¼í•œ ë‰´ìŠ¤ - ì²´í¬ ì‹œê°„ë§Œ ì—…ë°ì´íŠ¸
                        info['last_check'] = current_time.isoformat()
                else:
                    print(f"âš ï¸ {info['name']} ë°ì´í„° ì—†ìŒ")
                    info['last_check'] = current_time.isoformat()
                    
            except Exception as e:
                print(f"âŒ {info['name']} ì²´í¬ ì‹¤íŒ¨: {e}")
                info['last_check'] = current_time.isoformat()
        
        # ìƒˆ ë‰´ìŠ¤ê°€ ìˆìœ¼ë©´ ìƒíƒœ ì €ì¥
        if new_news_found:
            self.save_state()
        
        return new_news_found
    
    def send_news_notification(self, news_type, news_name, data):
        """
        ë‰´ìŠ¤ ì•Œë¦¼ ë°œì†¡
        
        Args:
            news_type (str): ë‰´ìŠ¤ íƒ€ì…
            news_name (str): ë‰´ìŠ¤ ì´ë¦„
            data (dict): ë‰´ìŠ¤ ë°ì´í„°
        """
        try:
            # ì¡°ìš©í•œ ì‹œê°„ëŒ€ ì²´í¬
            if self.is_quiet_hours():
                print(f"ğŸŒ™ ì¡°ìš©í•œ ì‹œê°„ëŒ€ - {news_name} ì•Œë¦¼ ë°œì†¡ ìƒëµ")
                return
            
            title = data.get('title', 'ì œëª© ì—†ìŒ')
            publish_time = data.get('publish_time', 'ì‹œê°„ ì •ë³´ ì—†ìŒ')
            
            # ë©”ì‹œì§€ êµ¬ì„±
            message = f"ğŸ“° {news_name} ìƒˆ ë‰´ìŠ¤ ë°œí–‰!/n/n"
            message += f"ğŸ“‹ ì œëª©: {title}/n"
            message += f"ğŸ• ë°œí–‰ì‹œê°„: {publish_time}/n"
            message += f"ğŸ“… ê°ì§€ì‹œê°„: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}"
            
            # Dooray í˜ì´ë¡œë“œ
            payload = {
                "botName": "POSCO ë‰´ìŠ¤ ì•Œë¦¬ë¯¸ ğŸ“°",
                "botIconImage": BOT_PROFILE_IMAGE_URL,
                "text": f"ğŸ“° {news_name} ìƒˆ ë‰´ìŠ¤ ë°œí–‰!",
                "attachments": [{
                    "color": "#007bff",
                    "text": message
                }]
            }
            
            # ì•Œë¦¼ ì „ì†¡
            response = requests.post(
                DOORAY_WEBHOOK_URL,
                json=payload,
                headers={'Content-Type': 'application/json'},
                timeout=10
            )
            
            if response.status_code == 200:
                print(f"âœ… {news_name} ì•Œë¦¼ ì „ì†¡ ì„±ê³µ")
            else:
                print(f"âŒ {news_name} ì•Œë¦¼ ì „ì†¡ ì‹¤íŒ¨: {response.status_code}")
                
        except Exception as e:
            print(f"âŒ {news_name} ì•Œë¦¼ ì „ì†¡ ì˜¤ë¥˜: {e}")
    
    def send_status_notification(self, task_name, status_results):
        """ìƒíƒœ ì²´í¬ ê²°ê³¼ ì•Œë¦¼"""
        try:
            message = f"ğŸ” {task_name}/n/n"
            message += "/n".join(status_results)
            message += f"/n/nğŸ“… ì²´í¬ ì‹œê°„: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}"
            
            payload = {
                "botName": "POSCO ë‰´ìŠ¤ ìƒíƒœ ì²´í¬ ğŸ”",
                "botIconImage": BOT_PROFILE_IMAGE_URL,
                "text": f"ğŸ” {task_name}",
                "attachments": [{
                    "color": "#17a2b8",
                    "text": message
                }]
            }
            
            response = requests.post(DOORAY_WEBHOOK_URL, json=payload, timeout=10)
            if response.status_code == 200:
                print(f"âœ… {task_name} ì•Œë¦¼ ì „ì†¡ ì„±ê³µ")
            
        except Exception as e:
            print(f"âŒ {task_name} ì•Œë¦¼ ì „ì†¡ ì˜¤ë¥˜: {e}")
    
    def send_comparison_notification(self, task_name, comparison_results):
        """ë¹„êµ ë¶„ì„ ê²°ê³¼ ì•Œë¦¼"""
        try:
            message = f"ğŸ“Š {task_name}/n/n"
            message += "/n".join(comparison_results)
            message += f"/n/nğŸ“… ë¶„ì„ ì‹œê°„: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}"
            
            payload = {
                "botName": "POSCO ë‰´ìŠ¤ ë¹„êµ ë¶„ì„ ğŸ“Š",
                "botIconImage": BOT_PROFILE_IMAGE_URL,
                "text": f"ğŸ“Š {task_name}",
                "attachments": [{
                    "color": "#28a745",
                    "text": message
                }]
            }
            
            response = requests.post(DOORAY_WEBHOOK_URL, json=payload, timeout=10)
            if response.status_code == 200:
                print(f"âœ… {task_name} ì•Œë¦¼ ì „ì†¡ ì„±ê³µ")
            
        except Exception as e:
            print(f"âŒ {task_name} ì•Œë¦¼ ì „ì†¡ ì˜¤ë¥˜: {e}")
    
    def send_daily_summary_notification(self, task_name, summary_data, published_count):
        """ì¼ì¼ ìš”ì•½ ê²°ê³¼ ì•Œë¦¼"""
        try:
            total_count = len(self.monitors)
            
            if published_count == total_count:
                color = "#28a745"
                status_emoji = "âœ…"
            elif published_count >= 2:
                color = "#ffc107"
                status_emoji = "âš ï¸"
            else:
                color = "#dc3545"
                status_emoji = "âŒ"
            
            message = f"{status_emoji} {task_name}/n/n"
            message += f"ğŸ“Š ë°œí–‰ í˜„í™©: {published_count}/{total_count}/n/n"
            message += "/n".join(summary_data)
            message += f"/n/nğŸ“… ìš”ì•½ ì‹œê°„: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}"
            
            payload = {
                "botName": "POSCO ë‰´ìŠ¤ ì¼ì¼ ìš”ì•½ ğŸ“‹",
                "botIconImage": BOT_PROFILE_IMAGE_URL,
                "text": f"{status_emoji} {task_name}",
                "attachments": [{
                    "color": color,
                    "text": message
                }]
            }
            
            response = requests.post(DOORAY_WEBHOOK_URL, json=payload, timeout=10)
            if response.status_code == 200:
                print(f"âœ… {task_name} ì•Œë¦¼ ì „ì†¡ ì„±ê³µ")
            
        except Exception as e:
            print(f"âŒ {task_name} ì•Œë¦¼ ì „ì†¡ ì˜¤ë¥˜: {e}")
    
    def send_detailed_summary_notification(self, task_name, detailed_info):
        """ìƒì„¸ ìš”ì•½ ê²°ê³¼ ì•Œë¦¼"""
        try:
            message = f"ğŸ“Š {task_name}/n/n"
            message += "/n/n".join(detailed_info)
            message += f"/n/nğŸ“… ìƒì„¸ ë¶„ì„ ì‹œê°„: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}"
            
            payload = {
                "botName": "POSCO ë‰´ìŠ¤ ìƒì„¸ ìš”ì•½ ğŸ“Š",
                "botIconImage": BOT_PROFILE_IMAGE_URL,
                "text": f"ğŸ“Š {task_name}",
                "attachments": [{
                    "color": "#6f42c1",
                    "text": message
                }]
            }
            
            response = requests.post(DOORAY_WEBHOOK_URL, json=payload, timeout=10)
            if response.status_code == 200:
                print(f"âœ… {task_name} ì•Œë¦¼ ì „ì†¡ ì„±ê³µ")
            
        except Exception as e:
            print(f"âŒ {task_name} ì•Œë¦¼ ì „ì†¡ ì˜¤ë¥˜: {e}")
    
    def send_advanced_analysis_notification(self, task_name, analysis_results, total_news):
        """ê³ ê¸‰ ë¶„ì„ ê²°ê³¼ ì•Œë¦¼"""
        try:
            message = f"ğŸ”¬ {task_name}/n/n"
            message += f"ğŸ“Š ë¶„ì„ ëŒ€ìƒ: {total_news}ê°œ ë‰´ìŠ¤/n/n"
            message += "/n/n".join(analysis_results)
            message += f"/n/nğŸ“… ê³ ê¸‰ ë¶„ì„ ì‹œê°„: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}"
            
            payload = {
                "botName": "POSCO ë‰´ìŠ¤ ê³ ê¸‰ ë¶„ì„ ğŸ”¬",
                "botIconImage": BOT_PROFILE_IMAGE_URL,
                "text": f"ğŸ”¬ {task_name}",
                "attachments": [{
                    "color": "#e83e8c",
                    "text": message
                }]
            }
            
            response = requests.post(DOORAY_WEBHOOK_URL, json=payload, timeout=10)
            if response.status_code == 200:
                print(f"âœ… {task_name} ì•Œë¦¼ ì „ì†¡ ì„±ê³µ")
            
        except Exception as e:
            print(f"âŒ {task_name} ì•Œë¦¼ ì „ì†¡ ì˜¤ë¥˜: {e}")
    
    def run_monitor(self):
        """
        ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§ ì‹¤í–‰
        """
        print(f"/nğŸš€ ì‹¤ì‹œê°„ ë‰´ìŠ¤ ëª¨ë‹ˆí„°ë§ ì‹œì‘ - {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}")
        print("ğŸ” 5ë¶„ë§ˆë‹¤ ë‰´ìŠ¤ ì—…ë°ì´íŠ¸ ì²´í¬")
        print("â¹ï¸ Ctrl+Cë¡œ ì¤‘ë‹¨")
        
        check_interval = 5 * 60  # 5ë¶„
        
        while True:
            try:
                current_time = datetime.now()
                print(f"/nâ° {current_time.strftime('%H:%M:%S')} - ë‰´ìŠ¤ ì—…ë°ì´íŠ¸ ì²´í¬ ì¤‘...")
                
                # 1. ê³ ì • ì‹œê°„ ì‘ì—… ì²´í¬ (ì›Œì¹˜í–„ìŠ¤í„°ì—ì„œ ì´ê´€)
                self.check_fixed_time_tasks()
                
                # 2. ë‰´ìŠ¤ ì—…ë°ì´íŠ¸ ì²´í¬
                new_news = self.check_news_updates()
                
                if new_news:
                    print("ğŸ‰ ìƒˆ ë‰´ìŠ¤ ë°œê²¬ ë° ì•Œë¦¼ ì™„ë£Œ!")
                else:
                    print("ğŸ“‹ ìƒˆ ë‰´ìŠ¤ ì—†ìŒ")
                
                # ë‹¤ìŒ ì²´í¬ê¹Œì§€ ëŒ€ê¸°
                print(f"â³ {check_interval/60}ë¶„ í›„ ë‹¤ì‹œ ì²´í¬...")
                time.sleep(check_interval)
                
            except KeyboardInterrupt:
                print("/nâ¹ï¸ ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§ ì¤‘ë‹¨ë¨")
                break
            except Exception as e:
                print(f"âŒ ëª¨ë‹ˆí„°ë§ ì˜¤ë¥˜: {e}")
                print("ğŸ”„ 1ë¶„ í›„ ì¬ì‹œë„...")
                time.sleep(60)
    
    def test_notifications(self):
        """
        í…ŒìŠ¤íŠ¸ìš© ì•Œë¦¼ ë°œì†¡
        """
        print("/nğŸ§ª í…ŒìŠ¤íŠ¸ ëª¨ë“œ: í˜„ì¬ ë‰´ìŠ¤ ìƒíƒœ í™•ì¸ ë° ì•Œë¦¼ í…ŒìŠ¤íŠ¸")
        
        for news_type, info in self.monitors.items():
            try:
                data = info['monitor'].get_current_news_data()
                
                if data and data.get('title'):
                    print(f"âœ… {info['name']}: {data['title'][:50]}...")
                    
                    # í…ŒìŠ¤íŠ¸ ì•Œë¦¼ ë°œì†¡
                    self.send_news_notification(news_type, info['name'], data)
                else:
                    print(f"âš ï¸ {info['name']}: ë°ì´í„° ì—†ìŒ")
                    
            except Exception as e:
                print(f"âŒ {info['name']} í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨: {e}")

def main():
    """
    ë©”ì¸ ì‹¤í–‰ í•¨ìˆ˜
    """
    monitor = RealtimeNewsMonitor()
    
    # ëª…ë ¹í–‰ ì¸ìˆ˜ í™•ì¸
    if len(sys.argv) > 1 and sys.argv[1] == "test":
        # í…ŒìŠ¤íŠ¸ ëª¨ë“œ
        monitor.test_notifications()
    else:
        # ì •ìƒ ëª¨ë‹ˆí„°ë§ ëª¨ë“œ
        monitor.run_monitor()

if __name__ == "__main__":
    main()