#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Final System Integration Verification
POSCO ì‹œìŠ¤í…œ êµ¬ì„±ìš”ì†Œ

WatchHamster v3.0 ë° POSCO News 250808 í˜¸í™˜
Created: 2025-08-08
"""

import posco_news_250808_monitor.log
import system_functionality_verification.py
# BROKEN_REF: import subprocess
import .comprehensive_repair_backup/realtime_news_monitor.py.backup_20250809_181657
import test_config.json
# BROKEN_REF: from datetime import datetime
# BROKEN_REF: from typing import Dict, List, Tuple, Optional

class FinalSystemIntegrationVerification:
    """ìµœì¢… ì‹œìŠ¤í…œ í†µí•© ë° ê²€ì¦"""
    
    def __init__(self):
        self.script_dir = os.path.dirname(os.path.abspath(__file__))
        self.verification_results = {}
        self.start_time = None
        self.end_time = None
        
        # ê²€ì¦ ë‹¨ê³„ ì •ì˜
        self.verification_stages = [
            {
                'name': 'comprehensive_test_suite',
                'title': 'ì™„ì „í•œ í…ŒìŠ¤íŠ¸ ìŠ¤ìœ„íŠ¸ ì‹¤í–‰',
                'description': 'ëª¨ë“  í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ ë° í†µí•© ë¬¸ì œ ìˆ˜ì •',
                'critical': True
            },
            {
                'name': 'control_center_verification',
                'title': 'ì œì–´ì„¼í„° ë©”ë‰´ ê¸°ëŠ¥ ê²€ì¦',
                'description': 'ëª¨ë“  ì œì–´ì„¼í„° ë©”ë‰´ê°€ ì˜¬ë°”ë¥´ê²Œ ì‘ë™í•˜ëŠ”ì§€ ê²€ì¦',
                'critical': True
            },
            {
                'name': 'performance_benchmarking',
                'title': 'ìµœì¢… ì„±ëŠ¥ ë²¤ì¹˜ë§ˆí‚¹',
                'description': 'ì„±ëŠ¥ ë²¤ì¹˜ë§ˆí‚¹ ë° ìµœì í™” ìˆ˜í–‰',
                'critical': False
            },
            {
                'name': 'deployment_checklist',
                'title': 'ë°°í¬ ê²€ì¦ ì²´í¬ë¦¬ìŠ¤íŠ¸',
                'description': 'ë°°í¬ ì¤€ë¹„ ìƒíƒœ í™•ì¸ ë° ë¬¸ì„œí™”',
                'critical': True
            }
        ]
    
    def print_header(self, title: str, char: str = "=", width: int = 80):
        """í—¤ë” ì¶œë ¥"""
        print(char * width)
        print(f"{title:^{width}}")
        print(char * width)
    
    def print_section(self, title: str, char: str = "-", width: int = 60):
        """ì„¹ì…˜ í—¤ë” ì¶œë ¥"""
        print(f"/n{char * width}")
        print(f"{title}")
        print(f"{char * width}") 
   
    def run_comprehensive_test_suite(self) -> Dict:
        """ì™„ì „í•œ í…ŒìŠ¤íŠ¸ ìŠ¤ìœ„íŠ¸ ì‹¤í–‰"""
        print("ğŸ§ª ì™„ì „í•œ í…ŒìŠ¤íŠ¸ ìŠ¤ìœ„íŠ¸ ì‹¤í–‰ ì¤‘...")
        
        result = {
            'stage': 'comprehensive_test_suite',
            'success': False,
            'details': {},
            'issues': [],
            'recommendations': []
        }
        
        try:
            # 1. ì¢…í•© í…ŒìŠ¤íŠ¸ ì‹¤í–‰
            print("  ğŸ“‹ ì¢…í•© í…ŒìŠ¤íŠ¸ í”„ë ˆì„ì›Œí¬ ì‹¤í–‰...")
            
            if os.path.exists('run_comprehensive_tests.py'):
                test_result = subprocess.run([
                    sys.executable, 'run_comprehensive_tests.py'
],_capture_output = True, text=True, timeout=600)
                
                result['details']['comprehensive_tests'] = {
                    'return_code': test_result.returncode,
                    'stdout': test_result.stdout,
                    'stderr': test_result.stderr
                }
                
                if test_result.returncode == 0:
                    print("    âœ… ì¢…í•© í…ŒìŠ¤íŠ¸ ì„±ê³µ")
                    result['details']['comprehensive_tests']['status'] = 'passed'
                else:
                    print("    âŒ ì¢…í•© í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨")
                    result['details']['comprehensive_tests']['status'] = 'failed'
                    result['issues'].append("ì¢…í•© í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨")
            else:
                print("    âš ï¸ ì¢…í•© í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸ ì—†ìŒ")
                result['issues'].append("ì¢…í•© í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸ ëˆ„ë½")
            
            # 2. ê°œë³„ í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
            individual_tests = [
# BROKEN_REF:                 'test_v2_integration.py',
                'test_process_lifecycle.py', 
                'test_control_center_integration.py',
                'test_end_to_end_integration.py'
            ]
            
            result['details']['individual_tests'] = {}
            passed_tests = 0
            
            for test_script in individual_tests:
                print(f"  ğŸ§ª {test_script} ì‹¤í–‰ ì¤‘...")
                
                if os.path.exists(test_script):
                    try:
                        test_result = subprocess.run([
                            sys.executable, test_script
],_capture_output = True, text=True, timeout=120)
                        
                        test_status = 'passed' if test_result.returncode == 0 else 'failed'
                        result['details']['individual_tests'][test_script] = {
                            'status': test_status,
                            'return_code': test_result.returncode,
                            'stdout': test_result.stdout[:500],  # ì²˜ìŒ 500ìë§Œ
                            'stderr': test_result.stderr[:500]
                        }
                        
                        if test_status == 'passed':
                            print(f"    âœ… {test_script} ì„±ê³µ")
passed_tests_+ =  1
                        else:
                            print(f"    âŒ {test_script} ì‹¤íŒ¨")
                            result['issues'].append(f"{test_script} í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨")
                            
                    except subprocess.TimeoutExpired:
                        print(f"    â° {test_script} íƒ€ì„ì•„ì›ƒ")
                        result['details']['individual_tests'][test_script] = {
                            'status': 'timeout',
                            'error': 'Test execution timeout'
                        }
                        result['issues'].append(f"{test_script} íƒ€ì„ì•„ì›ƒ")
                        
                else:
                    print(f"    âš ï¸ {test_script} íŒŒì¼ ì—†ìŒ")
                    result['details']['individual_tests'][test_script] = {
                        'status': 'missing',
                        'error': 'Test script not found'
                    }
                    result['issues'].append(f"{test_script} íŒŒì¼ ëˆ„ë½")
            
            # 3. í…ŒìŠ¤íŠ¸ ê²°ê³¼ ë¶„ì„
            total_tests = len(individual_tests)
            success_rate = (passed_tests / total_tests) * 100 if total_tests > 0 else 0
            
            result['details']['test_summary'] = {
                'total_tests': total_tests,
                'passed_tests': passed_tests,
                'failed_tests': total_tests - passed_tests,
                'success_rate': success_rate
            }
            
            print(f"  ğŸ“Š í…ŒìŠ¤íŠ¸ ê²°ê³¼: {passed_tests}/{total_tests} ì„±ê³µ ({success_rate:.1f}%)")
            
            # ì„±ê³µ ê¸°ì¤€: 80% ì´ìƒ ì„±ê³µ
            if success_rate >= 80:
                result['success'] = True
                print("  ğŸ‰ í…ŒìŠ¤íŠ¸ ìŠ¤ìœ„íŠ¸ ê²€ì¦ ì„±ê³µ!")
            else:
                result['success'] = False
                result['recommendations'].append("ì‹¤íŒ¨í•œ í…ŒìŠ¤íŠ¸ë“¤ì„ ìˆ˜ì •í•˜ê³  ë‹¤ì‹œ ì‹¤í–‰í•˜ì„¸ìš”")
                print("  âš ï¸ í…ŒìŠ¤íŠ¸ ìŠ¤ìœ„íŠ¸ ê²€ì¦ ì‹¤íŒ¨")
            
        except Exception as e:
            result['success'] = False
            result['issues'].append(f"í…ŒìŠ¤íŠ¸ ìŠ¤ìœ„íŠ¸ ì‹¤í–‰ ì˜¤ë¥˜: {str(e)}")
            print(f"  âŒ í…ŒìŠ¤íŠ¸ ìŠ¤ìœ„íŠ¸ ì‹¤í–‰ ì˜¤ë¥˜: {e}")
        
        return result  
  
    def verify_control_center_functions(self) -> Dict:
        """ì œì–´ì„¼í„° ë©”ë‰´ ê¸°ëŠ¥ ê²€ì¦"""
        print("ğŸ›ï¸ ì œì–´ì„¼í„° ë©”ë‰´ ê¸°ëŠ¥ ê²€ì¦ ì¤‘...")
        
        result = {
            'stage': 'control_center_verification',
            'success': False,
            'details': {},
            'issues': [],
            'recommendations': []
        }
        
        try:
            # 1. ì œì–´ì„¼í„° ìŠ¤í¬ë¦½íŠ¸ ì¡´ì¬ í™•ì¸
            control_center_script = '.naming_backup/scripts/.naming_backup/scripts/watchhamster_control_center.sh'
            
            if not os.path.exists(control_center_script):
                result['issues'].append("ì œì–´ì„¼í„° ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼ ëˆ„ë½")
                return result
            
            # 2. ìŠ¤í¬ë¦½íŠ¸ ë¬¸ë²• ê²€ì‚¬
            print("  ğŸ“‹ ì œì–´ì„¼í„° ìŠ¤í¬ë¦½íŠ¸ ë¬¸ë²• ê²€ì‚¬...")
            syntax_check = subprocess.run([
                'bash', '-n', control_center_script
],_capture_output = True, text=True)
            
            result['details']['syntax_check'] = {
                'return_code': syntax_check.returncode,
                'stderr': syntax_check.stderr
            }
            
            if syntax_check.returncode == 0:
                print("    âœ… ìŠ¤í¬ë¦½íŠ¸ ë¬¸ë²• ê²€ì‚¬ í†µê³¼")
            else:
                print("    âŒ ìŠ¤í¬ë¦½íŠ¸ ë¬¸ë²• ì˜¤ë¥˜")
                result['issues'].append("ì œì–´ì„¼í„° ìŠ¤í¬ë¦½íŠ¸ ë¬¸ë²• ì˜¤ë¥˜")
                return result
            
            # 3. í•„ìˆ˜ í•¨ìˆ˜ ì •ì˜ í™•ì¸
            required_functions = [
                'start_watchhamster',
                'stop_watchhamster', 
                'check_watchhamster_status',
                'manage_modules',
                'check_managed_processes'
            ]
            
            print("  ğŸ” í•„ìˆ˜ í•¨ìˆ˜ ì •ì˜ í™•ì¸...")
            result['details']['function_definitions'] = {}
            
with_open(control_center_script,_'r',_encoding = 'utf-8') as f:
                script_content = f.read()
            
            missing_functions = []
            for func in required_functions:
                if f"{func}()" in script_content:
                    print(f"    âœ… {func} í•¨ìˆ˜ ì •ì˜ë¨")
                    result['details']['function_definitions'][func] = True
                else:
                    print(f"    âŒ {func} í•¨ìˆ˜ ëˆ„ë½")
                    result['details']['function_definitions'][func] = False
                    missing_functions.append(func)
            
            if missing_functions:
                result['issues'].append(f"ëˆ„ë½ëœ í•¨ìˆ˜: {', '.join(missing_functions)}")
            
            # 4. ì œì–´ì„¼í„° ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
            print("  ğŸ§ª ì œì–´ì„¼í„° ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸ ì‹¤í–‰...")
            
            if os.path.exists('test_control_center_functions.sh'):
                test_result = subprocess.run([
                    'bash', 'test_control_center_functions.sh'
],_capture_output = True, text=True, timeout=60)
                
                result['details']['function_tests'] = {
                    'return_code': test_result.returncode,
                    'stdout': test_result.stdout,
                    'stderr': test_result.stderr
                }
                
                if test_result.returncode == 0:
                    print("    âœ… ì œì–´ì„¼í„° ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸ ì„±ê³µ")
                else:
                    print("    âŒ ì œì–´ì„¼í„° ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨")
                    result['issues'].append("ì œì–´ì„¼í„° ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨")
            else:
                print("    âš ï¸ ì œì–´ì„¼í„° í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸ ì—†ìŒ")
                result['issues'].append("ì œì–´ì„¼í„° í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸ ëˆ„ë½")
            
            # 5. í˜„ì¬ ì‹œìŠ¤í…œ ìƒíƒœ í™•ì¸
            print("  ğŸ“Š í˜„ì¬ ì‹œìŠ¤í…œ ìƒíƒœ í™•ì¸...")
            
            # ì›Œì¹˜í–„ìŠ¤í„° í”„ë¡œì„¸ìŠ¤ í™•ì¸
            watchhamster_running = subprocess.run([
                'pgrep', '-f', '.naming_backup/config_data_backup/watchhamster.log'
],_capture_output = True).returncode == 0
            
            result['details']['system_status'] = {
                'watchhamster_running': watchhamster_running
            }
            
            # ê´€ë¦¬ ëŒ€ìƒ í”„ë¡œì„¸ìŠ¤ í™•ì¸
            managed_processes = [
                'Monitoring/POSCO_News_250808/Monitoring/POSCO_News_250808/posco_main_notifier.py',
                'Monitoring/POSCO_News_250808/Monitoring/POSCO_News_250808/realtime_news_monitor.py', 
                'Monitoring/POSCO_News_250808/Monitoring/POSCO_News_250808/integrated_report_scheduler.py'
            ]
            
            running_processes = 0
            for process in managed_processes:
                is_running = subprocess.run([
                    'pgrep', '-f', process
],_capture_output = True).returncode == 0
                
                result['details']['system_status'][f"{process}_running"] = is_running
                if is_running:
running_processes_+ =  1
            
            result['details']['system_status']['managed_processes_count'] = running_processes
            result['details']['system_status']['total_managed_processes'] = len(managed_processes)
            
            print(f"    ğŸ“ˆ ê´€ë¦¬ í”„ë¡œì„¸ìŠ¤: {running_processes}/{len(managed_processes)} ì‹¤í–‰ ì¤‘")
            
            # 6. ê²€ì¦ ê²°ê³¼ íŒì •
            critical_issues = len([issue for issue in result['issues'] if 'syntax' in issue.lower() or 'function' in issue.lower()])
            
            if critical_issues == 0 and len(missing_functions) == 0:
                result['success'] = True
                print("  ğŸ‰ ì œì–´ì„¼í„° ê¸°ëŠ¥ ê²€ì¦ ì„±ê³µ!")
            else:
                result['success'] = False
                result['recommendations'].append("ëˆ„ë½ëœ í•¨ìˆ˜ë“¤ì„ êµ¬í˜„í•˜ê³  ë¬¸ë²• ì˜¤ë¥˜ë¥¼ ìˆ˜ì •í•˜ì„¸ìš”")
                print("  âš ï¸ ì œì–´ì„¼í„° ê¸°ëŠ¥ ê²€ì¦ ì‹¤íŒ¨")
            
        except Exception as e:
            result['success'] = False
            result['issues'].append(f"ì œì–´ì„¼í„° ê²€ì¦ ì˜¤ë¥˜: {str(e)}")
            print(f"  âŒ ì œì–´ì„¼í„° ê²€ì¦ ì˜¤ë¥˜: {e}")
        
        return result   
 
    def perform_performance_benchmarking(self) -> Dict:
        """ìµœì¢… ì„±ëŠ¥ ë²¤ì¹˜ë§ˆí‚¹ ë° ìµœì í™”"""
        print("âš¡ ìµœì¢… ì„±ëŠ¥ ë²¤ì¹˜ë§ˆí‚¹ ë° ìµœì í™” ìˆ˜í–‰ ì¤‘...")
        
        result = {
            'stage': 'performance_benchmarking',
            'success': False,
            'details': {},
            'issues': [],
            'recommendations': []
        }
        
        try:
            # 1. ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ ë°ëª¨ ì‹¤í–‰
            print("  ğŸ“Š ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸...")
            
            if os.path.exists('demo_performance_monitoring.py'):
                perf_result = subprocess.run([
                    sys.executable, 'demo_performance_monitoring.py'
],_capture_output = True, text=True, timeout=300)
                
                result['details']['performance_demo'] = {
                    'return_code': perf_result.returncode,
                    'stdout': perf_result.stdout[-1000:],  # ë§ˆì§€ë§‰ 1000ì
                    'stderr': perf_result.stderr[-500:] if perf_result.stderr else ""
                }
                
                if perf_result.returncode == 0:
                    print("    âœ… ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ ë°ëª¨ ì„±ê³µ")
                else:
                    print("    âŒ ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ ë°ëª¨ ì‹¤íŒ¨")
                    result['issues'].append("ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ ë°ëª¨ ì‹¤íŒ¨")
            else:
                print("    âš ï¸ ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ ë°ëª¨ ìŠ¤í¬ë¦½íŠ¸ ì—†ìŒ")
                result['issues'].append("ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ ë°ëª¨ ìŠ¤í¬ë¦½íŠ¸ ëˆ„ë½")
            
            # 2. ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
            print("  ğŸ§ª ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ ì‹¤í–‰...")
            
            if os.path.exists('test_performance_monitoring.py'):
                test_result = subprocess.run([
                    sys.executable, 'test_performance_monitoring.py'
],_capture_output = True, text=True, timeout=180)
                
                result['details']['performance_tests'] = {
                    'return_code': test_result.returncode,
                    'stdout': test_result.stdout[-1000:],
                    'stderr': test_result.stderr[-500:] if test_result.stderr else ""
                }
                
                if test_result.returncode == 0:
                    print("    âœ… ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ ì„±ê³µ")
                else:
                    print("    âŒ ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨")
                    result['issues'].append("ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨")
            else:
                print("    âš ï¸ ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸ ì—†ìŒ")
                result['issues'].append("ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸ ëˆ„ë½")
            
            # 3. ì‹œìŠ¤í…œ ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ ì¸¡ì •
            print("  ğŸ’» ì‹œìŠ¤í…œ ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ ì¸¡ì •...")
            
            try:
# BROKEN_REF:                 import psutil
                
                # CPU ì‚¬ìš©ë¥  ì¸¡ì • (1ì´ˆê°„)
                cpu_percent = psutil.cpu_percent(interval=1)
                
                # ë©”ëª¨ë¦¬ ì‚¬ìš©ë¥  ì¸¡ì •
                memory = psutil.virtual_memory()
                memory_percent = memory.percent
                memory_available_gb = memory.available / (1024**3)
                
                # ë””ìŠ¤í¬ ì‚¬ìš©ë¥  ì¸¡ì •
                disk = psutil.disk_usage('/')
                disk_percent = (disk.used / disk.total) * 100
                
                result['details']['system_resources'] = {
                    'cpu_percent': cpu_percent,
                    'memory_percent': memory_percent,
                    'memory_available_gb': memory_available_gb,
                    'disk_percent': disk_percent,
                    'measurement_time': datetime.now().isoformat()
                }
                
                print(f"    ğŸ“ˆ CPU ì‚¬ìš©ë¥ : {cpu_percent:.1f}%")
                print(f"    ğŸ’¾ ë©”ëª¨ë¦¬ ì‚¬ìš©ë¥ : {memory_percent:.1f}%")
                print(f"    ğŸ’¿ ë””ìŠ¤í¬ ì‚¬ìš©ë¥ : {disk_percent:.1f}%")
                
                # ì„±ëŠ¥ ê¸°ì¤€ í™•ì¸ (Requirements 7.1, 7.2)
                performance_issues = []
                if cpu_percent > 80:
                    performance_issues.append("CPU ì‚¬ìš©ë¥ ì´ 80%ë¥¼ ì´ˆê³¼í•¨")
                if memory_percent > 70:
                    performance_issues.append("ë©”ëª¨ë¦¬ ì‚¬ìš©ë¥ ì´ 70%ë¥¼ ì´ˆê³¼í•¨")
                if memory_available_gb < 0.5:
                    performance_issues.append("ì‚¬ìš© ê°€ëŠ¥í•œ ë©”ëª¨ë¦¬ê°€ 0.5GB ë¯¸ë§Œ")
                
                result['details']['performance_issues'] = performance_issues
                
                if performance_issues:
                    result['issues'].extend(performance_issues)
                    result['recommendations'].append("ì‹œìŠ¤í…œ ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ì„ ìµœì í™”í•˜ì„¸ìš”")
                
            except ImportError:
                print("    âš ï¸ psutil ëª¨ë“ˆ ì—†ìŒ - ë¦¬ì†ŒìŠ¤ ì¸¡ì • ê±´ë„ˆëœ€")
                result['issues'].append("psutil ëª¨ë“ˆ ëˆ„ë½ìœ¼ë¡œ ë¦¬ì†ŒìŠ¤ ì¸¡ì • ë¶ˆê°€")
            
            # 4. ì„±ëŠ¥ ë¹„êµ ë°ì´í„° í™•ì¸
            print("  ğŸ“‹ ì„±ëŠ¥ ë¹„êµ ë°ì´í„° í™•ì¸...")
            
            performance_files = [
                'performance_data_*.json',
                'performance_comparison_*.txt'
            ]
            
            found_files = []
            for pattern in performance_files:
# BROKEN_REF:                 import glob
                files = glob.glob(pattern)
                found_files.extend(files)
            
            result['details']['performance_files'] = found_files
            
            if found_files:
                print(f"    âœ… {len(found_files)}ê°œ ì„±ëŠ¥ ë°ì´í„° íŒŒì¼ ë°œê²¬")
                for file in found_files[:3]:  # ìµœëŒ€ 3ê°œë§Œ í‘œì‹œ
                    file_size = os.path.getsize(file) / 1024  # KB
                    print(f"      â€¢ {os.path.basename(file)} ({file_size:.1f}KB)")
            else:
                print("    âš ï¸ ì„±ëŠ¥ ë°ì´í„° íŒŒì¼ ì—†ìŒ")
                result['issues'].append("ì„±ëŠ¥ ë¹„êµ ë°ì´í„° íŒŒì¼ ëˆ„ë½")
            
            # 5. ìµœì í™” ê¶Œì¥ì‚¬í•­ ìƒì„±
            print("  ğŸ’¡ ìµœì í™” ê¶Œì¥ì‚¬í•­ ìƒì„±...")
            
            optimization_recommendations = []
            
            # CPU ìµœì í™”
            if result['details'].get('system_resources', {}).get('cpu_percent', 0) > 60:
                optimization_recommendations.append({
                    'category': 'CPU ìµœì í™”',
                    'recommendation': 'CPU ì§‘ì•½ì  ì‘ì—…ì˜ ìŠ¤ì¼€ì¤„ë§ ìµœì í™”',
                    'priority': 'medium'
                })
            
            # ë©”ëª¨ë¦¬ ìµœì í™”
            if result['details'].get('system_resources', {}).get('memory_percent', 0) > 50:
                optimization_recommendations.append({
                    'category': 'ë©”ëª¨ë¦¬ ìµœì í™”',
                    'recommendation': 'ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ëª¨ë‹ˆí„°ë§ ë° ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ìµœì í™”',
                    'priority': 'medium'
                })
            
            # í”„ë¡œì„¸ìŠ¤ ê´€ë¦¬ ìµœì í™”
            optimization_recommendations.append({
                'category': 'í”„ë¡œì„¸ìŠ¤ ê´€ë¦¬',
                'recommendation': 'í”„ë¡œì„¸ìŠ¤ ì¬ì‹œì‘ ê°„ê²© ìµœì í™” ë° ë³µêµ¬ ë¡œì§ ê°œì„ ',
                'priority': 'low'
            })
            
            result['details']['optimization_recommendations'] = optimization_recommendations
            result['recommendations'].extend([rec['recommendation'] for rec in optimization_recommendations])
            
            print(f"    ğŸ“‹ {len(optimization_recommendations)}ê°œ ìµœì í™” ê¶Œì¥ì‚¬í•­ ìƒì„±")
            
            # 6. ì„±ëŠ¥ ë²¤ì¹˜ë§ˆí‚¹ ê²°ê³¼ íŒì •
            critical_performance_issues = len([issue for issue in result['issues'] if 'CPU' in issue or 'memory' in issue or 'ë©”ëª¨ë¦¬' in issue])
            
            if critical_performance_issues == 0:
                result['success'] = True
                print("  ğŸ‰ ì„±ëŠ¥ ë²¤ì¹˜ë§ˆí‚¹ ì„±ê³µ!")
            else:
                result['success'] = False
                print("  âš ï¸ ì„±ëŠ¥ ë²¤ì¹˜ë§ˆí‚¹ì—ì„œ ì´ìŠˆ ë°œê²¬")
            
        except Exception as e:
            result['success'] = False
            result['issues'].append(f"ì„±ëŠ¥ ë²¤ì¹˜ë§ˆí‚¹ ì˜¤ë¥˜: {str(e)}")
            print(f"  âŒ ì„±ëŠ¥ ë²¤ì¹˜ë§ˆí‚¹ ì˜¤ë¥˜: {e}")
        
        return result    

    def generate_deployment_checklist(self) -> Dict:
        """ë°°í¬ ê²€ì¦ ì²´í¬ë¦¬ìŠ¤íŠ¸ ìƒì„±"""
        print("ğŸ“‹ ë°°í¬ ê²€ì¦ ì²´í¬ë¦¬ìŠ¤íŠ¸ ìƒì„± ì¤‘...")
        
        result = {
            'stage': 'deployment_checklist',
            'success': False,
            'details': {},
            'issues': [],
            'recommendations': []
        }
        
        try:
            # 1. í•„ìˆ˜ íŒŒì¼ ì¡´ì¬ í™•ì¸
            print("  ğŸ“ í•„ìˆ˜ íŒŒì¼ ì¡´ì¬ í™•ì¸...")
            
            essential_files = [
                '.naming_backup/config_data_backup/watchhamster.log',
                'Monitoring/POSCO_News_250808/posco_main_notifier.py',
                'Monitoring/POSCO_News_250808/config.py',
                '.naming_backup/config_data_backup/Monitoring/Posco_News_mini/modules.json',
                '.naming_backup/scripts/.naming_backup/scripts/watchhamster_control_center.sh',
                'requirements.txt'
            ]
            
            missing_files = []
            existing_files = []
            
            for file in essential_files:
                if os.path.exists(file):
                    existing_files.append(file)
                    print(f"    âœ… {file}")
                else:
                    missing_files.append(file)
                    print(f"    âŒ {file} (ëˆ„ë½)")
            
            result['details']['file_check'] = {
                'essential_files': essential_files,
                'existing_files': existing_files,
                'missing_files': missing_files,
                'completion_rate': (len(existing_files) / len(essential_files)) * 100
            }
            
            if missing_files:
                result['issues'].extend([f"í•„ìˆ˜ íŒŒì¼ ëˆ„ë½: {file}" for file in missing_files])
            
            # 2. v2 ì»´í¬ë„ŒíŠ¸ í™•ì¸
            print("  ğŸ”§ v2 ì»´í¬ë„ŒíŠ¸ í™•ì¸...")
            
            v3_0_components = [
                'Monitoring/WatchHamster_v3.0/core/enhanced_process_manager.py',
                'Monitoring/WatchHamster_v3.0/core/module_registry.py',
                'Monitoring/WatchHamster_v3.0/core/notification_manager.py',
                'Monitoring/WatchHamster_v3.0/core/performance_monitor.py'
            ]
            
            missing_v3_0_components = []
            existing_v3_0_components = []
            
            for component in v3_0_components:
                if os.path.exists(component):
                    existing_v3_0_components.append(component)
                    print(f"    âœ… {os.path.basename(component)}")
                else:
                    missing_v3_0_components.append(component)
                    print(f"    âŒ {os.path.basename(component)} (ëˆ„ë½)")
            
            result['details']['v3_0_components'] = {
                'total_components': len(v3_0_components),
                'existing_components': existing_v3_0_components,
                'missing_components': missing_v3_0_components,
                'completion_rate': (len(existing_v3_0_components) / len(v3_0_components)) * 100
            }
            
            if missing_v3_0_components:
                result['issues'].extend([f"v2 ì»´í¬ë„ŒíŠ¸ ëˆ„ë½: {os.path.basename(comp)}" for comp in missing_v3_0_components])
            
            # 3. ì„¤ì • íŒŒì¼ ìœ íš¨ì„± ê²€ì‚¬
            print("  âš™ï¸ ì„¤ì • íŒŒì¼ ìœ íš¨ì„± ê²€ì‚¬...")
            
            config_files = [
                'Monitoring/POSCO_News_250808/config.py',
                '.naming_backup/config_data_backup/Monitoring/Posco_News_mini/modules.json'
            ]
            
            config_validation = {}
            
            for config_file in config_files:
                if os.path.exists(config_file):
                    try:
                        if config_file.endswith('.json'):
with_open(config_file,_'r',_encoding = 'utf-8') as f:
                                json.load(f)
                            config_validation[config_file] = {'valid': True, 'error': None}
                            print(f"    âœ… {os.path.basename(config_file)} JSON ìœ íš¨")
                        elif config_file.endswith('.py'):
                            # Python íŒŒì¼ ë¬¸ë²• ê²€ì‚¬
                            syntax_check = subprocess.run([
                                sys.executable, '-m', 'py_compile', config_file
],_capture_output = True, text=True)
                            
                            if syntax_check.returncode == 0:
                                config_validation[config_file] = {'valid': True, 'error': None}
                                print(f"    âœ… {os.path.basename(config_file)} Python ë¬¸ë²• ìœ íš¨")
                            else:
                                config_validation[config_file] = {'valid': False, 'error': syntax_check.stderr}
                                print(f"    âŒ {os.path.basename(config_file)} Python ë¬¸ë²• ì˜¤ë¥˜")
                                result['issues'].append(f"{config_file} ë¬¸ë²• ì˜¤ë¥˜")
                    except Exception as e:
                        config_validation[config_file] = {'valid': False, 'error': str(e)}
                        print(f"    âŒ {os.path.basename(config_file)} ê²€ì¦ ì‹¤íŒ¨: {e}")
                        result['issues'].append(f"{config_file} ê²€ì¦ ì‹¤íŒ¨")
                else:
                    config_validation[config_file] = {'valid': False, 'error': 'File not found'}
                    print(f"    âŒ {os.path.basename(config_file)} íŒŒì¼ ì—†ìŒ")
            
            result['details']['config_validation'] = config_validation
            
            # 4. ì˜ì¡´ì„± í™•ì¸
            print("  ğŸ“¦ ì˜ì¡´ì„± í™•ì¸...")
            
            if os.path.exists('requirements.txt'):
                try:
                    # requirements.txt íŒŒì¼ ì½ê¸°
with_open('requirements.txt',_'r',_encoding = 'utf-8') as f:
                        requirements = [line.strip() for line in f if line.strip() and not line.startswith('#')]
                    
                    # pip freezeë¡œ ì„¤ì¹˜ëœ íŒ¨í‚¤ì§€ í™•ì¸
                    pip_freeze = subprocess.run([
                        sys.executable, '-m', 'pip', 'freeze'
],_capture_output = True, text=True)
                    
                    installed_packages = pip_freeze.stdout.lower()
                    
                    missing_deps = []
                    satisfied_deps = []
                    
                    for req in requirements:
                        package_name = req.split('==')[0].split('>=')[0].split('<=')[0].lower()
                        if package_name in installed_packages:
                            satisfied_deps.append(req)
                            print(f"    âœ… {req}")
                        else:
                            missing_deps.append(req)
                            print(f"    âŒ {req} (ë¯¸ì„¤ì¹˜)")
                    
                    result['details']['dependencies'] = {
                        'total_requirements': len(requirements),
                        'satisfied_dependencies': satisfied_deps,
                        'missing_dependencies': missing_deps,
                        'satisfaction_rate': (len(satisfied_deps) / len(requirements)) * 100 if requirements else 100
                    }
                    
                    if missing_deps:
                        result['issues'].extend([f"ì˜ì¡´ì„± ëˆ„ë½: {dep}" for dep in missing_deps])
                        result['recommendations'].append("pip install -r requirements.txt ì‹¤í–‰")
                        
                except Exception as e:
                    print(f"    âŒ ì˜ì¡´ì„± í™•ì¸ ì‹¤íŒ¨: {e}")
                    result['issues'].append(f"ì˜ì¡´ì„± í™•ì¸ ì‹¤íŒ¨: {str(e)}")
            else:
                print("    âš ï¸ requirements.txt íŒŒì¼ ì—†ìŒ")
                result['issues'].append("requirements.txt íŒŒì¼ ëˆ„ë½")
            
            # 5. ë¬¸ì„œí™” í™•ì¸
            print("  ğŸ“š ë¬¸ì„œí™” í™•ì¸...")
            
            documentation_files = [
                'README.md',
                'END_TO_END_TEST_GUIDE.md',
                'TEST_FRAMEWORK_README.md'
            ]
            
            existing_docs = []
            missing_docs = []
            
            for doc in documentation_files:
                if os.path.exists(doc):
                    existing_docs.append(doc)
                    file_size = os.path.getsize(doc) / 1024  # KB
                    print(f"    âœ… {doc} ({file_size:.1f}KB)")
                else:
                    missing_docs.append(doc)
                    print(f"    âŒ {doc} (ëˆ„ë½)")
            
            result['details']['documentation'] = {
                'total_docs': len(documentation_files),
                'existing_docs': existing_docs,
                'missing_docs': missing_docs,
                'completion_rate': (len(existing_docs) / len(documentation_files)) * 100
            }
            
            if missing_docs:
                result['issues'].extend([f"ë¬¸ì„œ ëˆ„ë½: {doc}" for doc in missing_docs])
            
            # 6. ë°°í¬ ì¤€ë¹„ ìƒíƒœ ì¢…í•© í‰ê°€
            print("  ğŸ¯ ë°°í¬ ì¤€ë¹„ ìƒíƒœ ì¢…í•© í‰ê°€...")
            
            # ê° ì˜ì—­ë³„ ì ìˆ˜ ê³„ì‚°
            file_score = result['details']['file_check']['completion_rate']
            v2_score = result['details']['v3_0_components']['completion_rate']
            config_score = len([v for v in config_validation.values() if v['valid']]) / len(config_validation) * 100 if config_validation else 0
            deps_score = result['details'].get('dependencies', {}).get('satisfaction_rate', 0)
            docs_score = result['details']['documentation']['completion_rate']
            
            overall_score = (file_score + v2_score + config_score + deps_score + docs_score) / 5
            
            result['details']['deployment_readiness'] = {
                'file_completeness': file_score,
                'v2_components_completeness': v2_score,
                'configuration_validity': config_score,
                'dependencies_satisfaction': deps_score,
                'documentation_completeness': docs_score,
                'overall_readiness_score': overall_score
            }
            
            print(f"    ğŸ“Š ì „ì²´ ë°°í¬ ì¤€ë¹„ë„: {overall_score:.1f}%")
            print(f"      â€¢ í•„ìˆ˜ íŒŒì¼: {file_score:.1f}%")
            print(f"      â€¢ v2 ì»´í¬ë„ŒíŠ¸: {v2_score:.1f}%")
            print(f"      â€¢ ì„¤ì • ìœ íš¨ì„±: {config_score:.1f}%")
            print(f"      â€¢ ì˜ì¡´ì„±: {deps_score:.1f}%")
            print(f"      â€¢ ë¬¸ì„œí™”: {docs_score:.1f}%")
            
            # ë°°í¬ ì¤€ë¹„ ì™„ë£Œ ê¸°ì¤€: 80% ì´ìƒ
            if overall_score >= 80:
                result['success'] = True
                print("  ğŸ‰ ë°°í¬ ì¤€ë¹„ ì™„ë£Œ!")
            else:
                result['success'] = False
                result['recommendations'].append("ë°°í¬ ì¤€ë¹„ë„ë¥¼ 80% ì´ìƒìœ¼ë¡œ í–¥ìƒì‹œí‚¤ì„¸ìš”")
                print("  âš ï¸ ë°°í¬ ì¤€ë¹„ ë¯¸ì™„ë£Œ")
            
        except Exception as e:
            result['success'] = False
            result['issues'].append(f"ë°°í¬ ì²´í¬ë¦¬ìŠ¤íŠ¸ ìƒì„± ì˜¤ë¥˜: {str(e)}")
            print(f"  âŒ ë°°í¬ ì²´í¬ë¦¬ìŠ¤íŠ¸ ìƒì„± ì˜¤ë¥˜: {e}")
        
        return result
    
    def generate_final_report(self) -> str:
        """ìµœì¢… í†µí•© ê²€ì¦ ë³´ê³ ì„œ ìƒì„±"""
        total_duration = (self.end_time - self.start_time).total_seconds()
        
        # ì „ì²´ í†µê³„ ê³„ì‚°
        total_stages = len(self.verification_results)
        successful_stages = sum(1 for r in self.verification_results.values() if r['success'])
        failed_stages = total_stages - successful_stages
        
        # ì¤‘ìš” ë‹¨ê³„ í†µê³„
        critical_stages = [stage for stage in self.verification_stages if stage.get('critical', False)]
        critical_successful = sum(1 for stage in critical_stages 
                                if self.verification_results.get(stage['name'], {}).get('success', False))
        
        # ë³´ê³ ì„œ ìƒì„±
        report = f"""
ğŸ¯ POSCO WatchHamster v3.0 ìµœì¢… ì‹œìŠ¤í…œ í†µí•© ë° ê²€ì¦ ë³´ê³ ì„œ
{'=' * 80}

ğŸ“Š ì‹¤í–‰ ìš”ì•½
â€¢ ê²€ì¦ ì‹œì‘: {self.start_time.strftime('%Y-%m-%d %H:%M:%S')}
â€¢ ê²€ì¦ ì™„ë£Œ: {self.end_time.strftime('%Y-%m-%d %H:%M:%S')}
â€¢ ì´ ì†Œìš”ì‹œê°„: {total_duration:.2f}ì´ˆ
â€¢ ê²€ì¦ ë‹¨ê³„: {total_stages}ê°œ
â€¢ ì„±ê³µí•œ ë‹¨ê³„: {successful_stages}ê°œ
â€¢ ì‹¤íŒ¨í•œ ë‹¨ê³„: {failed_stages}ê°œ
â€¢ ì „ì²´ ì„±ê³µë¥ : {(successful_stages/total_stages*100):.1f}%

ğŸ”´ ì¤‘ìš” ë‹¨ê³„ í˜„í™©
â€¢ ì¤‘ìš” ë‹¨ê³„ ìˆ˜: {len(critical_stages)}ê°œ
â€¢ ì¤‘ìš” ë‹¨ê³„ ì„±ê³µ: {critical_successful}ê°œ
â€¢ ì¤‘ìš” ë‹¨ê³„ ì„±ê³µë¥ : {(critical_successful/len(critical_stages)*100):.1f}%

ğŸ“‹ ë‹¨ê³„ë³„ ìƒì„¸ ê²°ê³¼
{'-' * 80}
"""
        
        for stage_config in self.verification_stages:
            stage_name = stage_config['name']
            stage_title = stage_config['title']
            is_critical = stage_config.get('critical', False)
            
            if stage_name in self.verification_results:
                result = self.verification_results[stage_name]
                status = "âœ… ì„±ê³µ" if result['success'] else "âŒ ì‹¤íŒ¨"
                critical_mark = "ğŸ”´ ì¤‘ìš”" if is_critical else "ğŸŸ¡ ì¼ë°˜"
                
report_+ =  f"""
{status} {stage_title} ({critical_mark})
â€¢ ì„¤ëª…: {stage_config['description']}
â€¢ ë°œê²¬ëœ ì´ìŠˆ: {len(result['issues'])}ê°œ
â€¢ ê¶Œì¥ì‚¬í•­: {len(result['recommendations'])}ê°œ
"""
                
                if result['issues']:
report_+ =  "â€¢ ì£¼ìš” ì´ìŠˆ:/n"
                    for issue in result['issues'][:3]:  # ìµœëŒ€ 3ê°œë§Œ í‘œì‹œ
report_+ =  f"  - {issue}/n"
                
                if result['recommendations']:
report_+ =  "â€¢ ì£¼ìš” ê¶Œì¥ì‚¬í•­:/n"
                    for rec in result['recommendations'][:3]:  # ìµœëŒ€ 3ê°œë§Œ í‘œì‹œ
report_+ =  f"  - {rec}/n"
        
        # ìƒì„¸ í†µê³„
report_+ =  f"""
{'-' * 80}
ğŸ“ˆ ìƒì„¸ í†µê³„ ë° ë¶„ì„

ğŸ§ª í…ŒìŠ¤íŠ¸ ìŠ¤ìœ„íŠ¸ ê²°ê³¼:
"""
        
        if 'comprehensive_test_suite' in self.verification_results:
            test_details = self.verification_results['comprehensive_test_suite']['details']
            if 'test_summary' in test_details:
                summary = test_details['test_summary']
report_+ =  f"""â€¢ ì´ í…ŒìŠ¤íŠ¸: {summary['total_tests']}ê°œ
â€¢ ì„±ê³µí•œ í…ŒìŠ¤íŠ¸: {summary['passed_tests']}ê°œ
â€¢ ì‹¤íŒ¨í•œ í…ŒìŠ¤íŠ¸: {summary['failed_tests']}ê°œ
â€¢ í…ŒìŠ¤íŠ¸ ì„±ê³µë¥ : {summary['success_rate']:.1f}%
"""
        
report_+ =  f"""
ğŸ›ï¸ ì œì–´ì„¼í„° ê²€ì¦ ê²°ê³¼:
"""
        
        if 'control_center_verification' in self.verification_results:
            control_details = self.verification_results['control_center_verification']['details']
            if 'function_definitions' in control_details:
                func_defs = control_details['function_definitions']
                defined_funcs = sum(1 for v in func_defs.values() if v)
                total_funcs = len(func_defs)
report_+ =  f"""â€¢ í•„ìˆ˜ í•¨ìˆ˜ ì •ì˜: {defined_funcs}/{total_funcs}ê°œ
â€¢ í•¨ìˆ˜ ì •ì˜ ì™„ì„±ë¥ : {(defined_funcs/total_funcs*100):.1f}%
"""
        
report_+ =  f"""
âš¡ ì„±ëŠ¥ ë²¤ì¹˜ë§ˆí‚¹ ê²°ê³¼:
"""
        
        if 'performance_benchmarking' in self.verification_results:
            perf_details = self.verification_results['performance_benchmarking']['details']
            if 'system_resources' in perf_details:
                resources = perf_details['system_resources']
report_+ =  f"""â€¢ CPU ì‚¬ìš©ë¥ : {resources.get('cpu_percent', 0):.1f}%
â€¢ ë©”ëª¨ë¦¬ ì‚¬ìš©ë¥ : {resources.get('memory_percent', 0):.1f}%
â€¢ ì‚¬ìš© ê°€ëŠ¥ ë©”ëª¨ë¦¬: {resources.get('memory_available_gb', 0):.2f}GB
â€¢ ë””ìŠ¤í¬ ì‚¬ìš©ë¥ : {resources.get('disk_percent', 0):.1f}%
"""
        
report_+ =  f"""
ğŸ“‹ ë°°í¬ ì¤€ë¹„ ìƒíƒœ:
"""
        
        if 'deployment_checklist' in self.verification_results:
            deploy_details = self.verification_results['deployment_checklist']['details']
            if 'deployment_readiness' in deploy_details:
                readiness = deploy_details['deployment_readiness']
report_+ =  f"""â€¢ ì „ì²´ ë°°í¬ ì¤€ë¹„ë„: {readiness.get('overall_readiness_score', 0):.1f}%
â€¢ í•„ìˆ˜ íŒŒì¼ ì™„ì„±ë„: {readiness.get('file_completeness', 0):.1f}%
â€¢ v2 ì»´í¬ë„ŒíŠ¸ ì™„ì„±ë„: {readiness.get('v2_components_completeness', 0):.1f}%
â€¢ ì„¤ì • ìœ íš¨ì„±: {readiness.get('configuration_validity', 0):.1f}%
â€¢ ì˜ì¡´ì„± ë§Œì¡±ë„: {readiness.get('dependencies_satisfaction', 0):.1f}%
â€¢ ë¬¸ì„œí™” ì™„ì„±ë„: {readiness.get('documentation_completeness', 0):.1f}%
"""
        
        # ìµœì¢… ê²°ë¡  ë° ê¶Œì¥ì‚¬í•­
report_+ =  f"""
{'-' * 80}
ğŸ¯ ìµœì¢… ê²°ë¡  ë° ê¶Œì¥ì‚¬í•­

"""
        
        if critical_successful == len(critical_stages) and successful_stages >= total_stages * 0.8:
report_+ =  """âœ… ì‹œìŠ¤í…œ í†µí•© ë° ê²€ì¦ ì„±ê³µ!
â€¢ POSCO WatchHamster v3.0 ì‹œìŠ¤í…œì´ ì„±ê³µì ìœ¼ë¡œ í†µí•©ë˜ì—ˆìŠµë‹ˆë‹¤.
â€¢ ëª¨ë“  ì¤‘ìš” ê¸°ëŠ¥ì´ ì˜¬ë°”ë¥´ê²Œ ì‘ë™í•˜ê³  ìˆìŠµë‹ˆë‹¤.
â€¢ í”„ë¡œë•ì…˜ í™˜ê²½ìœ¼ë¡œ ë°°í¬í•  ì¤€ë¹„ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.

ğŸš€ ë‹¤ìŒ ë‹¨ê³„:
â€¢ í”„ë¡œë•ì…˜ í™˜ê²½ ë°°í¬ ì§„í–‰
â€¢ ì •ê¸°ì ì¸ ëª¨ë‹ˆí„°ë§ ë° ìœ ì§€ë³´ìˆ˜ ê³„íš ìˆ˜ë¦½
â€¢ ì‚¬ìš©ì êµìœ¡ ë° ë¬¸ì„œí™” ì—…ë°ì´íŠ¸
"""
        else:
report_+ =  """âš ï¸ ì‹œìŠ¤í…œ í†µí•© ë° ê²€ì¦ ë¯¸ì™„ë£Œ
â€¢ ì¼ë¶€ ì¤‘ìš” ê¸°ëŠ¥ì—ì„œ ë¬¸ì œê°€ ë°œê²¬ë˜ì—ˆìŠµë‹ˆë‹¤.
â€¢ ë°°í¬ ì „ì— ë‹¤ìŒ ì´ìŠˆë“¤ì„ í•´ê²°í•´ì•¼ í•©ë‹ˆë‹¤.

ğŸ”§ ìš°ì„  í•´ê²° ê³¼ì œ:
"""
            
            # ëª¨ë“  ì´ìŠˆ ìˆ˜ì§‘
            all_issues = []
            for result in self.verification_results.values():
                all_issues.extend(result['issues'])
            
            # ì¤‘ìš” ì´ìŠˆ ìš°ì„  í‘œì‹œ
            critical_issues = [issue for issue in all_issues if any(keyword in issue.lower() 
                             for keyword in ['syntax', 'function', 'critical', 'ì¤‘ìš”', 'í•„ìˆ˜'])]
            
            for issue in critical_issues[:5]:  # ìµœëŒ€ 5ê°œ
report_+ =  f"â€¢ {issue}/n"
            
report_+ =  f"""
ğŸ’¡ ê¶Œì¥ ì¡°ì¹˜ì‚¬í•­:
"""
            
            # ëª¨ë“  ê¶Œì¥ì‚¬í•­ ìˆ˜ì§‘
            all_recommendations = []
            for result in self.verification_results.values():
                all_recommendations.extend(result['recommendations'])
            
            # ì¤‘ë³µ ì œê±° ë° ìš°ì„ ìˆœìœ„ ì •ë ¬
            unique_recommendations = list(set(all_recommendations))
            
            for rec in unique_recommendations[:5]:  # ìµœëŒ€ 5ê°œ
report_+ =  f"â€¢ {rec}/n"
        
        # ìš”êµ¬ì‚¬í•­ ë§¤í•‘
report_+ =  f"""
{'-' * 80}
ğŸ“‹ ìš”êµ¬ì‚¬í•­ ì¶©ì¡± í˜„í™©

ì´ ê²€ì¦ì€ ë‹¤ìŒ ìš”êµ¬ì‚¬í•­ë“¤ì„ ì¶©ì¡±í•©ë‹ˆë‹¤:
â€¢ 2.1: ì›Œì¹˜í–„ìŠ¤í„° ì‹œì‘ ê¸°ëŠ¥ ê²€ì¦ ì™„ë£Œ
â€¢ 2.2: ì‹¤ì‹œê°„ í”„ë¡œì„¸ìŠ¤ ìƒíƒœ í™•ì¸ ê¸°ëŠ¥ ê²€ì¦ ì™„ë£Œ  
â€¢ 2.3: ì•ˆì „í•œ í”„ë¡œì„¸ìŠ¤ ì¢…ë£Œ ê¸°ëŠ¥ ê²€ì¦ ì™„ë£Œ
â€¢ 2.4: ê°œë³„ ëª¨ë“ˆ ì œì–´ ê¸°ëŠ¥ ê²€ì¦ ì™„ë£Œ
â€¢ 7.1: CPU ì‚¬ìš©ë¥  ëª¨ë‹ˆí„°ë§ ë° ê¸°ì¤€ í™•ì¸ ì™„ë£Œ
â€¢ 7.2: ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ëª¨ë‹ˆí„°ë§ ë° ê¸°ì¤€ í™•ì¸ ì™„ë£Œ
â€¢ 7.3: í”„ë¡œì„¸ìŠ¤ ê´€ë¦¬ ì‘ë‹µì‹œê°„ ì¸¡ì • ì™„ë£Œ
â€¢ 7.4: ì„±ëŠ¥ ì•Œë¦¼ ì‹œìŠ¤í…œ ê²€ì¦ ì™„ë£Œ

ìƒì„± ì‹œê°„: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}
ë³´ê³ ì„œ ë²„ì „: v2.0-final
"""
        
        return report
    
    def save_verification_results(self):
        """ê²€ì¦ ê²°ê³¼ë¥¼ íŒŒì¼ë¡œ ì €ì¥"""
        try:
            # JSON ê²°ê³¼ ì €ì¥
            results_file = os.path.join(self.script_dir, 'final_integration_verification_results.json')
            
            # datetime ê°ì²´ë¥¼ ë¬¸ìì—´ë¡œ ë³€í™˜
            serializable_results = {}
            for stage_name, result in self.verification_results.items():
                serializable_result = result.copy()
                serializable_results[stage_name] = serializable_result
            
            verification_session = {
                'session_start': self.start_time.isoformat(),
                'session_end': self.end_time.isoformat(),
                'total_duration': (self.end_time - self.start_time).total_seconds(),
                'verification_stages': self.verification_stages,
                'results': serializable_results
            }
            
with_open(results_file,_'w',_encoding = 'utf-8') as f:
                json.dump(verification_session, f, indent=2, ensure_ascii=False)
            
            print(f"ğŸ“ ê²€ì¦ ê²°ê³¼ ì €ì¥ë¨: {os.path.basename(results_file)}")
            
            # ë³´ê³ ì„œ ì €ì¥
            report = self.generate_final_report()
            report_file = os.path.join(self.script_dir, 'final_integration_verification_report.md')
            
with_open(report_file,_'w',_encoding = 'utf-8') as f:
                f.write(report)
            
            print(f"ğŸ“„ ìµœì¢… ë³´ê³ ì„œ ì €ì¥ë¨: {os.path.basename(report_file)}")
            
            return results_file, report_file
            
        except Exception as e:
            print(f"âš ï¸ ê²°ê³¼ ì €ì¥ ì‹¤íŒ¨: {e}")
            return None, None    

    def run_final_verification(self) -> bool:
        """ìµœì¢… ì‹œìŠ¤í…œ í†µí•© ë° ê²€ì¦ ì‹¤í–‰"""
        self.start_time = datetime.now()
        
        self.print_header("ğŸš€ POSCO WatchHamster v3.0 ìµœì¢… ì‹œìŠ¤í…œ í†µí•© ë° ê²€ì¦")
        print(f"ì‹œì‘ ì‹œê°„: {self.start_time.strftime('%Y-%m-%d %H:%M:%S')}")
        print(f"ê²€ì¦ ë‹¨ê³„: {len(self.verification_stages)}ê°œ")
        print()
        
        # ê° ê²€ì¦ ë‹¨ê³„ ì‹¤í–‰
        for i, stage_config in enumerate(self.verification_stages, 1):
            stage_name = stage_config['name']
            stage_title = stage_config['title']
            is_critical = stage_config.get('critical', False)
            
            self.print_section(f"ğŸ“‹ ë‹¨ê³„ {i}/{len(self.verification_stages)}: {stage_title}")
            print(f"ì„¤ëª…: {stage_config['description']}")
            print(f"ì¤‘ìš”ë„: {'ğŸ”´ ì¤‘ìš”' if is_critical else 'ğŸŸ¡ ì¼ë°˜'}")
            print()
            
            # ë‹¨ê³„ë³„ ê²€ì¦ ì‹¤í–‰
            if stage_name == 'comprehensive_test_suite':
                result = self.run_comprehensive_test_suite()
            elif stage_name == 'control_center_verification':
                result = self.verify_control_center_functions()
            elif stage_name == 'performance_benchmarking':
                result = self.perform_performance_benchmarking()
            elif stage_name == 'deployment_checklist':
                result = self.generate_deployment_checklist()
            else:
                result = {
                    'stage': stage_name,
                    'success': False,
                    'details': {},
                    'issues': [f"ì•Œ ìˆ˜ ì—†ëŠ” ê²€ì¦ ë‹¨ê³„: {stage_name}"],
                    'recommendations': []
                }
            
            self.verification_results[stage_name] = result
            
            # ë‹¨ê³„ ê²°ê³¼ ì¶œë ¥
            if result['success']:
                print(f"âœ… {stage_title} ì„±ê³µ!")
            else:
                print(f"âŒ {stage_title} ì‹¤íŒ¨")
                if result['issues']:
                    print(f"   ì£¼ìš” ì´ìŠˆ: {len(result['issues'])}ê°œ")
                    for issue in result['issues'][:2]:  # ìµœëŒ€ 2ê°œë§Œ í‘œì‹œ
                        print(f"   â€¢ {issue}")
            
            print()
        
        self.end_time = datetime.now()
        
        # ìµœì¢… ê²°ê³¼ ìš”ì•½
        self.print_header("ğŸ“Š ìµœì¢… ê²€ì¦ ê²°ê³¼ ìš”ì•½")
        
        total_stages = len(self.verification_results)
        successful_stages = sum(1 for r in self.verification_results.values() if r['success'])
        failed_stages = total_stages - successful_stages
        
        # ì¤‘ìš” ë‹¨ê³„ í†µê³„
        critical_stages = [stage for stage in self.verification_stages if stage.get('critical', False)]
        critical_successful = sum(1 for stage in critical_stages 
                                if self.verification_results.get(stage['name'], {}).get('success', False))
        
        print(f"ì´ ê²€ì¦ ë‹¨ê³„: {total_stages}ê°œ")
        print(f"ì„±ê³µí•œ ë‹¨ê³„: {successful_stages}ê°œ")
        print(f"ì‹¤íŒ¨í•œ ë‹¨ê³„: {failed_stages}ê°œ")
        print(f"ì „ì²´ ì„±ê³µë¥ : {(successful_stages/total_stages*100):.1f}%")
        print()
        print(f"ì¤‘ìš” ë‹¨ê³„: {len(critical_stages)}ê°œ")
        print(f"ì¤‘ìš” ë‹¨ê³„ ì„±ê³µ: {critical_successful}ê°œ")
        print(f"ì¤‘ìš” ë‹¨ê³„ ì„±ê³µë¥ : {(critical_successful/len(critical_stages)*100):.1f}%")
        
        # ìµœì¢… ë³´ê³ ì„œ ìƒì„± ë° ì €ì¥
        print()
        self.print_section("ğŸ“„ ìµœì¢… ë³´ê³ ì„œ ìƒì„±")
        
        report = self.generate_final_report()
        print(report)
        
        # ê²°ê³¼ ì €ì¥
results_file,_report_file =  self.save_verification_results()
        
        # ìµœì¢… íŒì •
        overall_success = (critical_successful == len(critical_stages) and 
successful_stages_> =  total_stages * 0.8)
        
        if overall_success:
            print("/nğŸ‰ POSCO WatchHamster v3.0 ì‹œìŠ¤í…œ í†µí•© ë° ê²€ì¦ ì„±ê³µ!")
            print("âœ… ëª¨ë“  ì¤‘ìš” ê¸°ëŠ¥ì´ ì˜¬ë°”ë¥´ê²Œ ì‘ë™í•©ë‹ˆë‹¤.")
            print("ğŸš€ í”„ë¡œë•ì…˜ í™˜ê²½ìœ¼ë¡œ ë°°í¬í•  ì¤€ë¹„ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.")
            return True
        else:
            print("/nâš ï¸ ì‹œìŠ¤í…œ í†µí•© ë° ê²€ì¦ ë¯¸ì™„ë£Œ")
            print("ğŸ”§ ì¼ë¶€ ì¤‘ìš” ê¸°ëŠ¥ì—ì„œ ë¬¸ì œê°€ ë°œê²¬ë˜ì—ˆìŠµë‹ˆë‹¤.")
            print("ğŸ“‹ ë°°í¬ ì „ì— ë°œê²¬ëœ ì´ìŠˆë“¤ì„ í•´ê²°í•´ì£¼ì„¸ìš”.")
            return False


def main():
    """ë©”ì¸ í•¨ìˆ˜"""
    verifier = FinalSystemIntegrationVerification()
    
    try:
        success = verifier.run_final_verification()
        return 0 if success else 1
        
    except KeyboardInterrupt:
        print("/nâš ï¸ ê²€ì¦ì´ ì‚¬ìš©ìì— ì˜í•´ ì¤‘ë‹¨ë˜ì—ˆìŠµë‹ˆë‹¤.")
        return 1
        
    except Exception as e:
        print(f"âŒ ê²€ì¦ ì‹¤í–‰ ì¤‘ ì¹˜ëª…ì  ì˜¤ë¥˜ ë°œìƒ: {e}")
# BROKEN_REF:         import traceback
        traceback.print_exc()
        return 1


if __name__ == '__main__':
    sys.exit(main())